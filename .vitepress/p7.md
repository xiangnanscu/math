## 第 19 章 数值分析

本章的主题是数值分析最重要的原理. 求解实际问题通常需要用到为计算机而发展的数值方法专业数字图书馆. 其部分内容将在 19.8.3 (第 1310 页) 介绍. 20.1 (第 1318 页) 及 19.8.4.2 (第 1318 页) 将介绍带有求解线性方程组数值程序的专门的计算机软件 Mathematica. 19.8.2 (第 1303 页) 则将考察误差传播与计算误差.

### 19.1 数值求解单变量非线性方程

任何单变量方程可以转化为一般形式:

$$
\text{零形式:}f\left( x\right)  = 0\text{.} \tag{19.1}
$$

不动点形式: $x = \varphi \left( x\right)$ .(19.2)

设方程 (19.1) 和 (19.2) 可以求解. 其解用 ${x}^{ * }$ 表示. 为得到 ${x}^{ * }$ 的第一个近似值,我们尝试将方程转化为形式 ${f}_{1}\left( x\right)  = {f}_{2}\left( x\right)$ ,其中函数 $y = {f}_{1}\left( x\right) , y = {f}_{2}\left( x\right)$ 的曲线大致可以简单作图.

$f\left( x\right)  = {x}^{2} - \sin x = 0$ . 根据函数 $y = {x}^{2}, y = \sin x$ 的形状,容易得到 ${x}_{1}^{ * } = 0$ 与 ${x}_{2}^{ * } \approx  {0.87}$ 为其根 (图 19.1).

![01937d01-b6f6-7881-8294-3a9c82211946_0_517_1462_606_554_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_0_517_1462_606_554_0.jpg)

图 19.1

#### 19.1.1 迭代法

迭代法的基本思路是: 从已知的初始值 ${x}_{k}\left( {k = 0,1,\cdots , n}\right)$ 出发,进一步构造更好的逼近序列, 因此给定方程的解是一个收敛序列的迭代逼近. 构造的序列要有尽可能快的收敛速度.

##### 19.1.1.1 一般迭代法

为了求解或许已转化为不动点形式 $x = \varphi \left( x\right)$ 的给定方程,迭代法

$$
{x}_{n + 1} = \varphi \left( {x}_{n}\right) \;\left( {n = 0,1,\cdots ;{x}_{0}\text{ 给定 }}\right)  \tag{19.3}
$$

称为一般迭代法. 如果在 ${x}^{ * }$ 邻域内满足

$$
\left| \frac{\varphi \left( x\right)  - \varphi \left( {x}^{ * }\right) }{x - {x}^{ * }}\right|  \leq  K < 1, \tag{19.4}
$$

其中 $K$ 为常数,而且初值在该邻域内,它将收敛到解 ${x}^{ * }$ (图 19.2). 如果函数 $\varphi \left( x\right)$ 可导, 则相应的条件变为

$$
{\varphi }^{\prime }\left( x\right)  \leq  K < 1, \tag{19.5}
$$

常数 $K$ 越小,一般迭代法的收敛速度越快. $\square {x}^{2} = \sin x$ ,即

$$
{x}_{n + 1} = \sqrt{\sin {x}_{n}}.
$$

迭代过程如右表.

![01937d01-b6f6-7881-8294-3a9c82211946_1_530_1051_580_507_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_1_530_1051_580_507_0.jpg)

图 19.2

<table><tr><td>$n$</td><td>0</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr><tr><td>${x}_{n}$</td><td>0.87</td><td>0.8742</td><td>0.8758</td><td>0.8764</td><td>0.8766</td><td>$\underline{0.8767}$</td></tr><tr><td>$\sin {x}_{n}$</td><td>0.7643</td><td>0.7670</td><td>0.7681</td><td>0.7684</td><td>0.7686</td><td>0.7686</td></tr></table>

注 (1) 在复数解的情况下,设 $x = u + \mathrm{i}v$ ,分别对实部与虚部组成的两个未知量的方程组求解未知的实数 $u, v$ .

注 (2) 迭代法求解非线性方程组可以参见第 1249 页 19.2.2.

##### 19.1.1.2 牛顿法

## 1. 牛顿法的公式

为了求解形如 $f\left( x\right)  = 0$ 的给定方程,最常用到的牛顿法有如下形式:

$$
{x}_{n + 1} = {x}_{n} - \frac{f\left( {x}_{n}\right) }{{f}^{\prime }\left( {x}_{n}\right) }\;\left( {n = 0,1,\cdots ;{x}_{0}\text{ 给定 }}\right) . \tag{19.6}
$$

即: 为了得到新的近似值 ${x}_{n + 1}$ ,需要计算函数 $f\left( x\right)$ 与其一阶导数 ${f}^{\prime }\left( x\right)$ 在点 ${x}_{n}$ 处的值.

2. 牛顿法的收敛条件

$$
{f}^{\prime }\left( x\right)  \neq  0 \tag{19.7a}
$$

是牛顿法收敛的必要条件, 条件

$$
\left| \frac{f\left( x\right) {f}^{\prime \prime }\left( x\right) }{{f}^{\prime 2}\left( x\right) }\right|  \leq  K < 1 \tag{19.7b}
$$

是牛顿法收敛的充分条件. 需要在解 ${x}^{ * }$ 及其邻域内所有的点 ${x}_{n}$ 都满足条件 (19.7a, 19.7b). 如果牛顿法收敛,其收敛速度非常快. 它是平方阶收敛的,即第 $n + 1$ 个近似值的误差远小于一个常数乘以第 $n$ 个近似值的误差的平方. 在十进制中,这意味着经过迭代准确值的位数成倍增加.

I 求解方程 $f\left( x\right)  = {x}^{2} - a = 0$ ,即计算 $x = \sqrt{a}(a > 0$ 给定),由牛顿法得到迭代公式为

$$
{x}_{n + 1} = \frac{1}{2}\left( {{x}_{n} + \frac{a}{{x}_{n}}}\right) . \tag{19.8}
$$

对于 $a = 2$ ,有

<table><tr><td>$n$</td><td>0</td><td>1</td><td>2</td><td>3</td></tr><tr><td>${x}_{n}$</td><td>1.5</td><td>1.4166666</td><td>1.4142157</td><td>1.4142136</td></tr></table>

## 3. 几何插值

牛顿法几何插值可以表示为图 19.3. 牛顿法的基本思想是用函数 $y = f\left( x\right)$ 的切线得到局部近似值.

![01937d01-b6f6-7881-8294-3a9c82211946_2_555_1639_526_422_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_2_555_1639_526_422_0.jpg)

图 19.3

## 4. 修正牛顿法

如果在迭代过程中 ${f}^{\prime }\left( {x}_{n}\right)$ 的数值几乎不变,它在一段时间内保持为常数,可用所谓修正牛顿法

$$
{x}_{n + 1} = {x}_{n} - \frac{f\left( {x}_{n}\right) }{{f}^{\prime }\left( {x}_{m}\right) }\;\left( {m\text{ 给定,}m < n}\right) . \tag{19.9}
$$

这种简化的好处是其收敛阶几乎没有任何改变.

## 5. 复变量的可微函数

牛顿法对于复变量的可微函数同样适用.

##### 19.1.1.3 试位法

## 1. 试位法的公式

为求解形如 $f\left( x\right)  = 0$ 的方程,试位法具有如下形式:

$$
{x}_{n + 1} = {x}_{n} - \frac{{x}_{n} - {x}_{m}}{f\left( {x}_{n}\right)  - f\left( {x}_{m}\right) }f\left( {x}_{n}\right) \;\left( {n = 1,2,\cdots ;{x}_{0},{x}_{1}\text{ 给定,}m < n}\right) . \tag{19.10}
$$

该方法仅需要计算函数值. 该方法源于牛顿法 (19.6),而导数 ${f}^{\prime }\left( {x}_{n}\right)$ 由 $f\left( x\right)$ 在点 ${x}_{n}$ 与前一个点 ${x}_{m}$ 的有限差分近似得到 $\left( {m < n}\right)$ .

## 2. 几何插值

试位法几何插值可以表示为图 19.4. 试位法的基本思想是用曲线 $y = f\left( x\right)$ 的切线得到局部近似值.

![01937d01-b6f6-7881-8294-3a9c82211946_3_555_1385_529_419_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_3_555_1385_529_419_0.jpg)

图 19.4

## 3. 收敛性

当选取的 $m$ 使得 $f\left( {x}_{n}\right)$ 和 $f\left( {x}_{m}\right)$ 一直是异号时,方法 (19.10) 是收敛的. 若在迭代过程中收敛速度已经足够快,可以忽略符号改变,只要用 ${x}_{m} = {x}_{n - 1}$ 就可以增加收敛速度.

- 计算 $f\left( x\right)  = {x}^{2} - \sin x = 0$ .

<table><tr><td>$n$</td><td>$\Delta {x}_{n} = {x}_{n} - {x}_{n - 1}$</td><td>${x}_{n}$</td><td>$f\left( {x}_{n}\right)$</td><td>$\Delta {y}_{n} = f\left( {x}_{n}\right)  - f\left( {x}_{n - 1}\right)$</td><td>$\Delta {x}_{n}$ $\Delta {y}_{n}$</td></tr><tr><td>0</td><td/><td>0.9</td><td>0.0267</td><td/><td/></tr><tr><td>1</td><td>-0.3</td><td>0.87</td><td>-0.0074</td><td>-0.0341</td><td>0.8798</td></tr><tr><td>2</td><td>0.0065</td><td>0.8765</td><td>-0.000252</td><td>0.007148</td><td>0.9093</td></tr><tr><td>3</td><td>0.000229</td><td>0.876729</td><td>0.000003</td><td>0.000255</td><td>0.8980</td></tr><tr><td>4</td><td>-0.000003</td><td>0.876726</td><td/><td/><td/></tr></table>

如果计算过程中 $\Delta {x}_{n}/\Delta {y}_{n}$ 的数值几乎不变,就不用一次一次地继续计算了.

## 4. 斯特芬森方法

应用试位法取 ${x}_{m} = {x}_{n - 1}$ 求解方程 $f\left( x\right)  = x - \varphi \left( x\right)  = 0$ ,其收敛速度可以提高,尤其是 ${\varphi }^{\prime }\left( x\right)  <  - 1$ 的情况. 该算法被称为斯特芬森 (Steffensen) 方法.

应用斯特芬森方法求解 ${x}^{2} = \sin x$ ,需要用到 $f\left( x\right)  = x - \sqrt{\sin x} = 0$ .

<table><tr><td>$n$</td><td>$\Delta {x}_{n} = {x}_{n} - {x}_{n - 1}$</td><td>${x}_{n}$</td><td>$f\left( {x}_{n}\right)$</td><td>${\Delta y} = f\left( {x}_{n}\right)  - f\left( {x}_{n - 1}\right)$</td><td>$\Delta {x}_{n}$ $\Delta {y}_{n}$</td></tr><tr><td>0</td><td/><td>0.9</td><td>0.014942</td><td/><td/></tr><tr><td>1</td><td>-0.03</td><td>0.87</td><td>-0.004259</td><td>-0.019201</td><td>1.562419</td></tr><tr><td>2</td><td>0.006654</td><td>0.876654</td><td>-0.000046</td><td>0.004213</td><td>1.579397</td></tr><tr><td>3</td><td/><td>0.876727</td><td>0.000001</td><td/><td/></tr></table>

#### 19.1.2 多项式方程的解

$n$ 次多项式方程具有如下形式:

$$
f\left( x\right)  = {p}_{n}\left( x\right)  = {a}_{n}{x}^{n} + {a}_{n - 1}{x}^{n - 1} + \cdots  + {a}_{1}x + {a}_{0} = 0. \tag{19.11}
$$

为求有效解需要这些函数值 ${p}_{n}\left( x\right)$ 及其导数值的有效计算方法,以及根的位置的初始估计.

##### 19.1.2.1 霍纳格式

## 1. 实数情况

为通过 $n$ 次多项式 ${p}_{n}\left( x\right)$ 的系数得到在 $x = {x}_{0}$ 处的根,首先考虑如下分解:

$$
{p}_{n}\left( x\right)  = {a}_{n}{x}^{n} + {a}_{n - 1}{x}^{n - 1} + \cdots  + {a}_{1}x + {a}_{0} = \left( {x - {x}_{0}}\right) {p}_{n - 1}\left( x\right)  + {p}_{n}\left( {x}_{0}\right) ,(1 \tag{19.12}
$$

这里 ${p}_{n - 1}\left( x\right)$ 表示次数为 $n - 1$ 次多项式

$$
{p}_{n - 1}\left( x\right)  = {a}_{n - 1}^{\prime }{x}^{n - 1} + {a}_{n - 2}^{\prime }{x}^{n - 2} + \cdots  + {a}_{1}^{\prime }x + {a}_{0}^{\prime }. \tag{19.13}
$$

递推公式

$$
{a}_{k - 1}^{\prime } = {x}_{0}{a}_{k}^{\prime } + {a}_{k}\;\left( {k = n, n - 1,\cdots ,0;{a}_{n}^{\prime } = 0;{a}_{-1}^{\prime } = {p}_{n}\left( {x}_{0}\right) }\right)  \tag{19.14}
$$

可以根据 (19.12) 对比 ${x}^{k}$ 的系数得到 (注意 ${a}_{n - 1}^{\prime } = {a}_{n}$ ). 通过这种方法,多项式 ${p}_{n - 1}\left( x\right)$ 的系数 ${a}_{k}^{\prime }$ 与值 ${p}_{n}\left( {x}_{0}\right)$ 可以通过 ${p}_{n}\left( x\right)$ 的系数 ${a}_{k}$ 确定. 进一步,重复上述 “传统” 的方法,分解多项式 ${p}_{n - 1}\left( x\right)$ 得到 ${p}_{n - 2}\left( x\right)$ ,

$$
{p}_{n - 1}\left( x\right)  = \left( {x - {x}_{0}}\right) {p}_{n - 2}\left( x\right)  + {p}_{n - 1}\left( {x}_{0}\right) , \tag{19.15}
$$

即得到多项式序列 ${p}_{n}\left( x\right) ,{p}_{n - 1}\left( x\right) ,\cdots ,{p}_{1}\left( x\right) ,{p}_{0}\left( x\right)$ . 计算多项式的系数和相应的值可以表示为

<table><tr><td rowspan="3">${x}_{0}$</td><td rowspan="3">${a}_{n}$</td><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>${a}_{n - 1}$</td><td>${a}_{n - 2}$</td><td>...</td><td>${a}_{3}$</td><td>${a}_{2}$</td><td>${a}_{1}$</td><td>${a}_{0}$</td></tr><tr><td>${x}_{0}{a}_{n - 1}^{\prime }$</td><td>${x}_{0}{a}_{n - 2}^{\prime }$</td><td>...</td><td>${x}_{0}{a}_{3}^{\prime }$</td><td>${x}_{0}{a}_{2}^{\prime }$</td><td>${x}_{0}{a}_{1}^{\prime }$</td><td>${x}_{0}{a}_{0}^{\prime }$</td></tr><tr><td rowspan="2">${x}_{0}$</td><td rowspan="2">${a}_{n - 1}^{\prime }$</td><td>${a}_{n - 2}^{\prime }$</td><td>${a}_{n - 3}^{\prime }$</td><td>...</td><td>${a}_{2}^{\prime }$</td><td>${a}_{1}^{\prime }$</td><td>${a}_{0}^{\prime }$</td><td>${p}_{n}\left( {x}_{0}\right)$</td></tr><tr><td>${x}_{0}{a}_{n - 2}^{\prime \prime }$</td><td>${x}_{0}{a}_{n - 3}^{\prime \prime }$</td><td>...</td><td>${x}_{0}{a}_{2}^{\prime \prime }$</td><td>${x}_{0}{a}_{1}^{\prime \prime }$</td><td colspan="2">${x}_{0}{a}_{0}^{\prime \prime }$</td></tr><tr><td rowspan="2">${x}_{0}$</td><td>${a}_{n - 2}^{\prime \prime }$</td><td>${a}_{n - 3}^{\prime \prime }$</td><td>${a}_{n - 4}^{\prime \prime }$</td><td>...</td><td>${a}_{1}^{\prime \prime }$</td><td>${a}_{0}^{\prime \prime }$</td><td colspan="2">${p}_{n - 1}\left( {x}_{0}\right)$</td></tr><tr><td colspan="2">${x}_{0}{a}_{0}^{\left( n - 1\right) }$</td><td/><td/><td/><td/><td/><td/></tr><tr><td rowspan="3">${x}_{0}$</td><td rowspan="3">${a}_{1}^{\left( n - 1\right) }$</td><td>${p}_{1}\left( {x}_{0}\right)$</td><td/><td/><td/><td/><td/><td/></tr><tr><td/><td/><td/><td/><td/><td/><td/></tr><tr><td>${a}_{0}^{\left( n\right) } = {p}_{0}\left( {x}_{0}\right)$</td><td/><td/><td/><td/><td/><td/></tr></table>

(19.16)

从格式 (19.16) 得到多项式的值 ${p}_{n}\left( {x}_{0}\right)$ 及其导数值 ${p}_{n}^{\left( k\right) }\left( {x}_{0}\right)$ 分别为

$$
{p}_{n}^{\prime }\left( {x}_{0}\right)  = 1!{p}_{n - 1}\left( {x}_{0}\right) ,\;{p}_{n}^{\prime \prime }\left( {x}_{0}\right)  = 2!{p}_{n - 2}\left( {x}_{0}\right) ,\;\cdots ,\;{p}_{n}^{\left( n\right) }\left( {x}_{0}\right)  = n!{p}_{0}\left( {x}_{0}\right) .
$$

(19.17)

$l{p}_{4}\left( x\right)  = {x}^{4} + 2{x}^{3} - 3{x}^{2} - 7$ . 根据 (19.16) 计算 ${p}_{4}\left( x\right)$ 及其导数在 ${x}_{0} = 2$ 处的值.

![01937d01-b6f6-7881-8294-3a9c82211946_5_386_1583_442_675_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_5_386_1583_442_675_0.jpg)

可得

$$
{p}_{4}\left( 2\right)  = {13},
$$

$$
{p}_{4}^{\prime }\left( 2\right)  = {44}
$$

$$
{p}_{4}^{\prime \prime }\left( 2\right)  = {66},
$$

$$
{p}_{4}^{\prime \prime \prime }\left( 2\right)  = {60},
$$

$$
{p}_{4}^{\left( 4\right) }\left( 2\right)  = {24}\text{.}
$$

注 (1) 多项式 ${p}_{n}\left( x\right)$ 可以表述成 $x - {x}_{0}$ 的形式,在这个例子中

$$
{p}_{4}\left( x\right)  = {\left( x - 2\right) }^{4} + {10}{\left( x - 2\right) }^{3} + {33}{\left( x - 2\right) }^{2} + {44}\left( {x - 2}\right)  + {13}.
$$

(2) 霍纳格式也可以用来计算复系数 ${a}_{k}$ . 这种情况下我们需要根据 (19.16 分别计算实部和虚部.

2. 复数情况

如果 (19.11) 中的系数 ${a}_{k}$ 为实数,则对复数值 ${x}_{0} = {u}_{0} + \mathrm{i}{v}_{0}$ 也可计算 ${p}_{n}\left( {x}_{0}\right)$ . 为说明这一点,对 ${p}_{n}\left( x\right)$ 作如下分解.

$$
{p}_{n}\left( x\right)  = {a}_{n}{x}^{n} + {a}_{n - 1}{x}^{n - 1} + \cdots  + {a}_{1}x + {a}_{0}
$$

$$
= \left( {{x}^{2} - {px} - q}\right) \left( {{a}_{n - 2}^{\prime }{x}^{n - 2} + \cdots  + {a}_{0}^{\prime }}\right)  + {r}_{1}x + {r}_{0}, \tag{19.18a}
$$

其中

$$
{x}^{2} - {px} - q = \left( {x - {x}_{0}}\right) \left( {x - {\bar{x}}_{0}}\right) \text{,即}p = 2{u}_{0}, q =  - \left( {{u}_{0}{}^{2} + {v}_{0}{}^{2}}\right) \text{.} \tag{19.18b}
$$

于是

$$
{p}_{n}\left( {x}_{0}\right)  = {r}_{1}x + {r}_{0} = \left( {{r}_{1}{u}_{0} + {r}_{0}}\right)  + \mathrm{i}{r}_{1}{v}_{0}. \tag{19.18c}
$$

为得到 (19.18a) 科拉茨 (Collatz) 引进所谓双列霍纳格式 (two-row Horner scheme), 其构造如下:(19.18d)

$$
\begin{array}{l} q = {a}_{n} + 2{a}_{n}^{\prime }{a}_{n}^{\prime }{a}_{n}^{\prime }{a}_{n}^{\prime }{a}_{n}^{\prime }{a}_{n}^{\prime } \\  \end{array}
$$

I ${p}_{4}\left( x\right)  = {x}^{4} + 2{x}^{3} - 3{x}^{2} - 7$ 在点 ${x}_{0} = 2 - \mathrm{i}$ 处计算 ${p}_{4}$ 的值,即由 $p = 4, q =  - 5$ 得到 ${p}_{4}\left( {x}_{0}\right)  = {34}{x}_{0} - {87} =  - {19} - {34}\mathrm{i}$ .

$$
\begin{array}{rrrr} {12} &  - 3 & 0 &  - 7 \\   - 5 &  - {50} &  - {80} & \\  4 & {24} & {64} & \\  1 & 6 & {16} & {34} \\   & & &  \end{array}
$$

##### 19.1.2.2 根的位置

## 1. 实根、斯图姆序列

笛卡儿符号法则给出了多项式方程 (19.11) 是否有实根的原始思想.

a) 正实根的个数等于系数序列

$$
{a}_{n},{a}_{n - 1},\cdots ,{a}_{1},{a}_{0} \tag{19.19a}
$$

改变符号的次数, 或扣除一个偶数.

b) 负实根的个数等于系数序列

$$
{a}_{0}, - {a}_{1},{a}_{2},\cdots ,{\left( -1\right) }^{n}{a}_{n} \tag{19.19b}
$$

改变符号的次数, 或扣除一个偶数.

${p}_{5}\left( x\right)  = {x}^{5} - 6{x}^{4} + {10}{x}^{3} + {13}{x}^{2} - {15x} - {16}$ 有 1 个或者 3 个正根以及 0 个或者 2 个负根. 为了得到给定区间(a, b)内实根的个数,可以用斯图姆 (Sturm) 序列 (参见第 57 页 1.6.3.2,2.). 在计算均匀节点 ${x}_{v} = {x}_{0} + {vh}\left( {h\text{常数,}v = 0,1,2,\cdots }\right)$ 上的函数值 ${y}_{v} = {p}_{n}\left( {x}_{v}\right)$ (利用霍纳格式容易执行) 后,可得函数图形和根的位置的好的猜测. 如果 ${p}_{n}\left( c\right)$ 和 ${p}_{n}\left( d\right)$ 有不同的符号,在 $c$ 与 $d$ 之间至少存在一个实根.

## 2. 复根

为了在有界复平面区域上限定实数根或者复数根的位置, 考察如下多项式方程, 这是 (19.11) 的简单推广:

$$
{f}^{ * }\left( x\right)  = \left| {a}_{n - 1}\right| {r}^{n - 1} + \left| {a}_{n - 2}\right| {r}^{n - 2} + \cdots  + \left| {a}_{1}\right| r + \left| {a}_{0}\right|  = \left| {a}_{n}\right| {r}^{n}. \tag{19.20}
$$

通过系统的重复试错,对 (19.20) 的正根决定一个上界 ${r}_{0}$ . 于是对 (19.11) 所有的根 ${x}_{k}^{ * }\left( {k = 1,2,\cdots , n}\right)$ 有

$$
\left| {x}_{k}^{ * }\right|  \leq  {r}_{0} \tag{19.21}
$$

$$
f\left( x\right)  = {p}_{4}\left( x\right)  = {x}^{4} + {4.4}{x}^{3} - {20.01}{x}^{2} - {50.12x} + {29.45} = 0,{f}^{ * }\left( x\right)  = {4.4}{r}^{3} +
$$

${20.01}{r}^{2} + {50.12r} + {29.45} = {r}^{4}$ ,某些试验是

$$
r = 6 : \;{f}^{ * }\left( 6\right)  = {2000.93} > {1296} = {r}^{4},
$$

$$
r = 7 : \;{f}^{ * }\left( 7\right)  = {2869.98} > {2401} = {r}^{4},
$$

$$
r = 8 : \;{f}^{ * }\left( 8\right)  = {3963.85} < {4096} = {r}^{4}.
$$

据此有 $\left| {x}_{k}^{ * }\right|  < 8\left( {k = 1,2,3,4}\right)$ . 实际上,对于有最大绝对值的根 ${x}_{1}^{ * }, - 7 < {x}_{1}^{ * } <  - 6$ 成立.

注 为确定带负实部的复根个数, 在电子技术所谓根轨迹理论中发展了一种特别的方法, 该方法可用来检验稳定性 (见 [19.14][19.40]).

##### 19.1.2.3 数值方法

## 1. 一般方法

在 19.1.1 讨论的方法可用来求多项式方程的实数根. 牛顿法由于其快速收敛性以及函数值 $f\left( {x}_{n}\right)$ 与导数值 ${f}^{\prime }\left( {x}_{n}\right)$ 可用霍纳法则容易计算,非常适用于多项式方程. 假设多项式方程 $f\left( x\right)  = 0$ 的根 ${x}^{ * }$ 的近似值 ${x}_{n}$ 充分好,则修正项 $\delta  = {x}^{ * } - {x}_{n}$ 可以用不动点方程

$$
\delta  = \frac{1}{{f}^{\prime }\left( {x}_{n}\right) }\left\lbrack  {f\left( {x}_{n}\right)  + \frac{1}{2}{f}^{\prime \prime }\left( {x}_{n}\right)  + \cdots }\right\rbrack   = \varphi \left( \delta \right)  \tag{19.22}
$$

迭代修正

## 2. 特殊方法

贝尔斯托 (Bairstow) 法常用于求成对的根, 尤其是成对的共轭复根. 该方法类似于霍纳格式 $\left( {{19.18}\mathrm{a} \sim  {19.18}\mathrm{d}}\right)$ ,从求给定多项式的二次因子出发,通过确定系数 $p$ 和 $q$ ,使得线性余项 ${r}_{1}$ 和 ${r}_{0}$ 的系数等于零 ([19.38],[19.14],[19.40]).

如果需要计算根的绝对值的最大值与最小值, 可以选择使用伯努利方法 (见[19.38]).

格雷费 (Graeffe) 法有某些历史重要性. 它同时给出包括复共轭根在内的所有的根; 然而其计算量非常巨大 ([19.14],[19.40]).

### 19.2 方程组的数值解

在许多实际问题中,对 $n$ 个未知量 ${x}_{i}\left( {i = 1,2,\cdots , n}\right)$ 有 $m$ 个条件,方程组的形式为

$$
{F}_{1}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = 0,
$$

$$
{F}_{2}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = 0, \tag{19.23}
$$

......

$$
{F}_{m}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = 0.
$$

求得未知量 ${x}_{i}$ 则得到方程组 (19.23) 的解.

通常 $m = n$ 成立,即未知量的个数与方程的个数相等. 如果 $m > n,({19.23}$ 称为超定方程组; 如果 $m < n,\left( {19.23}\right)$ 称为不定方程组;

超定方程组通常可能没有解. 于是在欧几里得空间里用最小二乘法求 (19.23) 的 “最优” 解

$$
\mathop{\sum }\limits_{{i = 1}}^{m}{F}_{i}^{2}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = \min ! \tag{19.24}
$$

或者用其他极值问题来求解. 不定方程组通常有 $n - m$ 个变量的值可以自由选取, 因此 (19.23) 的解依赖于 $n - m$ 个参数,被称为 $n - m$ 维流形解.

线性或非线性方程组的差别在于, 方程对未知量是否仅是线性的或也有非线性的.

#### 19.2.1 线性方程组

考虑线性方程组

$$
{a}_{11}{x}_{1} + {a}_{12}{x}_{2} + \cdots  + {a}_{1n}{x}_{n} = {b}_{1},
$$

$$
{a}_{21}{x}_{1} + {a}_{22}{x}_{2} + \cdots  + {a}_{2n}{x}_{n} = {b}_{2}, \tag{19.25}
$$

......

$$
{a}_{n1}{x}_{1} + {a}_{n2}{x}_{2} + \cdots  + {a}_{nn}{x}_{n} = {b}_{n}.
$$

方程组 (19.25) 可以写成矩阵形式

$$
\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}} \tag{19.26a}
$$

其中

$$
\mathbf{A} = \left( \begin{matrix} {a}_{11} & {a}_{12} & \cdots & {a}_{1n} \\  {a}_{21} & {a}_{22} & \cdots & {a}_{2n} \\  \vdots & \vdots & & \vdots \\  {a}_{n1} & {a}_{n2} & \cdots & {a}_{nn} \end{matrix}\right) ,\;\underline{\mathbf{b}} = \left( \begin{matrix} {b}_{1}, \\  {b}_{2}, \\  \vdots \\  {b}_{n} \end{matrix}\right) ,\;\underline{\mathbf{x}} = \left( \begin{matrix} {x}_{1}, \\  {x}_{2}, \\  \vdots \\  {x}_{n} \end{matrix}\right) . \tag{19.26b}
$$

如果矩阵 $\mathbf{A}$ 是 $n$ 阶正定的,则方程组 (19.25) 有唯一解 (参见第 412 页 4.5.2.1,2.). 实际求解方程 (19.25) 时, 主要有如下两类方法:

(1) 直接法 直接法基于元素变换, 据此可以直接得到方程组的解. 主元素选取的技巧 (参见第 412 页 4.5.1.2) 及其方法介绍见第 1242 页 19.2.1.1 至第 1246 页 19.2.1.3.

(2) 迭代法 始于解的初始近似值, 构成近似值的序列收敛到 (19.25) 的解 (参见第 1248 页 19.2.1.4).

##### 19.2.1.1 矩阵的三角分解

1. 高斯消元法的原理

根据元素变换

(1) 交换行;

(2)某一行乘以非零数；

(3) 将某一行乘以非零数加到另一行.

线性方程组 $\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}}$ 的变换称之为行变换

$$
\mathbf{R}\underline{\mathbf{x}} = \underline{\mathbf{c}}\text{,其中 }\mathbf{R} = \left( \begin{matrix} {r}_{11} & {r}_{12} & {r}_{13} & \cdots & {r}_{1n} \\   & {r}_{22} & {r}_{23} & \cdots & {r}_{2n} \\   & & {r}_{33} & \cdots & {r}_{3n} \\   & 0 & &  \ddots  & \vdots \\   & & & & {r}_{nn} \end{matrix}\right) \text{. } \tag{19.27}
$$

因为上述变换都是等价变换,方程组 $\mathbf{R}\underline{\mathbf{x}} = \underline{\mathbf{c}}$ 与方程组 $\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}}$ 有相同的解, 从 (19.27) 可得

$$
{x}_{n} = \frac{{c}_{n}}{{r}_{nn}},\;{x}_{i} = \frac{1}{{r}_{ii}}\left( {{c}_{i} - \mathop{\sum }\limits_{{k = i + 1}}^{n}{r}_{ik}{x}_{k}}\right) \;\left( {i = n - 1, n - 2,\cdots ,1}\right) . \tag{19.28}
$$

规则 (19.28) 称为向后代换法, 因为 (19.27) 的方程按倒序求解.

变换从 $\mathbf{A}$ 到 $\mathbf{R}$ 经过 $n - 1$ 步,所谓消元. 其第一步如下. 这一步将矩阵 $\mathbf{A}$ 变换成 ${\mathbf{A}}_{1}$ :

$$
\mathbf{A} = \left( \begin{matrix} {a}_{11} & {a}_{12} & \cdots & {a}_{1n} \\  {a}_{21} & {a}_{22} & \cdots & {a}_{2n} \\  {a}_{31} & {a}_{32} & \cdots & {a}_{3n} \\  \vdots & \vdots & & \vdots \\  {a}_{n1} & {a}_{n2} & \cdots & {a}_{nn} \end{matrix}\right) ,\;{\mathbf{A}}_{1} = \left( \begin{matrix} {a}_{11}^{\left( 1\right) } & {a}_{12}^{\left( 1\right) }\cdots {a}_{1n}^{\left( 1\right) } \\  0 & {a}_{22}^{\left( 1\right) }\cdots {a}_{2n}^{\left( 1\right) } \\  0 & {a}_{32}^{\left( 1\right) }\cdots {a}_{3n}^{\left( 1\right) } \\  \vdots & \vdots \\  0 & {a}_{n2}^{\left( 1\right) }\cdots {a}_{nn}^{\left( 1\right) } \end{matrix}\right) . \tag{19.29}
$$

于是:

(1) 选取 ${a}_{r1} \neq  0$ (根据 (19.33)). 如果没有, $\mathbf{A}$ 奇异,停止. 否则 ${a}_{r1}$ 称为主元.

(2) 交换矩阵 $\mathbf{A}$ 的第一行与第 $r$ 行,得到矩阵 $\overline{\mathbf{A}}$ .

(3) 第 ${l}_{i1}\left( {i = 2,3,\cdots , n}\right)$ 乘以第一行减去矩阵 $\overline{\mathbf{A}}$ 第 $r$ 行.

于是得到矩阵 ${\mathbf{A}}_{1}$ ,与之类似得到右端 ${b}_{1}$ 的新元素

$$
{a}_{ik}^{\left( 1\right) } = {\bar{a}}_{ik} - {l}_{i1}{\bar{a}}_{1k}\text{,其中 }{l}_{i1} = \frac{{\bar{a}}_{i1}}{{\bar{a}}_{11}}\text{,}
$$

$$
{b}_{i}^{\left( 1\right) } = {\bar{b}}_{i} - {l}_{i1}{\bar{b}}_{1}\;\left( {i, k = 2,3,\cdots , n}\right) . \tag{19.30}
$$

子矩阵 ${\mathbf{A}}_{1}$ (见 (19.29)) 为一个(n - 1, n - 1)矩阵,它可以类似于矩阵 $\mathbf{A}$ 进行处理. 该方法称为高斯消元法或者称为高斯算法 (参见第 417 页 4.5.2.4).

## 2. 三角分解

高斯消元法的结果可以归结为: 对于每个正规矩阵 $\mathbf{A}$ ,存在一个称为三角分解或者 ${LU}$ 因子分解,形如

$$
\mathbf{{PA}} = \mathbf{{LR}} \tag{19.31}
$$

其中

$$
\mathbf{R} = \left( \begin{matrix} {r}_{11} & {r}_{12} & {r}_{13} & \cdots & {r}_{1n} \\   & {r}_{22} & {r}_{23} & \cdots & {r}_{2n} \\   & & {r}_{33} & \cdots & {r}_{3n} \\   & 0 & &  \ddots  & \vdots \\   & & & & {r}_{nn} \end{matrix}\right) ,\;\mathbf{L} = \left( \begin{matrix} 1 & & & & \\  {l}_{21} & 1 & & 0 & \\  {l}_{31} & {l}_{32} & 1 & & \\  \vdots & \vdots & &  \ddots  & \\  {l}_{n1} & {l}_{n2} & \cdots & {l}_{n, n - 1} & 1 \end{matrix}\right) .
$$

(19.32)

这里 $\mathbf{R}$ 称为上三角矩阵, $\mathbf{L}$ 称为下三角矩阵, $\mathbf{P}$ 称为置换矩阵. 如果一个置换矩阵的行列交叉处为 1,其他元素都为零,该矩阵称为二次矩阵. 乘积 $\mathbf{{PA}}$ 导致矩阵 $\mathbf{A}$ 的行变换. 在消元的过程中需要选择主元.

- 用高斯消元法求解方程组

$$
\left( \begin{array}{lll} 3 & 1 & 6 \\  2 & 1 & 3 \\  1 & 1 & 1 \end{array}\right) \left( \begin{array}{l} {x}_{1} \\  {x}_{2} \\  {x}_{3} \end{array}\right)  = \left( \begin{array}{l} 2 \\  7 \\  4 \end{array}\right)
$$

按图解形式, 系数矩阵与右端列向量可以靠近写在一起 (称为增广矩阵), 计算如下:

$$
\left( {\mathbf{A},\underline{\mathbf{b}}}\right)  = \left( \begin{matrix} 3 & 1 & 6 \\  2 & 1 & 3 \\  1 & 1 & 1 \end{matrix}\right) \left| \begin{array}{l} 2 \\  7 \\  4 \end{array}\right|  \Rightarrow  \left( \begin{matrix} 3 & 1 & 6 \\  2/3 & 1 & 2 \\  1/3 & 2 & 1 \end{matrix}\right)  = \left( \begin{matrix} 3 & 1 & 6 & 2 \\  1/3 &  - 1 & 1 & {17}/3 \\  {10}/3 &  - 1 & {10}/3 &  \end{matrix}\right)
$$

$$
\Rightarrow  \left( \begin{matrix} 3 & 1 & 6 & 2 \\  1/3 & 2/3 &  - 1 & {10}/3 \\  2/3 & 1/2 &  - 1/2 & 4 \end{matrix}\right)
$$

即

$$
\mathbf{P} = \left( \begin{array}{lll} 1 & 0 & 0 \\  0 & 0 & 1 \\  0 & 1 & 0 \end{array}\right)  \Rightarrow  \mathbf{{PA}} = \left( \begin{array}{lll} 3 & 1 & 6 \\  1 & 1 & 1 \\  2 & 1 & 3 \end{array}\right)
$$

$$
\mathbf{L} = \left( \begin{matrix} 1 & 0 & 0 \\  1/3 & 1 & 0 \\  2/3 & 1/2 & 1 \end{matrix}\right) ,\;\mathbf{R} = \left( \begin{matrix} 3 & 1 & 6 \\  0 & 2/3 &  - 1 \\  0 & 0 &  - 1/2 \end{matrix}\right) .
$$

在系数矩阵 $\mathbf{A},{\mathbf{A}}_{1},{\mathbf{A}}_{2}$ 中,主元在矩阵中用方框表示,其解为 ${x}_{3} =  - 8,{x}_{2} =$ $- 7,{x}_{1} = {19}$ .

## 3. 三角分解的应用

借助于三角分解,求解线性方程组 $\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}}$ 可以表述为以下三步:

(1) $\mathbf{{PA}} = \mathbf{{LR}}$ : 确定三角分解并作代换 $\mathbf{R}\underline{\mathbf{x}} = \underline{\mathbf{c}}$ .

(2) $\mathbf{L}\underline{\mathbf{c}} = \mathbf{P}\underline{\mathbf{b}}$ : 通过向前代换确定辅助变量 $\underline{\mathbf{c}}$ .

(3) $\mathbf{R}\underline{\mathbf{x}} = \underline{\mathbf{c}}$ : 通过向后代换确定解向量 $\underline{\mathbf{x}}$ .

如果如同上例中用增广矩阵 $\left( {\mathbf{A},\underline{\mathbf{b}}}\right)$ 处理线性方程组,用高斯消元法求解,那么下三角矩阵 $\mathbf{L}$ 并不需要显式得到. 该方法对于左边系数矩阵相同,而右端项不同的多个线性方程组尤为适用.

## 4. 主元的选取

理论上,矩阵 ${\mathbf{A}}_{k - 1}$ 的任意一个第一列的非零元 ${a}_{i1}^{\left( k - 1\right) }$ 都可以选为第 $k$ 次消元的主元. 为了改进解的准确性 (减少运行过程中的积累误差), 建议用如下策略.

(1) 对角策略 若有可能, 对角元素被成功选为主元, 即无行变换. 若主对角线元素的绝对值比同一行的其他元素的绝对值大得多, 这种选取可行.

(2) 列主元 在实施第 $k$ 步消元时,选第 $r$ 行使得

$$
\left| {a}_{rk}^{\left( k - 1\right) }\right|  = \mathop{\max }\limits_{{i \geq  k}}\left| {a}_{ik}^{\left( k - 1\right) }\right| . \tag{19.33}
$$

若 $r \neq  k$ ,则交换第 $r$ 行与第 $k$ 行. 可证明该策略能使累计舍入误差小一些.

##### 19.2.1.2 对称系数矩阵的楚列斯基方法

在许多情况下,(19.26a) 中的系数矩阵 $\mathbf{A}$ 不仅仅是对称的,而且是正定的,此时相应的二次型 $Q\left( \underline{x}\right)$ 为

$$
Q\left( \underline{\mathbf{x}}\right)  = {\underline{\mathbf{x}}}^{\mathrm{T}}\mathbf{A}\underline{\mathbf{x}} = \mathop{\sum }\limits_{{i = 1}}^{n}\mathop{\sum }\limits_{{k = 1}}^{n}{a}_{ik}{x}_{i}{x}_{k} > 0, \tag{19.34}
$$

其中 $\underline{\mathbf{x}} \in  {\mathbb{R}}^{n},\underline{\mathbf{x}} \neq  \mathbf{0}$ . 由于每一个正定矩阵存在唯一个三角分解

$$
\mathbf{A} = \mathbf{L}{\mathbf{L}}^{\mathrm{T}} \tag{19.35}
$$

其中

$$
\mathbf{L} = \left( \begin{matrix} {l}_{11} & & & & \\  {l}_{21} & {l}_{22} & & 0 & \\  {l}_{31} & {l}_{32} & {l}_{33} & & \\  \vdots & \vdots & \vdots &  \ddots  & \\  {l}_{n1} & {l}_{n2} & {l}_{n3} & \cdots & {l}_{nn} \end{matrix}\right) , \tag{19.36a}
$$

$$
{l}_{kk} = \sqrt{{a}_{kk}^{\left( k - 1\right) }},\;{l}_{ik} = \frac{{a}_{ik}^{\left( k - 1\right) }}{{l}_{kk}}\;\left( {i = k, k + 1,\cdots , n}\right) ; \tag{19.36b}
$$

$$
{a}_{ij}^{\left( k\right) } = {a}_{ij}^{\left( k - 1\right) } - {l}_{ik}{l}_{jk}\;\left( {i, j = k + 1, k + 2,\cdots , n}\right) . \tag{19.36c}
$$

相应的线性方程组 $\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}}$ 的解可用楚列斯基 (Cholesky) 方法通过下列步骤确定:

(1) $\mathbf{A} = \mathbf{L}{\mathbf{L}}^{\mathrm{T}}$ : 确定所谓的楚列斯基分解并作代换 ${\mathbf{L}}^{\mathrm{T}}\underline{\mathbf{x}} = \underline{\mathbf{c}}$ .

(2) $\mathbf{L}\underline{\mathbf{c}} = \underline{\mathbf{b}}$ : 通过向前代换确定辅助变量 $\underline{\mathbf{c}}$ .

(3) ${\mathbf{L}}^{\mathrm{T}}\mathbf{x} = \mathbf{c}$ : 通过向后代换确定解向量 $\mathbf{x}$ .

当 $n$ 较大时,楚列斯基方法的计算量大约是 $\mathbf{{LU}}$ 分解方法 (参见第 1243 页 (19.31)) 的一半.

##### 19.2.1.3 正交化方法

## 1. 线性拟合问题

设超定方程组

$$
\mathop{\sum }\limits_{{k = 1}}^{n}{a}_{ik}{x}_{k} = {b}_{i}\;\left( {i = 1,2,\cdots , m;m > n}\right)  \tag{19.37}
$$

的矩阵形式为

$$
\mathbf{A}\mathbf{x} = \mathbf{b}. \tag{19.38}
$$

若系数矩阵 $\mathbf{A} = \left( {a}_{ik}\right)$ 为 $\left( {m \times  n}\right)$ ,满秩为 $n$ ,即列是线性无关的. 由于超定方程组通常无解, 考虑所谓的误差方程组代替 (19.37):

$$
{r}_{i} = \mathop{\sum }\limits_{{k = 1}}^{n}{a}_{ik}{x}_{k} - {b}_{i}\;\left( {i = 1,2,\cdots , m;m > n}\right) , \tag{19.39}
$$

这里 ${r}_{i}$ 为残量,使其平方和最小:

$$
\mathop{\sum }\limits_{{i = 1}}^{m}{r}_{i}^{2} = \mathop{\sum }\limits_{{i = 1}}^{m}{\left\lbrack  \mathop{\sum }\limits_{{k = 1}}^{n}{a}_{ik}{x}_{k} - {b}_{i}\right\rbrack  }^{2} = F\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = \min !. \tag{19.40}
$$

(19.40) 称为线性拟合问题或线性最小二乘问题 (参见第 611 页 6.2.5.5). 使得残量平方和 $F\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)$ 最小的必要条件为

$$
\frac{\partial F}{\partial {x}_{k}} = 0\;\left( {k = 1,2,\cdots , n}\right) . \tag{19.41}
$$

于是得到线性方程组

$$
{\mathbf{A}}^{\mathrm{T}}\mathbf{A}\underline{\mathbf{x}} = {\mathbf{A}}^{\mathrm{T}}\underline{\mathbf{b}}. \tag{19.42}
$$

因为方程组 (19.42) 是由 (19.38) 应用高斯最小二乘法得到的 (参见第 611 页 6.2.5.5),所以从 (19.38) 到 (19.42) 的变换称为高斯变换. 因为 $\mathbf{A}$ 是满秩的, ${\mathbf{A}}^{\mathrm{T}}\mathbf{A}$ 为正定的 $\left( {n \times  n}\right)$ 矩阵,所以正规方程 (19.42) 可以由楚列斯基方法数值求解 (参见第 1245 页 19.2.1.2).

若矩阵 ${\mathbf{A}}^{\mathrm{T}}\mathbf{A}$ 的条件数 (见 [19.31]) 过大,数值求解正规方程 (19.42) 有困难, 则其解的相对误差也大. 因此最好用正交化方法数值求解线性拟合问题.

## 2. 正交化方法

下面是解线性最小二乘问题 (19.40) 的正交化方法基础.

(1) 在正交变换的过程中不改变向量的长度,即向量 $\underline{x}$ 和 $\underline{\widetilde{x}} = {Q}_{0}\underline{x}$ 有相同的长度, 其中

$$
{\mathbf{Q}}_{0}^{\mathrm{T}}{\mathbf{Q}}_{0} = \mathbf{E}. \tag{19.43}
$$

(2) 对于有最大秩 $n\left( {n < m}\right)$ 的任意(m, n)矩阵 $\mathbf{A}$ ,存在(m, m)正交矩阵 $\mathbf{Q}$ , 使得

$$
\mathbf{A} = \mathbf{Q}\widehat{\mathbf{R}} \tag{19.44}
$$

$$
{\mathbf{Q}}^{\mathrm{T}}\mathbf{Q} = \mathbf{E},\;\widehat{\mathbf{R}} = \left( \begin{array}{l} \mathbf{R} \\  \mathbf{O} \end{array}\right)  = \left( \begin{matrix} {r}_{11} & {r}_{12} & \cdots & {r}_{1n} \\   & {r}_{22} & \cdots & {r}_{2n} \\   & &  \ddots  & \vdots \\   & & & {r}_{nn} \\   & \cdots & \cdots & \cdots \cdots \cdots \\   & & & \mathbf{O} \end{matrix}\right) . \tag{19.45}
$$

这里 $\mathbf{R}$ 为(n, n)上三角矩阵,矩阵 $\mathbf{O}$ 为(m - n, n)零矩阵.

矩阵 $\mathbf{A}$ 的乘积形式 (19.44) 称为矩阵 $\mathbf{A}$ 的 $\mathbf{{QR}}$ 分解. 因此误差方程 (19.39) 可以转化为等价的方程组

$$
{r}_{11}{x}_{1} + {r}_{12}{x}_{2} + \cdots  + {r}_{1n}{x}_{n} - {\widehat{b}}_{1} = {\widehat{r}}_{1},
$$

$$
{r}_{22}{x}_{2} + \cdots  + {r}_{2n}{x}_{n} - {\widehat{b}}_{2} = {\widehat{r}}_{2},
$$

$$
\because \;\vdots \;\vdots \; = \;\vdots
$$

$$
{r}_{nn}{x}_{n} - {\widehat{b}}_{n} = {\widehat{r}}_{n}, \tag{19.46}
$$

$$
- {\widehat{b}}_{n + 1} = {\widehat{r}}_{n + 1},
$$

$$
\vdots
$$

$$
- {\widehat{b}}_{m} = {\widehat{r}}_{m}.
$$

而残量的平方和不变. 由 (19.46) 知,当 ${\widehat{r}}_{1} = {\widehat{r}}_{2} = \cdots  = {\widehat{r}}_{n} = 0$ 时平方和最小,而且最小值等于 ${\widehat{r}}_{n + 1}$ 到 ${\widehat{r}}_{m}$ 的平方和. 要求的解 $\mathbf{x}$ 则可由向后替换得到

$$
\mathbf{R}\underline{\mathbf{x}} = {\underline{\widehat{\mathbf{b}}}}_{0} \tag{19.47}
$$

其中向量 ${\widehat{\underline{b}}}_{0}$ 由 (19.46) 的元素 ${\widehat{b}}_{1},{\widehat{b}}_{2},\cdots ,{\widehat{b}}_{n}$ 组成.

由 (19.39) 转化为 (19.46) 有两种常用的方法:

(1) 吉文斯 (Givens) 变换.

## (2)豪斯霍尔德变换.

矩阵 $\mathbf{A}$ 的 $\mathbf{{QR}}$ 分解的第一步由旋转得到,其余则由反射得到. 数值程序可见[19.29].

线性最小二乘逼近的实际问题多数用豪斯霍尔德变换求解, 通常会用到系数矩阵 $\mathbf{A}$ 的特殊带状结构.

##### 19.2.1.4 迭代方法

## 1. 雅可比方法

设线性方程组 (19.25) 的系数矩阵的每个主元 ${a}_{ii}\left( {i = 1,2,\cdots , n}\right)$ 都是非零元素. 于是第 $i$ 行的未知量 ${x}_{i}$ 可以由下面的迭代法则得到,其中 $\mu$ 为迭代指标

$$
{x}_{i}^{\left( \mu  + 1\right) } = \frac{{b}_{i}}{{a}_{ii}} - \mathop{\sum }\limits_{\substack{{k = 1} \\  \left( {k \neq  i}\right)  }}^{n}\frac{{a}_{ik}}{{a}_{ii}}\;\left( {i = 1,2,\cdots , n}\right)
$$

$$
\left( {\mu  = 0,1,2,\cdots ;{x}_{1}^{\left( 0\right) },{x}_{2}^{\left( 0\right) },\cdots ,{x}_{n}^{\left( 0\right) }\text{为给定初值}}\right) \text{.} \tag{19.48}
$$

公式 (19.48) 称为雅可比方法. 新向量 ${x}^{\left( \mu  + 1\right) }$ 的各个分量由 ${x}^{\left( \mu \right) }$ 的分量计算得到. 若至少满足下面的一个条件

$$
\mathop{\max }\limits_{k}\mathop{\sum }\limits_{\substack{{i = 1} \\  \left( {i \neq  k}\right)  }}^{n}\left| \frac{{a}_{ik}}{{a}_{ii}}\right|  < 1 \tag{19.49}
$$

或

$$
\mathop{\max }\limits_{i}\mathop{\sum }\limits_{\substack{{k = 1} \\  \left( {k \neq  i}\right)  }}^{n}\left| \frac{{a}_{ik}}{{a}_{ii}}\right|  < 1 \tag{19.50}
$$

则雅可比迭代对于任意初始向量 ${\mathbf{x}}^{\left( 0\right) }$ 收敛.

## 2. 高斯-塞德尔迭代

若第一分量 ${x}_{1}^{\left( \mu  + 1\right) }$ 由雅可比方法计算得到,则该值可以用于计算 ${x}_{2}^{\left( \mu  + 1\right) }$ . 可用类似的方法计算后面的分量, 于是得如下迭代公式

$$
{x}_{i}^{\left( \mu  + 1\right) } = \frac{{b}_{i}}{{a}_{ii}} - \mathop{\sum }\limits_{\substack{{k = 1} \\  \left( {k \neq  i}\right)  }}^{n}\frac{{a}_{ik}}{{a}_{ii}}{x}_{k}^{\left( \mu  + 1\right) } - \mathop{\sum }\limits_{{k = i + 1}}^{n}\frac{{a}_{ik}}{{a}_{ii}}{x}_{k}^{\left( \mu \right) }\;\left( {i = 1,2,\cdots , n}\right)
$$

$$
\left( {\mu  = 0,1,2,\cdots ;{x}_{1}^{\left( 0\right) },{x}_{2}^{\left( 0\right) },\cdots ,{x}_{n}^{\left( 0\right) }\text{为给定初值}}\right) \text{.} \tag{19.51}
$$

公式 (19.51) 称为高斯-塞德尔 (Gauss-Seidel) 方法. 高斯-塞德尔方法通常比雅可比方法收敛得快, 但其收敛判据更复杂.

$$
{10}{x}_{1} - 3{x}_{2} - 4{x}_{3} + 2{x}_{4} = {14},
$$

$$
- 3{x}_{1} + {26}{x}_{2} + 5{x}_{3} - \;{x}_{4} = {22},
$$

$$
- 4{x}_{1} + 5{x}_{2} + {16}{x}_{3} + 5{x}_{4} = {17},
$$

$$
2{x}_{1} + 3{x}_{2} - 4{x}_{3} - {12}{x}_{4} =  - {20}.
$$

根据 (19.51) 相应的迭代公式为

$$
{x}_{1}^{\left( \mu  + 1\right) } = \frac{1}{10}\left( {{14} + 3{x}_{2}^{\left( \mu \right) } + 4{x}_{3}^{\left( \mu \right) } - 2{x}_{4}^{\left( \mu \right) }}\right) ,
$$

$$
{x}_{2}^{\left( \mu  + 1\right) } = \frac{1}{26}\left( {{22} + 3{x}_{1}^{\left( \mu  + 1\right) } - 5{x}_{3}^{\left( \mu \right) } + {x}_{4}^{\left( \mu \right) }}\right) ,
$$

$$
{x}_{3}^{\left( \mu  + 1\right) } = \frac{1}{16}\left( {{17} + 4{x}_{1}^{\left( \mu  + 1\right) } - 5{x}_{2}^{\left( \mu  + 1\right) } - 5{x}_{4}^{\left( \mu \right) }}\right) ,
$$

$$
{x}_{4}^{\left( \mu  + 1\right) } = \frac{1}{12}\left( {-{20} + 2{x}_{1}^{\left( \mu  + 1\right) } + 3{x}_{2}^{\left( \mu  + 1\right) } - 4{x}_{3}^{\left( \mu  + 1\right) }}\right) .
$$

<table><tr><td>${x}^{\left( 0\right) }$</td><td>${x}^{\left( 1\right) }$</td><td>${x}^{\left( 4\right) }$</td><td>${x}^{\left( 5\right) }$</td><td>$x$</td></tr><tr><td>0</td><td>1.4</td><td>1.5053</td><td>1.5012</td><td>1.5</td></tr><tr><td>0</td><td>1.0077</td><td>0.9946</td><td>0.9989</td><td>1</td></tr><tr><td>0</td><td>1.0976</td><td>0.5059</td><td>0.5014</td><td>0.5</td></tr><tr><td>0</td><td>1.7861</td><td>1.9976</td><td>1.9995</td><td>2</td></tr></table>

## 3. 松弛法

高斯-塞德尔方法 (19.51) 的迭代公式可以写成修正形式

$$
{x}_{i}^{\left( \mu  + 1\right) } = {x}_{i}^{\left( \mu \right) } + \left( {\frac{{b}_{i}}{{a}_{ii}} - \mathop{\sum }\limits_{{k = 1}}^{{i - 1}}\frac{{a}_{ik}}{{a}_{ii}}{x}_{k}^{\left( \mu  + 1\right) } - \mathop{\sum }\limits_{{k = i}}^{n}\frac{{a}_{ik}}{{a}_{ii}}{x}_{k}^{\left( \mu \right) }}\right) ,
$$

即

$$
{x}_{i}^{\left( \mu  + 1\right) } = {x}_{i}^{\left( \mu \right) } + {d}_{i}^{\left( \mu \right) }\;\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.52}
$$

选取适当的松弛参数 $\omega$ ,将 (19.52) 重新写成如下形式:

$$
{x}_{i}^{\left( \mu  + 1\right) } = {x}_{i}^{\left( \mu \right) } + \omega {d}_{i}^{\left( \mu \right) }\;\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right)  \tag{19.53}
$$

以提高收敛速度. 可以证明, 仅当

$$
0 < \omega  < 2 \tag{19.54}
$$

时该方法收敛. 当 $\omega  = 1$ 时,退回高斯-塞德尔迭代. 当 $\omega  > 1$ 时,称为超松弛,此时相应的迭代法称为 SOR (逐次超松弛) 方法. 对某些特殊类型的矩阵可确定最优松弛因子.

迭代法用来求解系数矩阵的主对角线元素 ${a}_{ii}$ 按绝对值比该列或行的其他元素大得多的线性方程组, 或者通过某种方式重排方程组的行可得到这种形式的方程组.

#### 19.2.2 非线性方程组

若含有 $n$ 个未知量 ${x}_{1},{x}_{2},\cdots ,{x}_{n}$ 的 $n$ 个方程的非线性方程组

$$
{F}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = 0\;\left( {i = 1,2,\cdots , n}\right)  \tag{19.55}
$$

有解, 通常数值解仅可由迭代法得到.

##### 19.2.2.1 一般迭代法

若方程 (19.55) 可以转化为不动点形式

$$
{x}_{i} = {f}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right) \;\left( {i = 1,2,\cdots , n}\right) , \tag{19.56}
$$

则可用一般迭代法. 从估计的近似值 ${x}_{1}^{\left( 0\right) },{x}_{2}^{\left( 0\right) },\cdots ,{x}_{n}^{\left( 0\right) }$ 出发,通过下面的方法得到改进值.

1. 同步迭代

$$
{x}_{i}^{\left( \mu  + 1\right) } = {f}_{i}\left( {{x}_{1}^{\left( \mu \right) },{x}_{2}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) \;\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.57}
$$

2. 顺序迭代

$$
{x}_{i}^{\left( \mu  + 1\right) } = {f}_{i}\left( {{x}_{1}^{\left( \mu  + 1\right) },\cdots ,{x}_{i - 1}^{\left( \mu  + 1\right) },{x}_{i}^{\left( \mu \right) },{x}_{i + 1}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right)
$$

$$
\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.58}
$$

对该方法收敛性特别重要的是,在解的邻域函数 ${f}_{i}$ 应该较弱地依赖于未知量, 即如果函数 ${f}_{i}$ 可微,其偏导数的绝对值必须相当小. 我们得到收敛性条件

$$
K < 1
$$

其中

$$
K = \mathop{\max }\limits_{i}\left( {\mathop{\sum }\limits_{{k = 1}}^{n}\max \left| \frac{\partial {f}_{i}}{\partial {x}_{k}}\right| }\right) . \tag{19.59}
$$

带有量 $K$ 的误差估计如下:

$$
\mathop{\max }\limits_{i}\left| {{x}_{i}^{\left( \mu  + 1\right) } - {x}_{i}}\right|  \leq  \frac{K}{1 - K}\mathop{\max }\limits_{i}\left| {{x}_{i}^{\left( \mu  + 1\right) } - {x}_{i}^{\left( \mu \right) }}\right| , \tag{19.60}
$$

这里 ${x}_{i}$ 为要求的解的分量, ${x}_{i}^{\left( \mu \right) }$ 与 ${x}_{i}^{\left( \mu  + 1\right) }$ 为相应的第 $\mu$ 次和第 $\mu  + 1$ 次近似值.

##### 19.2.2.2 牛顿法

牛顿法可以用来求解形如 (19.55) 的问题. 在得到初始近似值 ${x}_{1}^{\left( 0\right) },{x}_{2}^{\left( 0\right) },\cdots ,{x}_{n}^{\left( 0\right) }$ 后, ${F}_{i}$ 作为 $n$ 个独立变量 ${x}_{1},{x}_{2},\cdots ,{x}_{n}$ 的函数按泰勒公式展开 (参见第 630 页 7.3.3.3,1.). 在线性项后终止展开, 由 (19.55) 可得线性方程组, 其迭代改进则通过如下公式得到

$$
{F}_{i}\left( {{x}_{1}^{\left( \mu \right) },{x}_{2}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right)  + \mathop{\sum }\limits_{{k = 1}}^{n}\frac{\partial {F}_{i}}{\partial {x}_{k}}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) \left( {{x}_{k}^{\left( \mu  + 1\right) } - {x}_{k}^{\left( \mu \right) }}\right)  = 0
$$

$$
\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.61}
$$

要在每一步迭代中求解的线性方程组 (19.61) 的系数矩阵为

$$
{\mathbf{F}}^{\prime }\left( {\mathbf{x}}^{\left( \mu \right) }\right)  = \left( {\frac{\partial {F}_{i}}{\partial {x}_{k}}\left( {{x}_{1}^{\left( \mu \right) },{x}_{2}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) }\right) \;\left( {i, k = 1,2,\cdots , n}\right) , \tag{19.62}
$$

称之为雅可比矩阵. 若雅可比矩阵在解的邻域内是可逆的, 牛顿法是局部平方收敛的,即收敛基本上依赖于是否适当选取了初始近似值. 若在 (19.61) 中代入 ${x}_{k}^{\left( \mu  + 1\right) } -$ ${x}_{k}^{\left( \mu \right) } = {d}_{k}^{\left( \mu \right) }$ ,则牛顿法可写成校正形式

$$
{x}_{k}^{\left( \mu  + 1\right) } = {x}_{k}^{\left( \mu \right) } + {d}_{k}^{\left( \mu \right) }\;\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.63}
$$

为降低对初值的依赖性,与松弛法类似,引入所谓阻尼或步长参数 $\gamma$ (阻尼法):

$$
{x}_{k}^{\left( \mu  + 1\right) } = {x}_{k}^{\left( \mu \right) } + \gamma {d}_{k}^{\left( \mu \right) }\;\left( {i = 1,2,\cdots , n;\mu  = 0,1,2,\cdots ;\gamma  > 0}\right) . \tag{19.64}
$$

确定参数 $\gamma$ 的方法见 [19.31].

##### 19.2.2.3 无导数高斯-牛顿法

为求解最小二乘问题 (19.24), 对非线性问题可以进行如下迭代:

(1) 从适当的初值 ${x}_{1}^{\left( 0\right) },{x}_{2}^{\left( 0\right) },\cdots ,{x}_{n}^{\left( 0\right) }$ 出发,对于非线性函数 ${F}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)$ $\left( {i = 1,2,\cdots , m;m > n}\right)$ 由牛顿法 (19.61) 的线性函数 ${\widetilde{F}}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)$ 近似,得到迭代步骤如下:

$$
{\widetilde{F}}_{i}\left( {{x}_{1},\cdots ,{x}_{n}}\right)  = {F}_{i}\left( {{x}_{1}^{\left( \mu \right) },{x}_{2}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right)  + \mathop{\sum }\limits_{{k = 1}}^{n}\frac{\partial {F}_{i}}{\partial {x}_{k}}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) \left( {{x}_{k} - {x}_{k}^{\left( \mu \right) }}\right)
$$

$$
\left( {i = 1,2,\cdots , m;\mu  = 0,1,2,\cdots }\right) \text{.}
$$

(19.65)

(2) 在 (19.65) 中代入 ${d}_{k}^{\left( \mu \right) } = {x}_{k} - {x}_{k}^{\left( \mu \right) }$ ,校正项 ${d}_{k}^{\left( \mu \right) }$ 由高斯最小二乘法,即求解线性最小二乘问题确定

$$
\mathop{\sum }\limits_{{i = 1}}^{m}{\widetilde{F}}_{i}^{2}\left( {{x}_{1},\cdots ,{x}_{n}}\right)  = \min , \tag{19.66}
$$

例如借助正则方程 (见 (19.42)), 或豪斯霍尔德方法 (参见第 1280 页 19.6.2.2).

(3)所求解的近似值由以下公式给出:

$$
{x}_{k}^{\left( \mu  + 1\right) } = {x}_{k}^{\left( \mu \right) } + {d}_{k}^{\left( \mu \right) } \tag{19.67a}
$$

或

$$
{x}_{k}^{\left( \mu  + 1\right) } = {x}_{k}^{\left( \mu \right) } + \gamma {d}_{k}^{\left( \mu \right) }\;\left( {k = 1,2,\cdots , n}\right) , \tag{19.67b}
$$

其中 $\gamma \left( {\gamma  > 0}\right)$ 类似于牛顿法为步长参数.

重复步骤 (2) 与步骤 (3),用 ${x}_{k}^{\left( \mu  + 1\right) }$ 代替 ${x}_{k}^{\left( \mu \right) }$ 得到高斯-牛顿法. 于是得到近似值序列,其收敛性依赖于初值的准确性. 误差的平方和可以通过引入参数 $\gamma$ 而降低.

如果偏导数 $\frac{\partial {F}_{i}}{\partial {x}_{k}}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) \left( {i = 1,2,\cdots , m;k = 1,2,\cdots , n}\right)$ 的计算量过大, 偏导数可由以下差分近似得到

$$
\frac{\partial {F}_{i}}{\partial {x}_{k}}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{k}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right)
$$

$$
\approx  \frac{1}{{h}_{k}^{\left( \mu \right) }}\left\lbrack  {{F}_{i}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{k - 1}^{\left( \mu \right) },{x}_{k}^{\left( \mu \right) } + {h}_{k}^{\left( \mu \right) },{x}_{k + 1}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) }\right.
$$

$$
\left. {-{F}_{i}\left( {{x}_{1}^{\left( \mu \right) },\cdots ,{x}_{k}^{\left( \mu \right) },\cdots ,{x}_{n}^{\left( \mu \right) }}\right) }\right\rbrack
$$

$$
\left( {i = 1,2,\cdots , m;k = 1,2,\cdots , n;\mu  = 0,1,2,\cdots }\right) . \tag{19.68}
$$

所谓离散步长 ${h}_{k}^{\left( \mu \right) }$ 可能依赖于迭代步数和变量值.

若用 (19.68) 近似,则高斯-牛顿法仅需计算函数值 ${F}_{i}$ ,即该方法是与导数无关的.

### 19.3 数值积分

#### 19.3.1 一般求积公式

若被积函数 $f\left( x\right)$ 不能被初等微积分求积,或计算太复杂,或函数仅在区间 $\left\lbrack  {a, b}\right\rbrack$ 上有限个节点 ${x}_{v}$ 已知,定积分

$$
I\left( f\right)  = {\int }_{a}^{b}f\left( x\right) \mathrm{d}x \tag{19.69}
$$

的数值计算必定是近似的. 所谓求积公式是用来近似计算 (19.69) 的. 有如下一般形式

$$
Q\left( f\right)  = \mathop{\sum }\limits_{{\nu  = 0}}^{n}{c}_{0\nu }{y}_{\nu } + \mathop{\sum }\limits_{{\nu  = 0}}^{n}{c}_{1\nu }{y}_{\nu }^{\left( 1\right) } + \cdots  + \mathop{\sum }\limits_{{\nu  = 0}}^{n}{c}_{p\nu }{y}_{\nu }^{\left( p\right) }, \tag{19.70}
$$

其中 ${y}_{v}^{\left( \mu \right) } = {f}^{\left( \mu \right) }\left( {x}_{v}\right) \left( {\mu  = 1,2,\cdots , p;v = 1,2,\cdots , n}\right) ,{y}_{v} = f\left( {x}_{v}\right) ,{c}_{\mu v}$ 为常数值. 显然

$$
I\left( f\right)  = Q\left( f\right)  + R, \tag{19.71}
$$

其中 $R$ 为求积公式的误差. 使用求积公式时假设所需的被积函数 $f\left( x\right)$ 节点值及其导数值都是已知的. 仅用到节点值的公式称为均值公式, 用到导数值的公式称为埃尔米特求积公式.

#### 19.3.2 插值求积

如下公式称为插值求积. 这里被积函数 $f\left( x\right)$ 在某些 (尽可能少的) 插值点被相应阶的多项式 $p\left( x\right)$ 插值,函数 $f\left( x\right)$ 由多项式 $p\left( x\right)$ 代替. 在整个区间上的积分由和式给出. 这里给出的公式可用于大多数实际情况. 插值节点是等距的:

$$
{x}_{\nu } = {x}_{0} + {\nu h}\left( {\nu  = 0,1,2,\cdots , n}\right) ,\;{x}_{0} = a,\;{x}_{n} = b,\;h = \frac{b - a}{n}. \tag{19.72}
$$

对每个求积公式给出误差 $\left| R\right|$ 的上界. 这里 ${M}_{\mu }$ 表示 $\left| {{f}^{\left( \mu \right) }\left( x\right) }\right|$ 在整个区域的上界.

##### 19.3.2.1 矩形公式

在区间 $\left\lbrack  {{x}_{0},{x}_{0} + h}\right\rbrack$ 上,被积函数 $f\left( x\right)$ 由常数函数 $y = {y}_{0} = f\left( {x}_{0}\right)$ 代替,其被积函数在插值点 ${x}_{0}$ 上,称为左端矩形积分. 于是得到简单矩形公式

$$
{\int }_{{x}_{0}}^{{x}_{0} + h}f\left( x\right) \mathrm{d}x \approx  h \cdot  {y}_{0},\;\left| R\right|  \leq  \frac{{h}^{2}}{2}{M}_{1}. \tag{19.73a}
$$

复化左端矩形公式为

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  h\left( {{y}_{0} + {y}_{1} + {y}_{2} + \cdots  + {y}_{n - 1}}\right) ,\;\left| R\right|  \leq  \frac{\left( {b - a}\right) h}{2}{M}_{1}. \tag{19.73b}
$$

${M}_{1}$ 表示 $\left| {{f}^{\prime }\left( x\right) }\right|$ 在整个插值区域的上界.

类似地,可以得到右端矩形公式,在 (19.73a) 中用 ${y}_{1}$ 代替 ${y}_{0}$ . 有

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  h\left( {{y}_{1} + {y}_{2} + \cdots  + {y}_{n}}\right) ,\;\left| R\right|  \leq  \frac{\left( {b - a}\right) h}{2}{M}_{1}. \tag{19.74}
$$

##### 19.3.2.2 梯形公式

在区间 $\left\lbrack  {{x}_{0},{x}_{0} + h}\right\rbrack$ 上,被积函数 $f\left( x\right)$ 由线性函数代替,其插值点为 ${x}_{0}$ 与 ${x}_{1} = {x}_{0} + h$ . 于是得到梯形公式

$$
{\int }_{{x}_{0}}^{{x}_{0} + h}f\left( x\right) \mathrm{d}x \approx  \frac{h}{2}\left( {{y}_{0} + {y}_{1}}\right) ,\;\left| R\right|  \leq  \frac{{h}^{3}}{12}{M}_{2}. \tag{19.75}
$$

所谓复化梯形公式为

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  h\left( {\frac{{y}_{0}}{2} + {y}_{1} + {y}_{2} + \cdots  + {y}_{n - 1} + \frac{{y}_{n}}{2}}\right) ,\;\left| R\right|  \leq  \frac{\left( {b - a}\right) {h}^{2}}{12}{M}_{2}.
$$

(19.76)

${M}_{2}$ 表示 $\left| {{f}^{\prime \prime }\left( x\right) }\right|$ 在整个插值区域的上界. 梯形公式的误差为 ${h}^{2}$ ,即梯形公式的误差阶为 2. 若不考虑舍入误差,当 $h \rightarrow  0\left( {n \rightarrow  \infty }\right)$ 时,梯形公式收敛到定积分.

##### 19.3.2.3 辛普森公式

在区间 $\left\lbrack  {{x}_{0},{x}_{0} + {2h}}\right\rbrack$ 上,被积函数 $f\left( x\right)$ 由二次多项式代替,其插值点为 ${x}_{0}$ , ${x}_{1} = {x}_{0} + h$ 及 ${x}_{2} = {x}_{0} + {2h}$ :

$$
{\int }_{{x}_{0}}^{{x}_{0} + {2h}}f\left( x\right) \mathrm{d}x \approx  \frac{h}{3}\left( {{y}_{0} + 4{y}_{1} + {y}_{2}}\right) ,\;\left| R\right|  \leq  \frac{{h}^{5}}{90}{M}_{4}. \tag{19.77}
$$

对复化辛普森公式 $n$ 必须为偶数. 其近似为

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  \frac{h}{3}\left( {{y}_{0} + 4{y}_{1} + 2{y}_{2} + 4{y}_{3} + \cdots  + 2{y}_{n - 2} + 4{y}_{n - 1} + {y}_{n}}\right) ,({19} \tag{19.78}
$$

$$
\left| R\right|  \leq  \frac{\left( {b - a}\right) {h}^{4}}{180}{M}_{4}.
$$

${M}_{4}$ 为 $\left| {{f}^{\left( 4\right) }\left( x\right) }\right|$ 在整个插值区域的上界. 辛普森公式的误差阶为 4,它对三次多项

式准确成立.

##### 19.3.2.4 埃尔米特梯形公式

在区间 $\left\lbrack  {{x}_{0},{x}_{0} + h}\right\rbrack$ 上,被积函数 $f\left( x\right)$ 由三次多项式代替,在节点 ${x}_{0}$ 与 ${x}_{1} =$ ${x}_{0} + h$ 处插值函数 $f\left( x\right)$ 与导数 ${f}^{\prime }\left( x\right)$ :

$$
{\int }_{{x}_{0}}^{{x}_{0} + h}f\left( x\right) \mathrm{d}x \approx  \frac{h}{2}\left( {{y}_{0} + {y}_{1}}\right)  + \frac{{h}^{2}}{12}\left( {{y}_{0}^{\prime } - {y}_{1}^{\prime }}\right) ,\;\left| R\right|  \leq  \frac{{h}^{5}}{720}{M}_{4}. \tag{19.79}
$$

埃尔米特梯形公式通过求和得到

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  h\left( {\frac{{y}_{0}}{2} + {y}_{1} + {y}_{2} + \cdots  + {y}_{n - 1} + \frac{{y}_{n}}{2}}\right)  + \frac{{h}^{2}}{12}\left( {{y}_{0}^{\prime } - {y}_{n}^{\prime }}\right) ,
$$

$$
\left| R\right|  \leq  \frac{\left( {b - a}\right) {h}^{4}}{720}{M}_{4} \tag{19.80}
$$

${M}_{4}$ 表示 $\left| {{f}^{\left( 4\right) }\left( x\right) }\right|$ 在整个插值区域的上界. 埃尔米特梯形公式的误差阶为 4,它对三次多项式准确成立.

#### 19.3.3 高斯求积公式

高斯求积公式的一般形式为

$$
{\int }_{a}^{b}f\left( x\right) \mathrm{d}x \approx  \mathop{\sum }\limits_{{v = 0}}^{n}{c}_{v}{y}_{v},\;\text{ 其中 }{y}_{v} = f\left( {x}_{v}\right) , \tag{19.81}
$$

这里不仅系数 ${c}_{v}$ 是参数,而且插值节点 ${x}_{v}$ 也是参数. 确定这些参数使得公式 (19.81) 对于尽可能高次的多项式准确成立.

高斯求积公式导致高精度近似, 但插值节点必须以特别的方式选取.

##### 19.3.3.1 高斯求积分式

若 (19.81) 的积分区间为 $\left\lbrack  {a, b}\right\rbrack   = \left\lbrack  {-1,1}\right\rbrack$ ,插值节点选为勒让德多项式的根 (参见第 748 页 9.1.2.6,3. 以及 1430 页 21.12),则系数 ${c}_{v}$ 可由使得 (19.81) 对直到 ${2n} + 1$ 阶多项式都能准确来确定. 勒让德多项式的根是关于原点对称的. 对于 $n = 1,2,3$ 的情况,有

$$
n = 1 : \;{x}_{0} =  - {x}_{1},
$$

$$
{x}_{1} = \frac{1}{\sqrt{3}} = {0.577350269}\cdots ,
$$

$$
n = 2 : \;{x}_{0} =  - {x}_{2},
$$

$$
{x}_{1} = 0,\;{c}_{1} = \frac{8}{9}, \tag{19.82}
$$

$$
{x}_{2} = \sqrt{\frac{3}{5}} = {0.774596669}\cdots ,\;{c}_{2} = {c}_{0}.
$$

$$
n = 3 : \;{x}_{0} =  - {x}_{3},
$$

$$
{c}_{0} = {0.347854854}\cdots ,
$$

$$
{x}_{1} =  - {x}_{2},\;{c}_{1} = {0.652145154}\cdots ,
$$

$$
{x}_{2} = {0.339981043}\cdots ,
$$

$$
{c}_{2} = {c}_{1},
$$

$$
{x}_{3} = {0.861136311}\cdots ,
$$

$$
{c}_{3} = {c}_{0}\text{.}
$$

注 对于一般的积分区间 $\left\lbrack  {a, b}\right\rbrack$ 可以通过变换 $t = \frac{b - a}{2}x + \frac{b + a}{2}(t \in  \left\lbrack  {a, b}\right\rbrack$ ,$x \in  \left\lbrack  {-1,1\rbrack )\text{变为}\left\lbrack  {-1,1}\right\rbrack  \text{. 于是}}\right\rbrack$

$$
{\int }_{a}^{b}f\left( t\right) \mathrm{d}t \approx  \frac{b - a}{2}\mathop{\sum }\limits_{{\nu  = 0}}^{n}{c}_{\nu }f\left( {\frac{b - a}{2}{x}_{\nu } + \frac{a + b}{2}}\right) , \tag{19.83}
$$

这里 ${x}_{\nu }$ 与 ${c}_{\nu }$ 的值由前面关于区间 $\left\lbrack  {-1,1}\right\rbrack$ 的公式给出.

##### 19.3.3.2 洛巴托 (Lobatto) 求积公式

在某些情况下, 选取子区间的端点作为插值节点也是合理的. 此时在 (19.81) 中有多于 ${2n}$ 个的自由参数. 这些值由使得对直到 ${2n} - 1$ 阶多项式都能准确求积来确定. 对于 $n = 2$ 与 $n = 3$ 的情况,有

$$
n = 2\text{:}
$$

$$
{x}_{0} =  - 1,\;{c}_{0} = \frac{1}{3},
$$

$$
{x}_{1} = 0,\;{c}_{1} = \frac{4}{3}, \tag{19.84a}
$$

$$
{x}_{2} = 1,\;{c}_{2} = {c}_{0}.
$$

$$
n = 3\text{:}
$$

$$
{x}_{0} =  - 1
$$

$$
{c}_{0} = \frac{1}{6}
$$

$$
{x}_{1} =  - {x}_{2},
$$

$$
{c}_{1} = \frac{5}{6} \tag{19.84b}
$$

$$
{x}_{2} = \frac{1}{\sqrt{5}} = {0.447213595}\cdots ,
$$

$$
{x}_{3} = 1
$$

$$
{c}_{3} = {c}_{0}.
$$

$n = 2$ 的情况表示辛普森公式.

#### 19.3.4 龙贝格方法

为提高数值积分的精度, 推荐从梯形求和序列出发, 重复对分积分步长的龙贝格 (Romberg) 方法.

##### 19.3.4.1 龙贝格方法的算法

该方法包含以下步骤.

## 1. 确定梯形和

根据 19.3.2.2 的 (19.76) 确定积分 ${\int }_{a}^{b}f\left( x\right) \mathrm{d}x$ 关于步长

$$
{h}_{i} = \frac{b - a}{{2}^{i}}\;\left( {i = 0,1,2,\cdots , m}\right)  \tag{19.85}
$$

的近似梯形和 $T\left( {h}_{i}\right)$ ,这里考虑递归关系

$$
T\left( {h}_{i}\right)  = T\left( \frac{{h}_{i - 1}}{2}\right)
$$

$$
= \frac{{h}_{i - 1}}{2}\left\lbrack  {\frac{1}{2}f\left( a\right)  + f\left( {a + \frac{{h}_{i - 1}}{2}}\right)  + f\left( {a + {h}_{i - 1}}\right)  + f\left( {a + \frac{3}{2}{h}_{i - 1}}\right) }\right.
$$

$$
\left. {+f\left( {a + 2{h}_{i - 1}}\right)  + \cdots  + f\left( {a + \frac{{2n} - 1}{2}{h}_{i - 1}}\right)  + \frac{1}{2}f\left( b\right) }\right\rbrack
$$

$$
= \frac{1}{2}T\left( {h}_{i - 1}\right)  + \frac{{h}_{i - 1}}{2}\mathop{\sum }\limits_{{j = 0}}^{{n - 1}}f\left( {a + \frac{{h}_{i - 1}}{2} + j{h}_{i - 1}}\right) \;\left( {i = 1,2,\cdots , m;n = {2}^{i - 1}}\right) .
$$

(19.86)

递归公式 (19.86) 告诉我们,由 $T\left( {h}_{i - 1}\right)$ 计算 $T\left( {h}_{i}\right)$ 仅需在新增插值节点计算函数值.

2. 三角格式

令 ${T}_{0i} = T\left( {h}_{i}\right) \left( {i = 0,1,2,\cdots }\right)$ ,进行递归计算

$$
{T}_{ki} = {T}_{k - 1, i} + \frac{{T}_{k - 1, i} - {T}_{k - 1, i - 1}}{{4}^{k} - 1}\;\left( {k = 1,2,\cdots , m;i = k, k + 1,\cdots }\right) . \tag{19.87}
$$

根据 (19.87) 计算得到的数值经常排列成三角格式, 其元素按逐列方式计算:

$$
T\left( {h}_{0}\right)  = {T}_{00}
$$

$$
T\left( {h}_{1}\right)  = {T}_{01}\;{T}_{11}
$$

$$
T\left( {h}_{2}\right)  = {T}_{02}\;{T}_{12}\;{T}_{22} \tag{19.88}
$$

$$
T\left( {h}_{3}\right)  = {T}_{03}\;{T}_{13}\;{T}_{23}\;{T}_{33}
$$

... ...

该格式会一直持续下去 (对于给定的列数), 直到在右边最下面的数值几乎相同. 第二列的值 ${T}_{1i}\left( {i = 1,2,\cdots }\right)$ 相应于由辛普森公式计算得到的值.

##### 19.3.4.2 外推原理

龙贝格方法应用了所谓外推原理. 当 $k = 1$ 时通过推导 (19.86) 证明之. 需要计算的积分表示为 $I$ ,相应的梯形和 (19.76) 表示为 $T\left( h\right)$ . 若 $I$ 的被积函数在积分区间是 ${2m} + 2$ 次连续可微的,则能证明关于 $h$ 的渐进展开对求积公式的误差 $R$ 是成立的, 且有形式

$$
R\left( h\right)  = I - T\left( h\right)  = {a}_{1}{h}^{2} + {a}_{2}{h}^{4} + \cdots  + {a}_{m}{h}^{2m} + O\left( {h}^{{2m} + 2}\right)  \tag{19.89a}
$$

或

$$
T\left( h\right)  = I - {a}_{1}{h}^{2} - {a}_{2}{h}^{4} - \cdots  - {a}_{m}{h}^{2m} + O\left( {h}^{{2m} + 2}\right) , \tag{19.89b}
$$

系数 ${a}_{1},{a}_{2},\cdots ,{a}_{m}$ 为与 $h$ 无关的常数.

根据(19.89b),考虑 $T\left( h\right)$ 与 $T\left( \frac{h}{2}\right)$ 及其线性组合

$$
{T}_{1}\left( h\right)  = {\alpha }_{1}T\left( h\right)  + {\alpha }_{2}T\left( \frac{h}{2}\right)  = \left( {{\alpha }_{1} + {\alpha }_{2}}\right) I - {a}_{1}\left( {{\alpha }_{1} + \frac{{\alpha }_{2}}{4}}\right) {h}^{2}
$$

$$
- {a}_{2}\left( {{\alpha }_{1} + \frac{{\alpha }_{2}}{16}}\right) {h}^{4} - \cdots  \tag{19.90}
$$

若以 ${\alpha }_{1} + {\alpha }_{2} = 1$ 及 ${\alpha }_{1} + \frac{{\alpha }_{2}}{4} = 0$ 代入,则 ${T}_{1}\left( h\right)$ 有 4 阶误差,而 $T\left( h\right)$ 与 $T\left( \frac{h}{2}\right)$ 仅有 2 阶误差. 公式为

$$
{T}_{1}\left( h\right)  =  - \frac{1}{3}T\left( h\right)  + \frac{4}{3}T\left( \frac{h}{2}\right)  = T\left( \frac{h}{2}\right)  + \frac{T\left( \frac{h}{2}\right)  - T\left( h\right) }{3}. \tag{19.91}
$$

这是 $k = 1$ 时的公式 (19.87),根据 (19.87) 重复应用上述过程就得到近似 ${T}_{ik}$ ,且

$$
{T}_{ki} = I + O\left( {h}_{i}^{{2k} + 2}\right) . \tag{19.92}
$$

I 定积分 $I = {\int }_{0}^{1}\frac{\sin x}{x}\mathrm{\;d}x$ (参见第 681 页 8.2.5,1.) 不能用基本方法得到. 计算该积分的近似值 (保留 8 位数字).

## 1. 龙贝格方法

<table><tr><td>$\mathrm{k} = 0$</td><td>$\mathrm{k} = 1$</td><td>$\mathrm{k} = 2$</td><td>$\mathrm{k} = 3$</td></tr><tr><td>0.92073549</td><td/><td/><td/></tr><tr><td>0.93979328</td><td>0.94614588</td><td/><td/></tr><tr><td>0.94451352</td><td>0.94608693</td><td>0.94608300</td><td/></tr><tr><td>0.94569086</td><td>0.94608331</td><td>0.94608307</td><td>0.94608307</td></tr></table>

由龙贝格方法得到近似值 0.94608307. 按 10 位数字得到的是 0.9460830704. 根据(19.92)验证了误差阶为 $O\left( {\left( 1/8\right) }^{8}\right)  \approx  6 \cdot  {10}^{-8}$ .

## 2. 梯形与辛普森公式

根据龙贝格方法的格式,对于 ${h}_{3} = 1/8$ 能直接得到梯形公式的近似值 0.94569086, 而辛普森公式得到的近似值为 0.94608331 .

根据 (19.79) 修正埃尔米特梯形公式得到的结果为

$$
I \approx  {0.94569086} + \frac{0.30116868}{{64} \cdot  {12}} = {0.94608301}.
$$

## 3. 高斯公式

由公式 (19.83) 得

$$
n = 1 : \;I \approx  \frac{1}{2}\left\lbrack  {{c}_{0}f\left( {\frac{1}{2}{x}_{0} + \frac{1}{2}}\right)  + {c}_{1}f\left( {\frac{1}{2}{x}_{1} + \frac{1}{2}}\right) }\right\rbrack
$$

$$
= {0.94604113}
$$

$$
n = 2 : \;I \approx  \frac{1}{2}\left\lbrack  {{c}_{0}f\left( {\frac{1}{2}{x}_{0} + \frac{1}{2}}\right)  + {c}_{1}f\left( {\frac{1}{2}{x}_{1} + \frac{1}{2}}\right)  + {c}_{2}f\left( {\frac{1}{2}{x}_{2} + \frac{1}{2}}\right) }\right\rbrack
$$

$$
= {0.94608313}
$$

$$
n = 3 : \;I \approx  \frac{1}{2}\left\lbrack  {{c}_{0}f\left( {\frac{1}{2}{x}_{0} + \frac{1}{2}}\right)  + \cdots  + {c}_{3}f\left( {\frac{1}{2}{x}_{3} + \frac{1}{2}}\right) }\right\rbrack
$$

$$
= {0.94608307}\text{.}
$$

可见对于 $n = 3$ 的高斯积分公式,仅用四个函数值就可得到 8 位数字的准确值. 而用梯形公式要达到这个精度需要非常多 (大于 1000) 个函数值.

注 (1) 傅里叶分析在周期函数的积分中起重要作用 (参见第 633 页 7.4.1.1,1.). 其数值实现的细节可在调和分析的目录下找到 (参见第 1287 页 19.6.4). 实际计算基于所谓快速傅里叶变换 FFT (参见第 1288 页 19.6.4.2).

(2) 在许多应用中, 考虑积分的特殊性质是有用的. 对这些特殊情况发展了进一步的积分法则. 关于收敛性、误差分析、最优积分公式的大量讨论可见文献 (例如见 $\left\lbrack  {{19},7}\right\rbrack  )$ .

(3) 文献中讨论了求多重积分值的数值方法 (例如见 [19.34]).

### 19.4 常微分方程的近似积分

在许多情况下, 常微分方程的解不能表示成已知基本函数的表达式. 其解在更一般的情况下存在 (参见第 715 页 9.1.1.1), 必须用数值方法确定. 这些结果仅是特殊解法, 但可能达到高精度. 由于高于一阶的微分方程可能是初值问题或边值问题, 故发展了对这两类问题的数值方法.

#### 19.4.1 初值问题

下面讨论求解初值问题的基本方法.

$$
{y}^{\prime } = f\left( {x, y}\right) ,\;y\left( {x}_{0}\right)  = {y}_{0} \tag{19.93}
$$

在选定的插值节点集 ${x}_{i}$ 上求解未知函数 $y\left( x\right)$ 的近似值 ${y}_{i}$ . 通常考虑预先给定步长 $h$ 的等距插值节点

$$
{x}_{i} = {x}_{0} + {ih}\;\left( {i = 0,1,2,\cdots }\right) . \tag{19.94}
$$

##### 19.4.1.1 欧拉多边形法

初值问题 (19.33) 的积分表达式可由下面的积分给出

$$
y\left( x\right)  = {y}_{0} + {\int }_{{x}_{0}}^{x}f\left( {x, y\left( x\right) }\right) \mathrm{d}x. \tag{19.95}
$$

这就是近似的出发点

$$
y\left( {x}_{1}\right)  = {y}_{0} + {\int }_{{x}_{0}}^{{x}_{0} + h}f\left( {x, y\left( x\right) }\right) \mathrm{d}x \approx  {y}_{0} + {hf}\left( {{x}_{0},{y}_{0}}\right)  = {y}_{1}, \tag{19.96}
$$

被推广为欧拉折线法或欧拉多边形法

$$
{y}_{i + 1} = {y}_{i} + {hf}\left( {{x}_{i},{y}_{i}}\right) \;\left( {i = 0,1,2,\cdots ;y\left( {x}_{0}\right)  = {y}_{0}}\right) . \tag{19.97}
$$

几何插值见图 19.5, 对比 (19.96) 与泰勒展开

$$
y\left( {x}_{1}\right)  = y\left( {{x}_{0} + h}\right)  = {y}_{0} + f\left( {{x}_{0},{y}_{0}}\right) h + \frac{{y}^{\prime \prime }\left( \xi \right) }{2}{h}^{2}, \tag{19.98}
$$

其中 ${x}_{0} < \xi  < {x}_{0} + h$ ,表明近似值 ${y}_{1}$ 具有 ${h}^{2}$ 阶误差. 其精度可以通过减小步长 $h$ 来改进. 实际计算表明步长减半可使近似值 ${y}_{i}$ 的误差减半.

用欧拉法可以快速看到解曲线的近似形状.

![01937d01-b6f6-7881-8294-3a9c82211946_27_315_216_1009_571_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_27_315_216_1009_571_0.jpg)

图 19.5

##### 19.4.1.2 龙格-库塔法

## 1. 计算格式

方程 ${y}^{\prime }\left( x\right)  = f\left( {x, y}\right)$ 在每一点 $\left( {{x}_{0},{y}_{0}}\right)$ 确定一个方向,解曲线通过点 $\left( {{x}_{0},{y}_{0}}\right)$ 的切线方向. 在下一个插值点前欧拉法沿着该方向. 龙格-库塔法在点 $\left( {{x}_{0},{y}_{0}}\right)$ 与该曲线下一个可能的点 $\left( {{x}_{0} + h,{y}_{1}}\right)$ 之间考虑更多的点,适当选取这些附加点以得到 ${y}_{1}$ 更准确的值. 依赖于 “辅助点” 的数目与排列,有不同阶的龙格-库塔法. 这里给出了四阶方法 (参见第 1263 页 19.4.1.5). (欧拉法是一阶龙格-库塔法.)

对从 ${x}_{0}$ 到 ${x}_{1} = {x}_{0} + h$ 这一步,四阶计算格式在 (19.99) 中得到 (19.93) 的 ${y}_{1}$ 的近似值. 遵照同样的格式进行下一步.

根据 (19.99) 龙格-库塔法的误差在每一步有 ${h}^{5}$ 阶,因此适当选取步长可以得到高精度.(19.99)

<table><tr><td>$x$</td><td>$y$</td><td>$k = h \cdot  f\left( {x, y}\right)$</td></tr><tr><td>${x}_{0}$</td><td>${y}_{0}$</td><td>${k}_{1}$</td></tr><tr><td>${x}_{0} + h/2$</td><td>${y}_{0} + {k}_{1}/2$</td><td>${k}_{2}$</td></tr><tr><td>${x}_{0} + h/2$</td><td>${y}_{0} + {k}_{2}/2$</td><td>${k}_{3}$</td></tr><tr><td>${x}_{0} + h$</td><td>${y}_{0} + {k}_{3}$</td><td>${k}_{4}$</td></tr><tr><td>${x}_{1} = {x}_{0} + h$</td><td colspan="2">${y}_{1} = {y}_{0} + \frac{1}{6}\left( {{k}_{1} + 2{k}_{2} + 2{k}_{3} + {k}_{4}}\right)$</td></tr></table>

$\blacksquare {y}^{\prime } = \frac{1}{4}\left( {{x}^{2} + {y}^{2}}\right)$ ,其中 $y\left( 0\right)  = 0.y\left( {0.5}\right)$ 由一步确定,即 $h = {0.5}$ (见下表). 8 位数字的准确值为 0.01041860 .

<table><tr><td>$x$</td><td>$y$</td><td>$k = \frac{1}{8}\left( {{x}^{2} + {y}^{2}}\right)$</td></tr><tr><td>0</td><td>0</td><td>0</td></tr><tr><td>0.25</td><td>0</td><td>0.00781250</td></tr><tr><td>0.25</td><td>0.00390625</td><td>0.00781441</td></tr><tr><td>0.5</td><td>0.00781441</td><td>0.03125763</td></tr><tr><td>0.5</td><td colspan="2">0.01041858</td></tr></table>

## 2. 注

(1) 对于特殊的微分方程 ${y}^{\prime } = f\left( x\right)$ ,龙格-库塔法化为辛普森公式 (参见第 1254 页 19.3.2.3).

(2) 对于大量的积分步, 有时候必须改变步长. 改变步长可由原步长重复加倍的精度检验来决定. 若由单倍步长计算 $y\left( {{x}_{0} + {2h}}\right)$ 得近似值 ${y}_{2}\left( h\right)$ ,而由双倍步长计算得 ${y}_{2}\left( {2h}\right)$ ,则误差 ${R}_{2}\left( h\right)  = y\left( {{x}_{0} + h}\right)  - {y}_{2}\left( h\right)$ 的估计为

$$
{R}_{2}\left( h\right)  \approx  \frac{1}{15}\left\lbrack  {{y}_{2}\left( h\right)  - {y}_{2}\left( {2h}\right) }\right\rbrack  . \tag{19.100}
$$

关于步长改变的文献见 [19.31].

(3) 龙格-库塔法对高阶常微分方程也适用, 见 [19.31]. 高阶常微分方程可写成一阶常微分方程组. 于是根据 (19.99), 尽管微分方程之间相互关联, 计算可以并行进行.

##### 19.4.1.3 多步法

由于我们仅从 ${y}_{i}$ 计算 ${y}_{i + 1}$ ,因此欧拉法 (19.97) 与龙格-库塔法 (19.99) 都称为单步法. 一般的线性多步法有如下形式:

---

$$
{y}_{i + k} + {\alpha }_{k - 1}{y}_{i + k - 1} + {\alpha }_{k - 2}{y}_{i + k - 2} + \cdots  + {\alpha }_{1}{y}_{i + 1} + {\alpha }_{0}{y}_{i}
$$

---

$$
= h\left( {{\beta }_{k}{f}_{i + k} + {\beta }_{k - 1}{f}_{i + k - 1} + \cdots  + {\beta }_{1}{f}_{i + 1} + {\beta }_{0}{f}_{i}}\right) , \tag{19.101}
$$

适当选取常数 ${\alpha }_{i}$ 和 ${\beta }_{j}\left( {j = 0,1,\cdots , k;{\alpha }_{k} = 1}\right)$ . 若 ${\alpha }_{0} + {\beta }_{0} \neq  0$ ,公式 (19.101) 称为 $k$ 步法. 若 ${\beta }_{k} = 0$ ,因为此时 (19.101) 的右端 ${f}_{i + j} = f\left( {{x}_{i + j},{y}_{i + j}}\right)$ 仅包含已知的值为 ${y}_{i},{y}_{i + 1},\cdots ,{y}_{i + k - 1}$ ,故称为显式的. 若 ${\beta }_{k} \neq  0$ ,此时 (19.101) 两端都需要求新的值 ${y}_{i + k}$ ,则称为隐式的.

在 $k$ 步法中, $k$ 个初值 ${y}_{0},{y}_{1},\cdots ,{y}_{k - 1}$ 必须已知. 这些初值可以由单步法求得.

若 (19.93) 中的导数 ${y}^{\prime }\left( {x}_{i}\right)$ 由差分公式代替 (参见第 727 页 9.1.1.5,1.),或 (19.95) 中的积分由求积公式近似 (参见第 1252 页 19.3.1), 则由特殊的多步法来求解初值问题 (19.93).

特殊多步法的例子如下.

## 1. 中点法则

(19.93) 中的导数 ${y}^{\prime }\left( {x}_{i + 1}\right)$ 由插值节点 ${x}_{i}$ 和 ${x}_{i + 2}$ 之间的割线斜率代替,即

$$
{y}_{i + 2} - {y}_{i} = {2h}{f}_{i + 1}. \tag{19.102}
$$

## 2. 米尔恩 (Milne) 法则

(19.95) 中的积分由辛普森公式近似

$$
{y}_{i + 2} - {y}_{i} = \frac{h}{3}\left( {{f}_{i} + 4{f}_{i + 1} + {f}_{i + 2}}\right) . \tag{19.103}
$$

## 3. 亚当斯-巴什福思 (Adams-Bashforth) 法则

(19.95) 中的积分由基于 $k$ 个插值节点 ${x}_{i},{x}_{i + 1},\cdots ,{x}_{i + k - 1}$ 的拉格朗日插值多项式 (参见第 1277 页 19.6.1.2) 代替. 在 ${x}_{i + k - 1}$ 与 ${x}_{i + k}$ 之间积分得到

$$
{y}_{i + k} - {y}_{i + k - 1} = \mathop{\sum }\limits_{{j = 0}}^{{k - 1}}\left\lbrack  {{\int }_{{x}_{i + k - 1}}^{{x}_{i + k}}{L}_{j}\left( x\right) \mathrm{d}x}\right\rbrack  f\left( {{x}_{i + j},{y}_{i + j}}\right)  = h\mathop{\sum }\limits_{{j = 0}}^{{k - 1}}{\beta }_{j}f\left( {{x}_{i + j},{y}_{i + j}}\right) .
$$

(19.104)

方法 (19.104) 对于 ${y}_{i + k}$ 是显式的. 系数 ${\beta }_{j}$ 的计算见 [19.4].

##### 19.4.1.4 预估-校正法

实际上, 隐式多步法相较于显式多步法有很大的优越性, 因为在相同的精度下隐式法允许大得多的步长. 但是隐式多步法通常需要求解非线性方程来得到近似值 ${y}_{i + k}$ . 从 (19.101) 可得如下形式:

$$
{y}_{i + k} = h\mathop{\sum }\limits_{{j = 0}}^{k}{\beta }_{j}{f}_{i + j} - \mathop{\sum }\limits_{{j = 0}}^{{k - 1}}{\alpha }_{j}{y}_{i + j} = F\left( {y}_{i + k}\right) . \tag{19.105}
$$

求解方程 (19.105) 需要迭代. 其具体过程是: 根据显式公式确定初值 ${y}_{i + k}^{\left( 0\right) }$ ,称之为预估子, 然后用迭代公式校正

$$
{y}_{i + k}^{\left( \mu  + 1\right) } = F\left( {y}_{i + k}^{\left( \mu \right) }\right) \;\left( {\mu  = 0,1,2,\cdots }\right) , \tag{19.106}
$$

这称为由隐式法得到的校正子. 特殊的预估-校正公式有

(1)

$$
{y}_{i + 1}^{\left( 0\right) } = {y}_{i} + \frac{h}{12}\left( {5{f}_{i - 2} - {16}{f}_{i - 1} + {23}{f}_{i}}\right) , \tag{19.107a}
$$

$$
{y}_{i + 1}^{\left( \mu  + 1\right) } = {y}_{i} + \frac{h}{12}\left( {-{f}_{i - 1} + 8{f}_{i} + 5{f}_{i + 1}^{\left( \mu \right) }}\right) \;\left( {\mu  = 0,1,\cdots }\right) ; \tag{19.107b}
$$

(2)

$$
{y}_{i + 1}^{\left( 0\right) } = {y}_{i - 2} + 9{y}_{i - 1} - 9{y}_{i} + {6h}\left( {{f}_{i - 1} + {f}_{i}}\right) , \tag{19.108a}
$$

$$
{y}_{i + 1}^{\left( \mu  + 1\right) } = {y}_{i - 1} + \frac{h}{3}\left( {{f}_{i - 1} + 4{f}_{i} + {f}_{i + 1}^{\left( \mu \right) }}\right) \;\left( {\mu  = 0,1,\cdots }\right) . \tag{19.108b}
$$

辛普森公式作为 (19.108b) 中的校正子在数值上是不稳定的, 它可以被替换为

$$
{y}_{i + 1}^{\left( \mu  + 1\right) } = {0.9}{y}_{i - 1} + {0.1}{y}_{i} + \frac{h}{24}\left( {{0.1}{f}_{i - 2} + {6.7}{f}_{i - 1} + {30.7}{f}_{i} + {8.1}{f}_{i + 1}^{\left( \mu \right) }}\right) . \tag{19.109}
$$

##### 19.4.1.5 收敛性、相容性、稳定性

## 1. 整体离散误差和收敛性

单步法可以写成一般形式

$$
{y}_{i + 1} = {y}_{i} + {hF}\left( {{x}_{i},{y}_{i}, h}\right) \;\left( {i = 0,1,2,\cdots ;{y}_{0}\text{ 给定 }}\right) , \tag{19.110}
$$

这里 $F\left( {x, y, h}\right)$ 称为单步法的增长函数或者顺向函数. 由 (19.110) 得到的近似解依赖于步长 $h$ ,记为 $y\left( {x, h}\right)$ . 它与初值问题 (19.93) 的准确解 $y\left( x\right)$ 的差被称为整体离散误差 $g\left( {x, h}\right)$ (见 (19.111)). 若 $p$ 是满足

$$
g\left( {x, h}\right)  = y\left( {x, h}\right)  - y\left( x\right)  = O\left( {h}^{p}\right)  \tag{19.111}
$$

的最大的自然数,称单步法 (19.110) 是 $p$ 阶收敛的. 公式 (19.111) 表明,若 $h \rightarrow  0$ , 步长 $h = \frac{x - {x}_{0}}{n}$ ,对于初值问题区域内的每一 $x$ ,近似解 $y\left( {x, h}\right)$ 收敛到准确解 $y\left( x\right)$ .

| 欧拉法 (19.97) 有一阶收敛性 $p = 1$ . 对于龙格-库塔法 (19.99) 则有 $p = 4$ .

## 2. 局部离散误差与相容性

根据 (19.111),收敛阶表明近似解 $y\left( {x, h}\right)$ 逼近准确解 $y\left( x\right)$ 的好坏程度. 此外, 一个有趣的问题是增长函数 $F\left( {x, y, h}\right)$ 逼近导数 ${y}^{\prime } = f\left( {x, y}\right)$ 的程度. 为此目的, 引进所谓局部离散误差 $l\left( {x, h}\right)$ (见 (19.112)). 若 $p$ 是满足

$$
l\left( {x, h}\right)  = \frac{y\left( {x + h}\right)  - y\left( x\right) }{h} - F\left( {x, y, h}\right)  = O\left( {h}^{p}\right)  \tag{19.112}
$$

的最大的自然数,则称单步法 (19.110) 是 $p$ 阶相容的.

由 (19.112) 直接得到对相容的单步法

$$
\mathop{\lim }\limits_{{h \rightarrow  0}}F\left( {x, y, h}\right)  = f\left( {x, y}\right) . \tag{19.113}
$$

I 欧拉法 (19.97) 有一阶相容性 $p = 1$ . 龙格-库塔法 (19.99) 则有四阶相容性 $p = 4$ .

## 3. 对初值扰动的稳定性

单步法在实施过程中,舍入误差 $O\left( {1/h}\right)$ 加到整体离散误差 $O\left( {h}^{p}\right)$ 上. 因此我们需要选择一个不太小的有限步长 $h > 0$ . 在初值扰动或者 ${x}_{i} \rightarrow  \infty$ 时数值解 ${y}_{i}$ 如何表现也是一个重要的问题.

在常微分方程理论下, 如果

$$
\left| {\widetilde{y}\left( x\right)  - y\left( x\right) }\right|  \leq  \left| {{\widetilde{y}}_{0} - {y}_{0}}\right| , \tag{19.114}
$$

则称初值问题 (19.93) 关于初值扰动是稳定的. 这里 $\widetilde{y}\left( x\right)$ 为 (19.93) 关于扰动初值 ${\widetilde{y}}_{0}\left( {x}_{0}\right)  = {\widetilde{y}}_{0}$ 的解. 估计 (19.114) 告诉我们,解的差的绝对值不大于初值的扰动.

一般地, 由于 (19.114) 难以检验, 因此仅考虑线性试验问题

$$
{y}^{\prime } = {\lambda y}\text{,其中}y\left( {x}_{0}\right)  = {y}_{0}\;\left( {\lambda  \leq  0\text{为常数}}\right)  \tag{19.115}
$$

用于这一特殊初值问题的单步法是稳定的. 若用一个步长为 $h > 0$ 的相容的方法求解上述线性试验问题 (19.115), 得到的近似解满足条件

$$
\left| {y}_{i}\right|  \leq  \left| {y}_{0}\right|  \tag{19.116}
$$

则称此法对初值扰动是绝对稳定的.

应用欧拉多边形法求解方程 (19.115) 得到解 ${y}_{i + 1} = \left( {1 + {\lambda h}}\right) {y}_{i}\left( {i = 0,1,\cdots }\right)$ . 显然,若 $\left| {1 + {\lambda h}}\right|  \leq  1$ ,则 (19.116) 成立,因此步长必须满足 $- 2 \leq  {\lambda h} \leq  0$ .

## 4. 刚性微分方程组

包括化学动力学问题在内的许多应用问题, 可以归结为这样的微分方程, 其解由递减收敛到零的不同的指数项组成. 这些方程称为刚性微分方程. 例如

$$
y\left( x\right)  = {C}_{1}{\mathrm{e}}^{{\lambda }_{1}x} + {C}_{2}{\mathrm{e}}^{{\lambda }_{2}x}\;\left( {{C}_{1},{C}_{2},{\lambda }_{1},{\lambda }_{2}\text{ 为常数 }}\right) , \tag{19.117}
$$

其中 ${\lambda }_{1} < 0,{\lambda }_{2} < 0$ 而且 $\left| {\lambda }_{1}\right|  <  < \left| {\lambda }_{2}\right|$ ,例如 ${\lambda }_{1} =  - 1,{\lambda }_{2} =  - {1000}$ . 含 ${\lambda }_{2}$ 的项对解函数并无显著影响,但在数值方法中影响步长 $h$ 的选取. 在这种情况下,选取适当的数值方法特别重要 (见 [19.29], [19.6]).

#### 19.4.2 边值问题

求解常微分方程边值问题最重要的方法用于下面二阶微分方程的简单线性边值问题:

$$
{y}^{\prime \prime }\left( x\right)  + p\left( x\right) {y}^{\prime }\left( x\right)  + q\left( x\right) y\left( x\right)  = f\left( x\right) \left( {a \leq  x \leq  b}\right) \text{,其中}y\left( \alpha \right)  = \alpha , y\left( \beta \right)  = \beta \text{,}
$$

(19.118)

其中函数 $p\left( x\right) , q\left( x\right) , f\left( x\right)$ 及常数 $\alpha ,\beta$ 是已知的.

给出的方法也适于求解高阶微分方程边值问题.

##### 19.4.2.1 差分法

区间 $\left\lbrack  {a, b}\right\rbrack$ 被等距节点 ${x}_{v} = {x}_{0} + {vh}\left( {v = 0,1,2,\cdots , n;{x}_{0} = a,{x}_{n} = b}\right)$ 等分, 在内部插值点将所谓有限差分代替微分方程

$$
{y}^{\prime \prime }\left( {x}_{\nu }\right)  + p\left( {x}_{\nu }\right) {y}^{\prime }\left( {x}_{\nu }\right)  + q\left( {x}_{\nu }\right) y\left( {x}_{\nu }\right)  = f\left( {x}_{\nu }\right) \;\left( {\nu  = 1,2,\cdots , n - 1}\right)  \tag{19.119}
$$

中的导数值, 例如:

$$
{y}^{\prime }\left( {x}_{\nu }\right)  \approx  {y}_{\nu }^{\prime } = \frac{{y}_{\nu  + 1} - {y}_{\nu  - 1}}{2h}, \tag{19.120a}
$$

$$
{y}^{\prime \prime }\left( {x}_{\nu }\right)  \approx  {y}_{\nu }^{\prime \prime } = \frac{{y}_{\nu  + 1} - 2{y}_{\nu } + {y}_{\nu  - 1}}{{h}^{2}}. \tag{19.120b}
$$

考虑到边界条件 ${y}_{0} = \alpha ,{y}_{n} = \beta$ ,由此得到区间 $\left\lbrack  {a, b}\right\rbrack$ 内关于 $n - 1$ 个插值 ${y}_{v} \approx$ $y\left( {x}_{v}\right)$ 的 $n - 1$ 个线性方程. 若边界条件包含导数,则也必须由有限差分来代替.

微分方程组 (参见第 753 页 9.1.3.2) 的特征值问题可以类似处理. 应用由 (19.119) 与 (19.120a, 19.120b) 表述的有限差分法即得到矩阵特征值问题 (参见第 421 页 4.6).

求解带边值条件 $y\left( 0\right)  = y\left( 1\right)  = 0$ 的齐次微分方程 ${y}^{\prime \prime } + {\lambda }^{2}y = 0$ 导致矩阵特征值问题. 有限差分法将微分方程转化为差分方程 ${y}_{v + 1} - 2{y}_{v} + {y}_{v - 1} + {h}^{2}{\lambda }^{2}{y}_{v} = 0$ . 如果选取三个内点,此时 $h = 1/4$ ,考虑到 ${y}_{0} = y\left( 0\right)  = 0,{y}_{4} = y\left( 1\right)  = 0$ ,则离散方

程组为

$$
\left( {-2 + \frac{{\lambda }^{2}}{16}}\right) {y}_{1} + \;{y}_{2}\; = 0,
$$

$$
{y}_{1} + \left( {-2 + \frac{{\lambda }^{2}}{16}}\right) {y}_{2} + \;{y}_{3} = 0,
$$

$$
{y}_{2} + \left( {-2 + \frac{{\lambda }^{2}}{16}}\right) {y}_{3} = 0.
$$

仅当系数行列式为零时该齐次线性方程组有非平凡解. 该条件导致特征值 ${\lambda }_{1}^{2} =$ ${9.37},{\lambda }_{2}^{2} = {32},{\lambda }_{3}^{2} = {54.63}$ . 在这些特征值里只有最小的一个接近相应的真值 9.87.

注 差分法的精度可以这样改进:

(1) 减小步长 $h$ ;

(2) 应用导数的高阶逼近 (如 (19.120a,19.120b) 的逼近有 $O\left( {h}^{2}\right)$ 阶误差);

(3) 应用多步法 (参见第 1261 页 19.4.1.3).

若问题是非线性边值问题,则差分法导致未知近似值 ${y}_{\nu }$ 的非线性方程组 (参见第 1249 页 19.2.2).

##### 19.4.2.2 用已知函数逼近

边值问题 (19.118) 的近似解是适当选取的线性无关函数 ${g}_{i}\left( x\right)$ 的线性组合,并

满足边界条件

$$
y\left( x\right)  \approx  g\left( x\right)  = \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{i}{g}_{i}\left( x\right) . \tag{19.121}
$$

将 $g\left( x\right)$ 代入微分方程 (19.118) 得到的误差称为亏量:

$$
\varepsilon \left( {x;{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)  = {g}^{\prime \prime }\left( x\right)  + p\left( x\right) {g}^{\prime }\left( x\right)  + q\left( x\right) g\left( x\right)  - f\left( x\right) . \tag{19.122}
$$

可用如下原则确定系数 ${a}_{i}$ .

## 1. 配置法

亏量要在给定的 $n$ 个所谓配置点 ${x}_{v}$ 上为零. 由条件

$$
\varepsilon \left( {{x}_{\nu };{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)  = 0\;\left( {\nu  = 1,2,\cdots , n}\right) ,\;a < {x}_{1} < {x}_{2} < \cdots  < {x}_{n} < b
$$

(19.123)得到未知系数的线性方程组.

## 2. 最小二乘法

依赖于系数的积分

$$
F\left( {{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)  = {\int }_{a}^{b}{\varepsilon }^{2}\left( {x;{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right) \mathrm{d}x \tag{19.124}
$$

应该最小. 必要条件

$$
\frac{\partial F}{\partial {a}_{i}} = 0\;\left( {i = 1,2,\cdots , n}\right)  \tag{19.125}
$$

给出了系数 ${a}_{i}$ 的线性方程组.

## 3. 伽辽金 (Galerkin) 法

需要满足所谓误差正交性, 即

$$
{\int }_{a}^{b}\varepsilon \left( {x;{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right) {g}_{i}\left( x\right) \mathrm{d}x = 0\;\left( {i = 1,2,\cdots , n}\right) , \tag{19.126}
$$

由此得到未知系数的线性方程组.

## 4. 里茨法

解 $y\left( x\right)$ 常有使得变分积分极小化的性质

$$
I\left\lbrack  y\right\rbrack   = {\int }_{a}^{b}H\left( {x, y,{y}^{\prime }}\right) \mathrm{d}x \tag{19.127}
$$

(见 (10.4)). 若函数 $H\left( {x, y,{y}^{\prime }}\right)$ 已知,则将 $y\left( x\right)$ 换为 (19.121) 中的近似函数 $g\left( x\right)$ , $I\left\lbrack  y\right\rbrack   = I\left( {{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)$ 极小化. 由必要条件

$$
\frac{\partial I}{\partial {a}_{i}} = 0\;\left( {i = 1,2,\cdots , n}\right)  \tag{19.128}
$$

得到系数 ${a}_{i}$ 的 $n$ 个方程.

■ 在关于函数 $p, q, f, y$ 的一定条件下,边值问题

$$
- {\left\lbrack  p\left( x\right) {y}^{\prime }\left( x\right) \right\rbrack  }^{\prime } + q\left( x\right) y\left( x\right)  = f\left( x\right) \text{,其中}y\left( \alpha \right)  = \alpha , y\left( \beta \right)  = \beta  \tag{19.129}
$$

与其变分问题

$$
I\left\lbrack  y\right\rbrack   = {\int }_{a}^{b}\left\lbrack  {p\left( x\right) {y}^{\prime 2}\left( x\right)  + q\left( x\right) {y}^{2}\left( x\right)  - {2f}\left( x\right) y\left( x\right) }\right\rbrack  \mathrm{d}x = \min ,
$$

$$
\text{其中}y\left( \alpha \right)  = \alpha , y\left( \beta \right)  = \beta  \tag{19.130}
$$

等价. 于是对于边值问题 (19.129),由 (19.130) 立即得到 $H\left( {x, y,{y}^{\prime }}\right)$ .

代替逼近 (19.121), 常考虑

$$
g\left( x\right)  = {g}_{0}\left( x\right)  + \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{i}{g}_{i}\left( x\right) , \tag{19.131}
$$

其中 ${g}_{0}\left( x\right)$ 满足边值,而函数 ${g}_{i}\left( x\right)$ 满足条件

$$
{g}_{i}\left( a\right)  = {g}_{i}\left( b\right)  = 0\;\left( {i = 1,2,\cdots , n}\right) . \tag{19.132}
$$

例如, 对问题 (19.118), 适当的选择是

$$
{g}_{0}\left( x\right)  = \alpha  + \frac{\beta  - \alpha }{b - a}\left( {x - a}\right) . \tag{19.133}
$$

注 在线性边值问题中, 由 (19.121) 和 (19.131) 可得系数的线性方程组. 对于非线性边值问题, 得到的非线性方程组可用第 1249 页 19.2.2 中给出的方法求解.

##### 19.4.2.3 打靶法

边值问题的解用打靶法可化为初值问题的解. 该法的基本思想用单目标打靶法描述如下.

## 1. 单目标打靶法

初值问题

$$
{y}^{\prime \prime } + p\left( x\right) {y}^{\prime } + q\left( x\right) y = f\left( x\right) \text{,其中}y\left( \alpha \right)  = \alpha ,{y}^{\prime }\left( \alpha \right)  = s \tag{19.134}
$$

关联于边值问题 (19.118). 这里初值问题 (19.134) 的解 $y$ 依赖于参数 $s$ ,即 $y =$ $y\left( {x, s}\right)$ 成立. 根据 (19.134),函数 $y\left( {x, s}\right)$ 满足第一个边界条件 $y\left( {a, s}\right)  = \alpha$ . 参数 $s$ 应由函数 $y\left( {x, s}\right)$ 满足第二个边界条件 $y\left( {b, s}\right)  = \beta$ 来确定. 因此,需要求解方程

$$
F\left( s\right)  = y\left( {b, s}\right)  - \beta , \tag{19.135}
$$

试位法 (割线法) 就是适当的求解方法. 只需要求出函数 $F\left( s\right)$ 的值,但是对每一个特别的参数 $s$ ,计算函数值都需要求解初值问题 (19.134) 直到 $x = b$ . 19.4.1 已给出此计算方法.

## 2. 多目标打靶法

在所谓多目标打靶法中,积分区间 $\left\lbrack  {a, b}\right\rbrack$ 被分为子区间,在每个子区间上用单目标打靶法. 于是要求的解由子区间上的解构成, 这里必须保证在子区间的端点连续过渡.

这就要求更多的条件. 对于大多用于非线性边值问题的多目标打靶法的数值实现, 见 [19.31].

### 19.5 偏微分方程的近似求解

本节仅以带有两个独立变量及相应的边值/初值条件的线性二阶偏微分方程为例, 讨论偏微分方程数值解的原理.

#### 19.5.1 差分法

通过选取点 $\left( {{x}_{\mu },{y}_{v}}\right)$ ,考虑在积分区域内的正规网格. 通常选等距的矩形网格:

$$
{x}_{\mu } = {x}_{0} + {\mu h},\;{y}_{\nu } = {y}_{0} + {\nu l}\;\left( {\mu ,\nu  = 1,2,\cdots }\right) . \tag{19.136}
$$

当 $l = h$ 时,得到正方形网格. 若所求的解记为 $u\left( {x, y}\right)$ ,则按如下方式以有限差分代替出现在微分方程及边值或初值中的偏导数,其中 ${u}_{\mu \nu }$ 表示函数 $u\left( {{x}_{\mu },{y}_{\nu }}\right)$ 的近似值: 在 (19.137) 中由朗道符号 $O$ 给出误差阶. 在某些情况下,应用带固定参数 $\sigma \left( {0 \leq  \sigma  \leq  1}\right)$ 的近似

$$
\frac{{\partial }^{2}u}{\partial {x}^{2}}\left( {{x}_{\mu },{y}_{\nu }}\right)  \approx  \sigma \frac{{u}_{\mu  + 1,\nu  + 1} - 2{u}_{\mu ,\nu  + 1} + {u}_{\mu  - 1,\nu  + 1}}{{h}^{2}} + \left( {1 - \sigma }\right) \frac{{u}_{\mu  + 1,\nu } - 2{u}_{\mu ,\nu } + {u}_{\mu  - 1,\nu }}{{h}^{2}}
$$

(19.138)

<table><tr><td>偏导数</td><td>有限差分</td><td>误差阶</td></tr><tr><td>$\frac{\partial u}{\partial x}\left( {{x}_{\mu },{y}_{\nu }}\right)$</td><td>$\frac{1}{h}\left( {{u}_{\mu  + 1,\nu } - {u}_{\mu ,\nu }}\right)$ 或 $\frac{1}{2h}\left( {{u}_{\mu  + 1,\nu } - {u}_{\mu  - 1,\nu }}\right)$</td><td>$O\left( h\right)$ 或 $O\left( {h}^{2}\right)$</td></tr><tr><td>$\frac{\partial u}{\partial y}\left( {{x}_{\mu },{y}_{\nu }}\right)$</td><td>$\frac{1}{l}\left( {{u}_{\mu ,\nu  + 1} - {u}_{\mu ,\nu }}\right)$ 或 $\frac{1}{2l}\left( {{u}_{\mu ,\nu  + 1} - {u}_{\mu ,\nu  - 1}}\right)$</td><td>$O\left( l\right)$ 或 $O\left( {l}^{2}\right)$</td></tr><tr><td>$\frac{{\partial }^{2}u}{\partial x\partial y}\left( {{x}_{\mu },{y}_{\nu }}\right)$</td><td>$\frac{1}{4hl}\left( {{u}_{\mu  + 1,\nu  + 1} - {u}_{\mu  + 1,\nu  - 1}}\right.$ $\left. {-{u}_{\mu  - 1,\nu  + 1} + {u}_{\mu  - 1,\nu  - 1}}\right)$</td><td>$O\left( {hl}\right)$</td></tr><tr><td>$\frac{{\partial }^{2}u}{\partial {x}^{2}}\left( {{x}_{\mu },{y}_{\nu }}\right)$</td><td>$\frac{1}{{h}^{2}}\left( {{u}_{\mu  + 1,\nu } - 2{u}_{\mu ,\nu } + {u}_{\mu  - 1,\nu }}\right)$</td><td>$O\left( {h}^{2}\right)$</td></tr><tr><td>$\frac{{\partial }^{2}u}{\partial {y}^{2}}\left( {{x}_{\mu },{y}_{\nu }}\right)$</td><td>$\frac{1}{{l}^{2}}\left( {{u}_{\mu ,\nu  + 1} - 2{u}_{\mu ,\nu } + {u}_{\mu ,\nu  - 1}}\right)$</td><td/></tr></table>

(19.137)

更实用. 公式 (19.138) 表示由相应于 $y = {y}_{\nu }, y = {y}_{v + 1}$ 的公式 (19.137) 得到的两个表达式的凸线性组合.

由公式 (19.137) 偏微分方程可以在网格的每个内点写成差分方程, 这里同样考虑其边值条件与初值条件. 对于小的步长 $h$ 和 $l$ ,关于近似值 ${u}_{\mu \nu }$ 的线性方程组有高的维数, 通常用迭代法 (参见第 1248 页 19.2.1.4) 来求解.

$\blacksquare \mathbf{A}$: 设函数 $u\left( {x, y}\right)$ 为定义在矩形 $\left| x\right|  < 1,\left| y\right|  < 2$ 内部,并在边界 $\left| x\right|  = 1,\left| y\right|  = 2$ 上满足 $u = 0$ 的微分方程 ${\Delta u} = {u}_{xx} + {u}_{yy} =  - 1$ 的解. 对步长为 $h$ 的正方形网格, 相应于微分方程的差分方程为: $4{u}_{\mu ,\nu } = {u}_{\mu  + 1,\nu } + {u}_{\mu ,\nu  + 1} + {u}_{\mu  - 1,\nu } + {u}_{\mu ,\nu  - 1} + {h}^{2}$ . 步长 $h = 1$ (图 19.6) 导致三内点的粗网格近似: $4{u}_{0,1} = 0 + 0 + 0 + {u}_{0,0} + 1$ ,$4{u}_{0,0} = 0 + {u}_{0,1} + 0 + {u}_{0, - 1} + 1,4{u}_{0, - 1} = 0 + {u}_{0,0} + 0 + 0 + 1.$

其解为 ${u}_{0,0} = \frac{3}{7} \approx  {0.429},{u}_{0,1} = {u}_{0, - 1} = \frac{5}{14} \approx  {0.357}$ .

![01937d01-b6f6-7881-8294-3a9c82211946_36_604_209_431_398_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_36_604_209_431_398_0.jpg)

图 19.6

$\blacksquare \mathbf{B}$: 应用差分法求解偏微分方程得到的线性方程组具有非常特殊的结构. 以下面更一般的边值问题为例说明之. 积分区域为正方形 $G : 0 \leq  x \leq  1,0 \leq  y \leq  1$ . 函数 $u\left( {x, y}\right)$ 在区域 $G$ 内满足微分方程 ${\Delta u} = {u}_{xx} + {u}_{yy} = f\left( {x, y}\right)$ ,在 $G$ 的边界上满足 $u\left( {x, y}\right)  = g\left( {x, y}\right)$ . 函数 $f$ 和 $g$ 已知. 对步长 $h = l = 1/n$ ,关联于微分方程的差分方程为

${u}_{\mu  + 1,\nu } + {u}_{\mu ,\nu  + 1} + {u}_{\mu  - 1,\nu } + {u}_{\mu ,\nu  - 1} - 4{u}_{\mu ,\nu } = \frac{1}{{n}^{2}}f\left( {{x}_{\mu },{y}_{\nu }}\right) \;\left( {\mu ,\nu  = 1,2,\cdots , n - 1}\right) .$当 $n = 5$ 时,按 $4 \times  4$ 个内点从左到右逐行排列,考虑到边界上的函数值已知,则近似值 ${u}_{\mu \nu }$ 的差分方程组的左边为节点的选取. 对于诸如椭圆、抛物、双曲等不同类型的二阶偏微分方程, 发展了更有效的方法, 并研究了收敛性与稳定性条件. 关于这一课题有大量的著述 (例如见 [19.28], [19.31], [19.20]).

![01937d01-b6f6-7881-8294-3a9c82211946_36_205_1218_1237_933_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_36_205_1218_1237_933_0.jpg)

(19.139)

系数矩阵是对称稀疏的. 这个形式称为块三对角矩阵. 显然矩阵的形式依赖于网格

#### 19.5.2 用已知函数逼近

解 $u\left( {x, y}\right)$ 用如下形式的函数逼近:

$$
u\left( {x, y}\right)  \approx  v\left( {x, y}\right)  = {v}_{0}\left( {x, y}\right)  + \mathop{\sum }\limits_{{i = 1}}^{n}{a}_{i}{v}_{i}\left( {x, y}\right) . \tag{19.140}
$$

这里需要区别两种情况:

(1) ${v}_{0}\left( {x, y}\right)$ 满足给定的非齐次微分方程,而函数 ${v}_{i}\left( {x, y}\right) \left( {i = 1,2,\cdots , n}\right)$ 满足相应的齐次微分方程 (则要求线性组合逼近给定的边界条件).

(2) ${v}_{0}\left( {x, y}\right)$ 满足给定的非齐次微分方程的边界条件,而其他函数 ${v}_{i}\left( {x, y}\right) (i =$ $1,2,\cdots , n)$ 满足齐次边界条件 (则要求线性组合在所考虑的区域内尽可能逼近微分方程的解).

将形如 (19.140) 的近似函数 $v\left( {x, y}\right)$ 在第一种情况代入边界条件,在第二种情况代入微分方程, 得到称为亏量的误差项:

$$
\varepsilon  = \varepsilon \left( {x, y;{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right) . \tag{19.141}
$$

可用下列方法之一确定未知系数 ${a}_{i}$ .

## 1. 配置法

亏量 $\varepsilon$ 应该在 $n$ 个合理的不同的点为零,这 $n$ 个点称为配置点 $\left( {{x}_{v},{y}_{v}}\right) (v = 1$ , $2,\cdots , n)$ :

$$
\varepsilon \left( {{x}_{\nu },{y}_{\nu };{a}_{1},{a}_{2},\cdots ,{a}_{n}}\right)  = 0\;\left( {\nu  = 1,2,\cdots , n}\right) . \tag{19.142}
$$

第一种情况配置点在边界上 (称为边界配置), 第二种情况配置点为区域内点 (称为区域配置). 由 (19.142) 得到系数的 $n$ 个方程. 边界配置通常比区域配置更受欢迎. | 用此方法求解 19.5.1 中用差分法求解的例题, 其中函数

$$
v\left( {x, y;{a}_{1},{a}_{2},{a}_{3}}\right)  =  - \frac{1}{4}\left( {{x}^{2} + {y}^{2}}\right)  + {a}_{1} + {a}_{2}\left( {{x}^{2} - {y}^{2}}\right)  + {a}_{3}\left( {{x}^{4} - 6{x}^{2}{y}^{2} + {y}^{4}}\right)
$$

满足微分方程,可通过在点 $\left( {{x}_{1},{y}_{1}}\right)  = \left( {1,{0.5}}\right) ,\left( {{x}_{2},{y}_{2}}\right)  = \left( {1,{1.5}}\right) ,\left( {{x}_{3},{y}_{3}}\right)  = \left( {{0.5},2}\right)$ 满足边界条件来确定系数 (边界配置). 线性方程组

$$
- {0.3125} + {a}_{1} + {0.75}{a}_{2} - {0.4375}{a}_{3} = 0,
$$

$$
- {0.8125} + {a}_{1} - {1.25}{a}_{2} - {7.4375}{a}_{3} = 0,
$$

$$
- {1.0625} + {a}_{1} - {3.75}{a}_{2} + {10.0625}{a}_{3} = 0
$$

的解为 ${a}_{1} = {0.4562},{a}_{2} =  - {0.200},{a}_{3} =  - {0.0143}$ . 通过近似函数可以计算解在任意点的近似值. 将此值与有限差分法得到的近似值相比: $v\left( {0,1}\right)  = {0.3919}, v\left( {0,0}\right)  =$0.4562 .

## 2. 最小二乘法

依赖于近似函数是否满足微分方程或边界条件, 需要:

(1)在边界 $C$ 上的线积分

$$
I = {\int }_{\left( C\right) }{\varepsilon }^{2}\left( {x\left( t\right) , y\left( t\right) ;{a}_{1},\cdots ,{a}_{n}}\right) \mathrm{d}t = \min , \tag{19.143a}
$$

其中边界曲线 $C$ 由参数方程 $x = x\left( t\right) , y = y\left( t\right)$ 给出.

(2)或者区域 $G$ 上的二重积分

$$
I = {\iint }_{\left( G\right) }{\varepsilon }^{2}\left( {x, y;{a}_{1},\cdots ,{a}_{n}}\right) \mathrm{d}x\mathrm{\;d}y = \min  \tag{19.143b}
$$

由必要条件 $\frac{\partial I}{\partial {a}_{i}} = 0\left( {i = 1,2,\cdots , n}\right)$ 得到确定参数 ${a}_{1},{a}_{2},\cdots ,{a}_{n}$ 的 $n$ 个方程.

#### 19.5.3 有限元方法 (FEM)

在现代计算机出现后, 有限元方法成为求解偏微分方程的最重要的技术. 也容易说明这种强有力的方法产生的结果.

对于不同类型的应用, 有限元方法有很不相同的实施方式, 故这里仅介绍其基本思想. 它类似于数值求解常微分方程边值问题的里茨法 (参见第 1266 页 19.4.2.2), 也涉及样条插值 (参见第 1293 页 19.7).

有限元方法有如下步骤.

## 1. 定义变分问题

由已知边值问题形成变分问题. 以如下边值问题为例说明其过程:

在 $G$ 的内部 ${\Delta u} = {u}_{xx} + {u}_{yy} = f$ ,在 $G$ 的边界上 $u = 0$ .(19.144)

在微分方程 (19.144) 两边乘以在 $G$ 的边界为零的适当的光滑函数,并在整个区域 $G$ 上积分,得到

$$
{\iint }_{\left( G\right) }\left( {\frac{{\partial }^{2}u}{\partial {x}^{2}} + \frac{{\partial }^{2}u}{\partial {y}^{2}}}\right) v\mathrm{\;d}x\mathrm{\;d}y = {\iint }_{\left( G\right) }{fv}\mathrm{\;d}x\mathrm{\;d}y. \tag{19.145}
$$

应用高斯求积公式 (参见第 945 页 13.2.2.1,(2)),将 $P\left( {x, y}\right)  =  - v{u}_{y}, Q\left( {x, y}\right)  = v{u}_{x}$ 代入 (13.121), 从 (19.145) 得到变分方程

$$
a\left( {u, v}\right)  = b\left( v\right)  \tag{19.146a}
$$

其中

$$
a\left( {u, v}\right)  =  - {\iint }_{\left( G\right) }\left( {\frac{\partial u}{\partial x}\frac{\partial v}{\partial x} + \frac{\partial u}{\partial y}\frac{\partial v}{\partial y}}\right) \mathrm{d}x\mathrm{\;d}y,\;b\left( v\right)  = {\iint }_{\left( G\right) }{fv}\mathrm{\;d}x\mathrm{\;d}y. \tag{19.146b}
$$

## 2. 三角形剖分

将积分区域 $G$ 分解为简单的子区域,一般用三角形剖分,即区域 $G$ 被三角形覆盖, 且其中相邻的三角形或共有整条边, 或仅有一个公共顶点. 每个带曲线边界的区域可由三角形的联合很好地逼近 (图 19.7).

![01937d01-b6f6-7881-8294-3a9c82211946_39_531_694_577_487_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_39_531_694_577_487_0.jpg)

图 19.7

注 为避免数值上的困难, 三角形剖分中应该不包含钝角三角形.

单位正方形的三角形剖分见图 19.8. 从坐标为 ${x}_{\mu } = {\mu h},{y}_{\nu } = {\nu h}(\mu ,\nu  = 0,1$ , $2,\cdots , N;h = 1/N)$ 的网格剖分节点出发,有 ${\left( N - 1\right) }^{2}$ 个内节点. 考虑到选取解函数,常用以 $\left( {{x}_{\mu },{y}_{\nu }}\right)$ 为公共顶点的六个三角形组合成的面元 ${G}_{\mu \nu }$ (在其他的情况下, 三角形可能不是 6 个. 这些面元显然互不排斥).

![01937d01-b6f6-7881-8294-3a9c82211946_39_562_1573_515_470_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_39_562_1573_515_470_0.jpg)

图 19.8

## 3. 求解

对所求的函数 $u\left( {x, y}\right)$ 在每一个三角形上定义假设的近似解. 带相应假设解的三角形称为有限元. $x$ 和 $y$ 的多项式是最合适的选择. 在许多情况下,线性近似

$$
\widetilde{u}\left( {x, y}\right)  = {a}_{1} + {a}_{2}x + {a}_{3}y \tag{19.147}
$$

已经足够. 假设近似函数在相邻三角形间必须连续, 故最终的解也是连续的.

(19.147) 中的系数 ${a}_{1},{a}_{2},{a}_{3}$ 由在三角形顶点上的函数值 ${u}_{1},{u}_{2},{u}_{3}$ 唯一确定. 这同时保证了相邻三角形间的连续性. 假设解 (19.147) 包含了作为未知参数的要求函数的近似值 ${u}_{i}$ . 在整个区域 $G$ 上用来逼近要求的解 $u\left( {x, y}\right)$ 的假设解选为

$$
\widetilde{u}\left( {x, y}\right)  = \mathop{\sum }\limits_{{\mu  = 1}}^{{N - 1}}\mathop{\sum }\limits_{{\nu  = 1}}^{{N - 1}}{\alpha }_{\mu \nu }{u}_{\mu \nu }\left( {x, y}\right) . \tag{19.148}
$$

确定适当的系数 ${\alpha }_{\mu \nu }$ . 对函数 ${u}_{\mu \nu }\left( {x, y}\right)$ 必须成立: 根据 (19.147),它们在 ${G}_{\mu \nu }$ 的每一个三角形上是满足下面条件的线性函数:

(1)

$$
{u}_{\mu \nu }\left( {{x}_{k},{y}_{l}}\right)  = \left\{  \begin{array}{ll} 1, & k = \mu , l = \nu , \\  0, & \text{ 其他. } \end{array}\right.  \tag{19.149a}
$$

(2)

$$
{u}_{\mu \nu }\left( {x, y}\right)  \equiv  0\text{,对任意}\left( {x, y}\right)  \notin  {G}_{\mu \nu }\text{.} \tag{19.149b}
$$

${u}_{\mu \nu }\left( {x, y}\right)$ 在 ${G}_{\mu \nu }$ 上的图形表示见图 19.9. 在 ${G}_{\mu \nu }$ 上,即在图 19.8 中从 1 到 6 所有的三角形上,计算 ${u}_{\mu \nu }\left( {x, y}\right)$ . 这里仅说明三角形 1 上的计算:

$$
{u}_{\mu \nu }\left( {x, y}\right)  = {a}_{1} + {a}_{2}x + {a}_{3}, \tag{19.150}
$$

![01937d01-b6f6-7881-8294-3a9c82211946_40_480_1417_682_517_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_40_480_1417_682_517_0.jpg)

图 19.9

满足

$$
{u}_{\mu \nu }\left( {x, y}\right)  = \left\{  \begin{array}{ll} 1, & x = {x}_{\mu }, y = {y}_{v}, \\  0, & x = {x}_{\mu  - 1}, y = {y}_{v - 1}, \\  0, & x = {x}_{\mu }, y = {y}_{v - 1}. \end{array}\right.  \tag{19.151}
$$

由 (19.151) 得 ${a}_{1} = 1 - v,{a}_{2} = 0,{a}_{3} = 1/h$ ,随之对三角形 1 有

$$
{u}_{\mu \nu }\left( {x, y}\right)  = 1 + \left( {\frac{y}{h} - v}\right) . \tag{19.152}
$$

类似有

$$
{u}_{\mu \nu }\left( {x, y}\right)  = \left\{  \begin{array}{ll} 1 - \left( {\frac{x}{h} - \mu }\right)  + \left( {\frac{y}{h} - v}\right) , & \text{ 三角形 }2, \\  1 - \left( {\frac{x}{h} - \mu }\right) , & \text{ 三角形 }3, \\  1 - \left( {\frac{y}{h} - v}\right) , & \text{ 三角形 }4, \\  1 + \left( {\frac{x}{h} - \mu }\right)  + \left( {\frac{y}{h} - v}\right) , & \text{ 三角形 }5, \\  1 + \left( {\frac{x}{h} - \mu }\right) , & \text{ 三角形 }6. \end{array}\right.  \tag{19.153}
$$

## 4. 计算解的系数

解的系数 ${\alpha }_{\mu \nu }$ 由解 (19.148) 对每个解函数 ${u}_{\mu \nu }$ 都满足变分问题 (19.146a) 来确定,即在 (19.146a) 中用 $\widetilde{u}\left( {x, y}\right)$ 代替 $u\left( {x, y}\right)$ ,用 ${u}_{\mu \nu }\left( {x, y}\right)$ 代替 $v\left( {x, y}\right)$ . 于是得到关于未知系数的线性方程组

$$
\mathop{\sum }\limits_{{\mu  = 1}}^{{N - 1}}\mathop{\sum }\limits_{{\nu  = 1}}^{{N - 1}}{\alpha }_{\mu \nu }a\left( {{u}_{\mu \nu },{u}_{kl}}\right)  = b\left( {u}_{kl}\right) \;\left( {k, l = 1,2,\cdots , N - 1}\right) , \tag{19.154}
$$

其中

$$
a\left( {{u}_{\mu \nu },{u}_{kl}}\right)  = {\iint }_{{G}_{kl}}\left( {\frac{\partial {u}_{\mu \nu }}{\partial x}\frac{\partial {u}_{kl}}{\partial x} + \frac{\partial {u}_{\mu \nu }}{\partial y}\frac{\partial {u}_{kl}}{\partial y}}\right) \mathrm{d}x\mathrm{\;d}y,\;b\left( {u}_{kl}\right)  = {\iint }_{{G}_{kl}}f{u}_{kl}\mathrm{\;d}x\mathrm{\;d}y.
$$

(19.155)

在计算 $a\left( {{u}_{\mu \nu },{u}_{kl}}\right)$ 时,必须记住仅需计算区域 ${G}_{\mu \nu }$ 和 ${G}_{kl}$ 具有非空交集情况下的积分. 这些区域在表 19.1 中用阴影表示.

因总是在面积为 ${h}^{2}/2$ 的三角形区域上积分,故关于变量 $x$ 的偏导数为

$$
\frac{1}{{h}^{2}}\left( {4{\alpha }_{kl} - 2{\alpha }_{k + 1, l} - 2{\alpha }_{k - 1, l}}\right) \frac{{h}^{2}}{2}. \tag{19.156a}
$$

类似得到关于变量 $y$ 的偏导数

$$
\frac{1}{{h}^{2}}\left( {4{\alpha }_{kl} - 2{\alpha }_{k, l + 1} - 2{\alpha }_{k, l - 1}}\right) \frac{{h}^{2}}{2}. \tag{19.156b}
$$

计算 (19.154) 的右端项 $b\left( {u}_{kl}\right)$ 得

$$
b\left( {u}_{kl}\right)  = {\iint }_{{G}_{kl}}f\left( {x, y}\right) {u}_{kl}\left( {x, y}\right) \mathrm{d}x\mathrm{\;d}y \approx  {f}_{kl}{V}_{P}, \tag{19.157a}
$$

其中 ${V}_{P}$ 为由 ${u}_{kl}\left( {x, y}\right)$ 确定的 ${G}_{kl}$ 上高度为 1 的棱锥的体积 (图 19.9). 因为

$$
{V}_{P} = \frac{1}{3} \cdot  6 \cdot  \frac{1}{2}{h}^{2}\text{,故其近似值为}b\left( {u}_{kl}\right)  \approx  {f}_{kl}{h}^{2}\text{.} \tag{19.157b}
$$

于是变分方程 (19.154) 导致确定解系数的线性方程组

表 19.1 有限元法附表

<table><tr><td rowspan="2">面域</td><td rowspan="2">图示</td><td>三角形</td><td>$\frac{\partial {u}_{kl}}{\partial x}$</td><td>$\frac{\partial {u}_{\mu \nu }}{\partial x}$</td><td>$\sum \frac{\partial {u}_{kl}}{\partial x}\frac{\partial {u}_{\mu \nu }}{\partial x}$</td></tr><tr><td>${G}_{kl}\;{G}_{\mu \nu }$</td><td/><td/><td/></tr><tr><td rowspan="6">(1) $\begin{array}{l} \mu  = k \\  \nu  = l \end{array}$</td><td rowspan="6"> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=446&y=614&w=205&h=193"/> </td><td>$\begin{array}{ll} 1 & 1 \end{array}$</td><td>0</td><td>0</td><td rowspan="6">$\frac{4}{{h}^{2}}$</td></tr><tr><td>22</td><td>$- 1/h$</td><td>$- 1/h$</td></tr><tr><td>33</td><td>$- 1/h$</td><td>$- 1/h$</td></tr><tr><td>$\begin{array}{ll} 4 & 4 \end{array}$</td><td>0</td><td>0</td></tr><tr><td>55</td><td>$1/h$</td><td>$1/h$</td></tr><tr><td>6</td><td>$1/h$</td><td>$1/h$</td></tr><tr><td/><td/><td/><td/><td/><td rowspan="3">0</td></tr><tr><td>(2) $\begin{array}{l} \mu  = k \\  \nu  = l - 1 \end{array}$</td><td/><td>$\begin{array}{ll} 1 & 5 \\  2 & 4 \end{array}$</td><td>0</td><td>$1/h$</td></tr><tr><td>_____</td><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=447&y=829&w=200&h=175"/> </td><td/><td>$- 1/h$</td><td>0</td></tr><tr><td>(3) $\begin{array}{l} \mu  = k + 1 \\  \nu  = l \end{array}$</td><td/><td>$\begin{array}{ll} 2 & 6 \\  3 & 5 \end{array}$</td><td>$- 1/h$</td><td>$1/h$</td><td rowspan="2">$- \frac{2}{{h}^{2}}$</td></tr><tr><td/><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=448&y=1012&w=198&h=168"/> </td><td/><td>$- 1/h$</td><td>$1/h$</td></tr><tr><td/><td/><td/><td/><td/><td rowspan="3">0</td></tr><tr><td>(4) $\begin{array}{l} \mu  = k + 1 \\  \nu  = l + 1 \end{array}$</td><td/><td/><td>$- 1/h$</td><td>0</td></tr><tr><td/><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=448&y=1188&w=199&h=169"/> </td><td>$\begin{array}{ll} 3 & 1 \\  4 & 6 \end{array}$</td><td>0</td><td>$1/h$</td></tr><tr><td>(5) $\begin{array}{l} \mu  = k \\  \nu  = l + 1 \end{array}$</td><td/><td>$\begin{array}{ll} 4 & 2 \\  5 & 1 \end{array}$</td><td>0</td><td>$1/h$</td><td rowspan="2">0</td></tr><tr><td/><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=448&y=1363&w=199&h=172"/> </td><td/><td>$- 1/h$</td><td>0</td></tr><tr><td>(6) $\begin{array}{l} \mu  = k - 1 \\  \nu  = l \end{array}$</td><td/><td>$\begin{array}{ll} 5 & 3 \\  6 & 2 \end{array}$</td><td>$1/h$</td><td>$- 1/h$</td><td rowspan="2">$- \frac{2}{{h}^{2}}$</td></tr><tr><td/><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=448&y=1541&w=199&h=168"/> </td><td/><td>$1/h$</td><td>$- 1/h$</td></tr><tr><td/><td/><td/><td/><td/><td rowspan="3">0</td></tr><tr><td/><td/><td/><td>$1/h$</td><td>0</td></tr><tr><td>(7) $\begin{array}{l} \mu  = k - 1 \\  \nu  = l - 1 \end{array}$</td><td> <img src="https://cdn.noedgeai.com/01937d01-b6f6-7881-8294-3a9c82211946_42.jpg?x=447&y=1718&w=201&h=172"/> </td><td>$\begin{array}{ll} 6 & 4 \\  1 & 3 \end{array}$</td><td>0</td><td>$- 1/h$</td></tr></table>

---

$$
4{\alpha }_{kl} - {\alpha }_{k + 1, l} - {\alpha }_{k - 1, l} - {\alpha }_{k, l + 1} - {\alpha }_{k, l - 1} = {h}^{2}{f}_{kl}\;\left( {k, l = 1,2,\cdots , N - 1}\right) .\left( {19.158}\right)
$$

---

(19.158)

注 (1) 若解的系数可由 (19.158) 确定,则由 (19.148) 得到的 $\widetilde{u}\left( {x, y}\right)$ 表示其显式近似解,可对 $G$ 上任意点计算其值.

(2)若积分区域必须被不规则的三角形网格覆盖, 则要引入三角形坐标 (也称重心坐标). 这样容易确定点关于三角形网格的位置, 又因为每个三角形容易变换为以 $\left( {0,0}\right) ,\left( {0,1}\right) ,\left( {1,0}\right)$ 为顶点的单位三角形,从而使得 (19.155) 中多重积分的计算更容易.

(3) 若需要改善解的精度或可微性, 则必须应用分片二次或三次函数以得到假设的近似 (见 [19.28]).

(4) 在实际应用中, 通常得到高维的线性方程组. 这正是发展许多特殊方法的原因, 例如, 方程组的结构依赖于三角形网格的自动剖分和单元的实际列举. 关于有限元方法的详细介绍见 [19.21], [19.13], [19.28].

### 19.6 插值、调整计算、调和分析

#### 19.6.1 多项式插值

插值的基本问题是通过一系列点 $\left( {{x}_{v},{y}_{v}}\right) \left( {v = 0,1,\cdots , n}\right)$ 来拟合曲线. 它可以通过曲线拟合小段图示,或通过在所谓插值点 ${x}_{v}$ 取 ${y}_{v}$ 值的函数 $g\left( x\right)$ 数值化,即 $g\left( x\right)$ 满足插值条件

$$
g\left( {x}_{\nu }\right)  = {y}_{\nu }\;\left( {\nu  = 0,1,2,\cdots , n}\right) . \tag{19.159}
$$

插值函数最早用多项式, 对周期函数或用所谓三角多项式. 后一种情况为三角插值 (参见第 1287 页 19.6.4.1,2.). 有 $n + 1$ 个插值点,插值阶为 $n$ ,则插值多项式的最高阶至多为 $n$ . 因为随着次数增加,多项式可能产生强烈的振荡,故通常不需要高阶插值. 插值区间能划分为子区间进行样条插值 (参见第 1293 页 19.7).

##### 19.6.1.1 牛顿插值公式

为解插值问题 (19.159),考虑如下形式的 $n$ 次多项式

$$
g\left( x\right)  = {p}_{n}\left( x\right)  = {a}_{0} + {a}_{1}\left( {x - {x}_{0}}\right)  + {a}_{2}\left( {x - {x}_{0}}\right) \left( {x - {x}_{1}}\right)  + \cdots
$$

$$
+ {a}_{n}\left( {x - {x}_{0}}\right) \left( {x - {x}_{1}}\right) \cdots \left( {x - {x}_{n - 1}}\right) . \tag{19.160}
$$

这称为牛顿插值公式, 因为插值条件 (19.159) 导致三角矩阵的线性方程组, 故容易计算系数 ${a}_{i}\left( {i = 0,1,\cdots , n}\right)$ .

1 对于 $n = 2$ ,由 (19.159) 得到附加的方程组. 插值多项式 ${p}_{n}\left( x\right)$ 由插值条件 (19.159) 唯一确定.

$$
{p}_{2}\left( {x}_{0}\right)  = {a}_{0} = {y}_{0},
$$

$$
{p}_{2}\left( {x}_{1}\right)  = {a}_{0} + {a}_{1}\left( {{x}_{1} - {x}_{0}}\right)  = {y}_{1},
$$

$$
{p}_{2}\left( {x}_{2}\right)  = {a}_{0} + {a}_{1}\left( {{x}_{1} - {x}_{0}}\right)  + {a}_{2}\left( {{x}_{1} - {x}_{0}}\right) \left( {{x}_{2} - {x}_{1}}\right)  = {y}_{2}.
$$

函数值的计算可以由霍纳格式 (参见第 1237 页 19.1.2.1) 简化.

##### 19.6.1.2 拉格朗日插值公式

$n$ 次多项式可以用 $n + 1$ 个点 $\left( {{x}_{v},{y}_{v}}\right) \left( {v = 0,1,\cdots , n}\right)$ 的拉格朗日公式来拟合:

$$
g\left( x\right)  = {p}_{n}\left( x\right)  = \mathop{\sum }\limits_{{\mu  = 0}}^{n}{y}_{\mu }{L}_{\mu }\left( x\right) . \tag{19.161}
$$

这里 ${L}_{\mu }\left( {x}_{v}\right) \left( {v = 0,1,\cdots , n}\right)$ 为拉格朗日插值多项式. 方程 (19.161) 满足插值条件 (19.159), 因为

$$
{L}_{\mu }\left( {x}_{v}\right)  = {\delta }_{\mu v} = \left\{  \begin{array}{ll} 1, & \mu  = \nu , \\  0, & \mu  \neq  \nu , \end{array}\right.  \tag{19.162}
$$

其中 ${\delta }_{\mu \nu }$ 为克罗内克 (Kronecker) 记号. 拉格朗日插值多项式定义为

$$
{L}_{\mu } = \frac{\left( {x - {x}_{0}}\right) \left( {x - {x}_{1}}\right) \cdots \left( {x - {x}_{\mu  - 1}}\right) \left( {x - {x}_{\mu  + 1}}\right) \cdots \left( {x - {x}_{n}}\right) }{\left( {{x}_{\mu } - {x}_{0}}\right) \left( {{x}_{\mu } - {x}_{1}}\right) \cdots \left( {{x}_{\mu } - {x}_{\mu  - 1}}\right) \left( {{x}_{\mu } - {x}_{\mu  + 1}}\right) \cdots \left( {{x}_{\mu } - {x}_{n}}\right) }
$$

$$
= \mathop{\prod }\limits_{\substack{{\nu  = 0} \\  {\nu  \neq  \mu } }}^{n}\frac{x - {x}_{\nu }}{{x}_{\mu } - {x}_{\nu }} \tag{19.163}
$$

- 由下表中给出的点来拟合多项式.

![01937d01-b6f6-7881-8294-3a9c82211946_44_693_1132_254_133_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_44_693_1132_254_133_0.jpg)

利用拉格朗日插值多项式 (19.161):

$$
{L}_{0}\left( x\right)  = \frac{\left( {x - 1}\right) \left( {x - 3}\right) }{\left( {0 - 1}\right) \left( {0 - 3}\right) } = \frac{1}{3}\left( {x - 1}\right) \left( {x - 3}\right) ,
$$

$$
{L}_{1}\left( x\right)  = \frac{\left( {x - 0}\right) \left( {x - 3}\right) }{\left( {1 - 0}\right) \left( {1 - 3}\right) } =  - \frac{1}{2}x\left( {x - 3}\right) ,
$$

$$
{L}_{2}\left( x\right)  = \frac{\left( {x - 0}\right) \left( {x - 1}\right) }{\left( {3 - 0}\right) \left( {3 - 1}\right) } = \frac{1}{6}x\left( {x - 1}\right) ;
$$

$$
{p}_{2}\left( x\right)  = 1 \cdot  {L}_{0}\left( x\right)  + 3 \cdot  {L}_{1}\left( x\right)  + 2 \cdot  {L}_{2}\left( x\right)  =  - \frac{5}{6}{x}^{2} + \frac{17}{6}x + 1.
$$

拉格朗日插值多项式显式且线性依赖于函数值 ${y}_{\mu }$ . 这在理论上是重要的 (例如参见第 1262 页 19.4.1.3,3. 亚当斯-巴什福斯法则). 但在实际计算中, 拉格朗日插值公式并不常用.

##### 19.6.1.3 艾特肯-内维尔插值

在许多实际情况中,我们并不需要多项式 ${p}_{n}\left( x\right)$ 的显形式,只需要插值区域内给定点 $x$ 处的值就可以. 这些函数值可以由艾特肯 (Aitken) 和内维尔 (Neville) 发展的递推方法得到. 记号

$$
{p}_{n}\left( x\right)  = {p}_{0,1,\cdots , n}\left( x\right)  \tag{19.164}
$$

表示以 ${x}_{0},{x}_{1},\cdots ,{x}_{n}$ 为插值点的 $n$ 次多项式. 注意到

$$
{p}_{0,1,\cdots , n}\left( x\right)  = \frac{\left( {x - {x}_{0}}\right) {p}_{1,2,\cdots , n}\left( x\right)  - \left( {x - {x}_{n}}\right) {p}_{0,1,2,\cdots , n - 1}\left( x\right) }{{x}_{n} - {x}_{0}}, \tag{19.165}
$$

即函数值 ${p}_{0,1,\cdots , n}\left( x\right)$ 可由两个次数低于 $n - 1$ 的多项式 ${p}_{1,2,\cdots , n}\left( x\right)$ 和 ${p}_{0,1,\cdots , n - 1}\left( x\right)$ 的线性组合得到. 应用 (19.165),对于 $n = 4$ 的情况有

$$
\begin{array}{l} {x}_{0} \mid  {y}_{0} = {p}_{0} \\  {x}_{1} \mid  {y}_{1} = {p}_{1}\;{p}_{01} \\  {x}_{2} \mid  {y}_{2} = {p}_{2}\;{p}_{12}\;{p}_{012} \\  {x}_{3} \mid  {y}_{3} = {p}_{3}\;{p}_{23}\;{p}_{123}\;{p}_{0123} \\  {x}_{4} \mid  {y}_{4} = {p}_{4}\;{p}_{34}\;{p}_{234}\;{p}_{11234}\;{p}_{01234}\;{p}_{01234} = {p}_{4}\left( x\right) . \end{array} \tag{19.166}
$$

逐列计算 (19.166) 的元素. 格式中的新值由其左边及左上的数值得到.

$$
{p}_{23} = \frac{\left( {x - {x}_{2}}\right) {p}_{3} - \left( {x - {x}_{3}}\right) {p}_{2}}{{x}_{3} - {x}_{2}} = {p}_{3} + \frac{x - {x}_{3}}{{x}_{3} - {x}_{2}}\left( {{p}_{3} - {p}_{2}}\right) , \tag{19.167a}
$$

$$
{p}_{123} = \frac{\left( {x - {x}_{1}}\right) {p}_{23} - \left( {x - {x}_{3}}\right) {p}_{12}}{{x}_{3} - {x}_{1}} = {p}_{23} + \frac{x - {x}_{3}}{{x}_{3} - {x}_{1}}\left( {{p}_{23} - {p}_{12}}\right) , \tag{19.167b}
$$

$$
{p}_{1234} = \frac{\left( {x - {x}_{1}}\right) {p}_{234} - \left( {x - {x}_{4}}\right) {p}_{123}}{{x}_{4} - {x}_{1}} = {p}_{234} + \frac{x - {x}_{4}}{{x}_{4} - {x}_{1}}\left( {{p}_{234} - {p}_{123}}\right) . \tag{19.167c}
$$

为在计算机上实施艾特肯-内维尔 (Aitken-Neville) 算法,只需引进有 $n + 1$ 个分量的向量 $\underline{p}$ (见 [19.7]),根据规则依次取 (19.166) 中的列值,第 $k$ 列的值 ${p}_{i - k, i - k + 1,\cdots , i}$ $\left( {i = k, k + 1,\cdots , n}\right)$ 正是 $\underline{p}$ 的第 $i$ 个分量 ${p}_{i}$ . 由于必须向下计算 (19.166) 的列, 故 $\underline{p}$ 包含所有必要的数值. 算法有如下两步:

(1) 对 $i = 0,1,\cdots , n$ ,设 ${p}_{i} = {y}_{i}$ .(19.168a)

(2) 对 $k = 1,2,\cdots , n$ 及 $i = n, n - 1,\cdots , k$ ,计算 ${p}_{i} = {p}_{i} + \frac{x - {x}_{i}}{{x}_{i} - {x}_{i - k}}\left( {{p}_{i} - {p}_{i - 1}}\right)$ .(19.168b)

在结束 (19.168b) 的计算后,我们得到元素 ${p}_{n}$ 在点 $x$ 处要求的函数值 ${p}_{n}\left( x\right)$ .

#### 19.6.2 平均逼近

平均逼近的原理是高斯最小二乘法. 在计算中, 区别连续与离散两种情况.

##### 19.6.2.1 连续问题、正规方程

函数 $f\left( x\right)$ 被区间 $\left\lbrack  {a, b}\right\rbrack$ 上的函数 $g\left( x\right)$ 近似,使得依赖于 $g\left( x\right)$ 所包含的参数的表达式

$$
F = {\int }_{a}^{b}\omega \left( x\right) {\left\lbrack  f\left( x\right)  - g\left( x\right) \right\rbrack  }^{2}\mathrm{\;d}x \tag{19.169}
$$

取极小值. $\omega \left( x\right)$ 表示给定的权函数,且在积分区间上 $\omega \left( x\right)  > 0$ .

设最佳逼近 $g\left( x\right)$ 有如下形式:

$$
g\left( x\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( x\right) , \tag{19.170}
$$

其中函数 ${g}_{0}\left( x\right) ,{g}_{1}\left( x\right) ,\cdots ,{g}_{n}\left( x\right)$ 线性无关,则 (19.169) 取极值的必要条件为

$$
\frac{\partial F}{\partial {a}_{i}} = 0\;\left( {i = 0,1,\cdots , n}\right) . \tag{19.171}
$$

由此得到所谓正规方程组

$$
\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}\left( {{g}_{i},{g}_{k}}\right)  = \left( {f,{g}_{k}}\right) \;\left( {k = 0,1,\cdots , n}\right)  \tag{19.172}
$$

以确定未知系数 ${a}_{i}$ . 这里记号

$$
\left( {{g}_{i},{g}_{k}}\right)  = {\int }_{a}^{b}\omega \left( x\right) {g}_{i}\left( x\right) {g}_{k}\left( x\right) \mathrm{d}x, \tag{19.173a}
$$

$$
\left( {f,{g}_{k}}\right)  = {\int }_{a}^{b}\omega \left( x\right) f\left( x\right) {g}_{k}\left( x\right) \mathrm{d}x\;\left( {i, k = 0,1,\cdots , n}\right)  \tag{19.173b}
$$

看作两个指示函数的内积.

因为函数 ${g}_{0}\left( x\right) ,{g}_{1}\left( x\right) ,\cdots ,{g}_{n}\left( x\right)$ 线性无关,故正规方程组有唯一解. 方程组 (19.172) 的系数矩阵是对称的, 故可用楚列斯基方法 (参见第 1245 页 19.2.1.2). 若函数组 ${g}_{i}\left( x\right)$ 是正交的,即若

$$
\left( {{g}_{i},{g}_{k}}\right)  = 0,\;i \neq  k, \tag{19.174}
$$

则不用求解方程组就可直接确定系数 ${a}_{i}$ . 若

$$
\left( {{g}_{i},{g}_{k}}\right)  = \left\{  {\begin{array}{ll} 0, & i \neq  k, \\  1, & i = k \end{array}\;\left( {i, k = 0,1,\cdots , n}\right) ,}\right.  \tag{19.175}
$$

称方程组为正交的. 满足 (19.175) 的正规方程 (19.172) 简化为

$$
{a}_{i} = \left( {f,{g}_{i}}\right) \;\left( {i = 0,1,\cdots , n}\right) . \tag{19.176}
$$

线性无关函数组可以正交化. 依赖于权函数和积分区间,从幂函数 ${g}_{i}\left( x\right)  = {x}^{i}(i =$ $0,1,\cdots , n)$ 得到表 19.2 中的正交多项式.(19.177)

表 19.2 正交多项式

<table><tr><td>$\left\lbrack  {a, b}\right\rbrack$</td><td>$\omega \left( x\right)$</td><td>多项式名称</td><td>见页码</td></tr><tr><td>$\left\lbrack  {-1,1}\right\rbrack$</td><td>1</td><td>勒让德多项式 ${P}_{n}\left( x\right)$</td><td>566</td></tr><tr><td>$\left\lbrack  {-1,1}\right\rbrack$</td><td>$\frac{1}{\sqrt{1 - {x}^{2}}}$</td><td>切比雪夫多项式 ${T}_{n}\left( x\right)$</td><td>989</td></tr><tr><td>$\lbrack 0,\infty )$</td><td>${\mathrm{e}}^{-x}$</td><td>拉盖尔多项式 ${L}_{n}\left( x\right)$</td><td>568</td></tr><tr><td>$\left( {-\infty ,\infty }\right)$</td><td>${\mathrm{e}}^{-{x}^{2}/2}$</td><td>埃尔米特多项式 ${H}_{n}\left( x\right)$</td><td>568</td></tr></table>

这些多项式可在任意区间上应用.

(1) 有限近似区间.

(2)一端无限的近似区间, 如在依赖于时间的问题中.

(3) 两端都是无限的近似区间, 如在流问题中.

每个有限区间 $\left\lbrack  {a, b}\right\rbrack$ 可通过变换

$$
x = \frac{b + a}{2} + \frac{b - a}{2}t\;\left( {x \in  \left\lbrack  {a, b}\right\rbrack  , t \in  \left\lbrack  {-1,1}\right\rbrack  }\right)  \tag{19.178}
$$

化为区间 $\left\lbrack  {-1,1}\right\rbrack$ .

##### 19.6.2.2 离散问题、正规方程、豪斯霍尔德方法

设 $\left( {{x}_{v},{y}_{v}}\right)$ 为 $N$ 对给定的测量值. 为了确定函数 $g\left( x\right)$ ,使其值 $g\left( {x}_{v}\right)$ 与给定值 ${y}_{v}$ 之差的平方表达式

$$
F = \mathop{\sum }\limits_{{\nu  = 1}}^{N}{\left\lbrack  {y}_{\nu } - g\left( {x}_{\nu }\right) \right\rbrack  }^{2} \tag{19.179}
$$

为极小. $F$ 的值依赖于包含在函数 $g\left( x\right)$ 中的参数. 公式 (19.179) 表示经典的残量平方和. 残量平方和的极小化称为最小二乘法. 从假设 (19.170) 和 (19.179) 对系数极小化的必要条件 $\frac{\partial F}{\partial {a}_{i}} = 0\left( {i = 0,1,\cdots , n}\right)$ ,得到正规方程:

$$
\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}\left\lbrack  {{g}_{i}{g}_{k}}\right\rbrack   = \left\lbrack  {y{g}_{k}}\right\rbrack  \;\left( {k = 0,1,\cdots , n}\right) . \tag{19.180}
$$

在下面的记号中用到高斯求和符号:

$$
\left\lbrack  {{g}_{i}{g}_{k}}\right\rbrack   = \mathop{\sum }\limits_{{\nu  = 1}}^{N}{g}_{i}\left( {x}_{\nu }\right) {g}_{k}\left( {x}_{\nu }\right) , \tag{19.181a}
$$

$$
\left\lbrack  {y{g}_{k}}\right\rbrack   = \mathop{\sum }\limits_{{\nu  = 1}}^{N}{y}_{\nu }{g}_{k}\left( {x}_{\nu }\right) \;\left( {i, k = 0,1,\cdots , n}\right) . \tag{19.181b}
$$

通常 $n \ll  N$ .

- 对多项式 $g\left( x\right)  = {a}_{0} + {a}_{1}x + \cdots  + {a}_{n}{x}^{n}$ ,正规方程为 ${a}_{0}\left\lbrack  {x}^{k}\right\rbrack   + {a}_{1}\left\lbrack  {x}^{k + 1}\right\rbrack   +$ $\cdots  + {a}_{n}\left\lbrack  {x}^{k + n}\right\rbrack   = \left\lbrack  {{x}^{k}y}\right\rbrack  \left( {k = 0,1,\cdots , n}\right)$ ,其中 $\left\lbrack  {x}^{k}\right\rbrack   = \mathop{\sum }\limits_{{v = 1}}^{N}{x}_{v}^{k},\left\lbrack  {x}^{0}\right\rbrack   = N,\left\lbrack  {{x}^{k}y}\right\rbrack   =$ $\mathop{\sum }\limits_{{v = 1}}^{N}{x}_{v}^{k}{y}_{v},\left\lbrack  y\right\rbrack   = \mathop{\sum }\limits_{{v = 1}}^{N}{y}_{v}$ . 正规方程 (19.180) 的系数矩阵是对称的,可以用楚列斯基方法数值求解.

正规方程 (19.180) 和残量平方和 (19.179) 有如下紧形式:

$$
{\mathbf{G}}^{\mathrm{T}}\mathbf{G}\underline{\mathbf{a}} = {\mathbf{G}}^{\mathrm{T}}\underline{\mathbf{y}},\;F = {\left( \underline{\mathbf{y}} - \mathbf{G}\underline{\mathbf{a}}\right) }^{\mathrm{T}}\left( {\underline{\mathbf{y}} - \mathbf{G}\underline{\mathbf{a}}}\right) , \tag{19.182a}
$$

其中

$$
\mathbf{G} = \left( \begin{matrix} {g}_{0}\left( {x}_{1}\right) & {g}_{1}\left( {x}_{1}\right) & {g}_{2}\left( {x}_{1}\right) & \cdots & {g}_{n}\left( {x}_{1}\right) \\  {g}_{0}\left( {x}_{2}\right) & {g}_{1}\left( {x}_{2}\right) & {g}_{2}\left( {x}_{2}\right) & \cdots & {g}_{n}\left( {x}_{2}\right) \\  {g}_{0}\left( {x}_{3}\right) & {g}_{1}\left( {x}_{3}\right) & {g}_{2}\left( {x}_{3}\right) & \cdots & {g}_{n}\left( {x}_{3}\right) \\  \vdots & \vdots & \vdots & & \vdots \\  {g}_{0}\left( {x}_{N}\right) & {g}_{1}\left( {x}_{N}\right) & {g}_{2}\left( {x}_{N}\right) & \cdots & {g}_{n}\left( {x}_{N}\right)  \end{matrix}\right) ,
$$

$$
\underline{\mathbf{y}} = \left( \begin{matrix} {y}_{1} \\  {y}_{2} \\  {y}_{3} \\  \vdots \\  {y}_{N} \end{matrix}\right) ,\;\underline{\mathbf{a}} = \left( \begin{matrix} {a}_{0} \\  {a}_{1} \\  {a}_{2} \\  \vdots \\  {a}_{m} \end{matrix}\right) . \tag{19.182b}
$$

若以求解 $N$ 点 $\left( {{x}_{\nu },{y}_{\nu }}\right)$ 的插值问题,代替求解残量和的极小化,则需求解如下方程组:

$$
G\underline{a} = \underline{y}. \tag{19.183}
$$

若 $n < N - 1$ ,则方程组超定,通常无任何解. 方程组 (19.180) 或 (19.182a) 可由 (19.183) 乘以 ${\mathbf{G}}^{\mathrm{T}}$ 得到.

从数值角度看, 推荐用豪斯霍尔德方法 (参见第 420 页 4.5.3.2, 2.) 解方程 (19.183), 其解导致极小的残量平方和 (19.179).

##### 19.6.2.3 多维问题

## 1. 调整计算

设函数 $f\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)$ 有 $n$ 个独立变量 ${x}_{1},{x}_{2},\cdots ,{x}_{n}$ . 其显形式未知,仅给出 $N$ 个通常为测量值的代入值 ${f}_{\nu }$ . 这些数值记在下表中 (见 (19.184)).(19.184)

![01937d01-b6f6-7881-8294-3a9c82211946_48_613_1597_415_335_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_48_613_1597_415_335_0.jpg)

通过引进下列向量可更清晰地给出调整问题:

$\underline{\mathbf{x}} = {\left( {x}_{1},{x}_{2},\cdots ,{x}_{n}\right) }^{\mathrm{T}}$ : 有 $n$ 个独立变量的向量,

${\underline{x}}^{\left( \nu \right) } = {\left( {x}_{1}^{\left( \nu \right) },{x}_{2}^{\left( \nu \right) },\cdots ,{x}_{n}^{\left( \nu \right) }\right) }^{\mathrm{T}}$ : 第 $\nu$ 个插值点的向量 $\left( {\nu  = 1,\cdots , N}\right)$ ,

$\underline{f} = {\left( {f}_{1},{f}_{2},\cdots ,{f}_{N}\right) }^{\mathrm{T}}$ : 在 $N$ 个插值点的 $N$ 个函数值向量.

$f\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = f\left( \underline{\mathbf{x}}\right)$ 由形如

$$
g\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = \mathop{\sum }\limits_{{i = 0}}^{m}{a}_{i}{g}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  \tag{19.185}
$$

的函数近似. 这里 ${g}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = {g}_{i}\left( \underline{x}\right)$ 是 $m + 1$ 个适当选取的函数.

$\blacksquare \mathbf{A}$: $n$ 变量的线性近似 ${g}_{i}\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  = {a}_{0} + {a}_{1}{x}_{1} + {a}_{2}{x}_{2} + \cdots  + {a}_{n}{x}_{n}$ .

$\blacksquare \mathbf{B}$: 三变量的完全二次近似

$$
g\left( {{x}_{1},{x}_{2},{x}_{3}}\right)  = {a}_{0} + {a}_{1}{x}_{1} + {a}_{2}{x}_{2} + {a}_{3}{x}_{3} + {a}_{4}{x}_{1}^{2} + {a}_{5}{x}_{2}^{2}
$$

$$
+ {a}_{6}{x}_{3}^{2} + {a}_{7}{x}_{1}{x}_{2} + {a}_{8}{x}_{1}{x}_{3} + {a}_{9}{x}_{2}{x}_{3}.
$$

系数由极小化 $\mathop{\sum }\limits_{{\nu  = 1}}^{N}{\left\lbrack  {f}_{\nu } - g\left( {x}_{1}^{\left( c\right) },{x}_{2}^{\left( c\right) },\cdots ,{x}_{n}^{\left( c\right) }\right) \right\rbrack  }^{2}$ 选定.

## 2. 正规方程组

把插值点 ${x}_{\nu }$ 换为向量插值点 ${\underline{x}}^{\left( \nu \right) }\left( {\nu  = 1,2,\cdots , N}\right)$ ,类似于(19.182b)构造矩阵 $\mathbf{G}$ . 为确定系数,可以用正规方程组

$$
{\mathbf{G}}^{\mathrm{T}}\mathbf{G}\underline{\mathbf{a}} = {\mathbf{G}}^{\mathrm{T}}\underline{\mathbf{f}} \tag{19.186}
$$

或超定的方程组

$$
G\underline{a} = \underline{f}. \tag{19.187}
$$

■ 对于多维回归的例子参见第 1099 页 16.3.4.3,3.

##### 19.6.2.4 非线性最小二乘问题

对一维离散问题讨论其主要思想. 近似函数 $g\left( x\right)$ 非线性依赖于某些参数.

$\blacksquare \mathbf{A}$: $g\left( x\right)  = {a}_{0}{\mathrm{e}}^{{a}_{1}x} + {a}_{2}{\mathrm{e}}^{{a}_{3}x}$ ,该表达式并非线性依赖于参数 ${a}_{1},{a}_{3}$ .

$\blacksquare \mathbf{B}$: $g\left( x\right)  = {a}_{0}{\mathrm{e}}^{{a}_{1}x} + \cos {a}_{2}x$ ,该函数并非线性依赖于参数 ${a}_{1},{a}_{2}$ .

记号

$$
g = g\left( {x,\underline{\mathbf{a}}}\right)  = g\left( {x;{a}_{0},{a}_{1},\cdots ,{a}_{n}}\right)  \tag{19.188}
$$

指出了近似函数 $g\left( x\right)$ 依赖于参数向量 $\underline{\mathbf{a}} = {\left( {a}_{0},{a}_{1},\cdots ,{a}_{n}\right) }^{\mathrm{T}}$ 的事实. 假设给定 $N$ 对数值 $\left( {{x}_{\nu },{y}_{\nu }}\right) \left( {\nu  = 1,2,\cdots , N}\right)$ . 极小化残量平方和

$$
\mathop{\sum }\limits_{{\nu  = 1}}^{N}{\left\lbrack  {y}_{\nu } - g\left( {x}_{\nu };{a}_{0},{a}_{1},\cdots ,{a}_{n}\right) \right\rbrack  }^{2} = F\left( {{a}_{0},{a}_{1},\cdots ,{a}_{n}}\right) , \tag{19.189}
$$

由必要条件 $\frac{\partial F}{\partial {a}_{i}} = 0\left( {i = 0,1,\cdots , n}\right)$ 得到非线性正规方程组,必须用迭代法,例如牛顿法 (参见第 1250 页 19.2.2.2) 求解.

在实际问题中常用的求解此问题的另一途径是为解非线性最小二乘问题 (19.24) 而给出的高斯-牛顿法 (参见第 1251 页 19.2.2.3). 下面的步骤用来解非线性逼近问题 (19.189):

(1) 借助关于 ${a}_{i}$ 的泰勒公式线性化近似函数 $g\left( {x,\underline{\mathbf{a}}}\right)$ . 为此,需要近似值 ${a}_{i}^{\left( 0\right) }$ $\left( {i = 0,1,\cdots , n}\right)$ :

$$
g\left( {x,\underline{\mathbf{a}}}\right)  \approx  \widetilde{g}\left( {x,\underline{\mathbf{a}}}\right)  = g\left( {x,{\underline{\mathbf{a}}}^{\left( 0\right) }}\right)  + \mathop{\sum }\limits_{{i = 0}}^{n}\frac{\partial g}{\partial {a}_{i}}\left( {x,{\underline{\mathbf{a}}}^{\left( 0\right) }}\right) \left( {{a}_{i} - {a}_{i}^{\left( 0\right) }}\right) . \tag{19.190}
$$

(2) 借助正规方程组

$$
{\widetilde{\mathbf{G}}}^{\mathrm{T}}\widetilde{\mathbf{G}}\underline{\Delta a} = {\widetilde{\mathbf{G}}}^{\mathrm{T}}\underline{\Delta y} \tag{19.191}
$$

或豪斯霍尔德方法, 求解线性极小化问题

$$
\mathop{\sum }\limits_{{\nu  = 1}}^{N}{\left\lbrack  {y}_{\nu } - \widetilde{g}\left( {x}_{\nu },\underline{\mathbf{a}}\right) \right\rbrack  }^{2} = \min ! \tag{19.192}
$$

在 (19.191) 中向量 $\underline{a}$ 和 $\underline{y}$ 的分量由下式给出:

$$
\Delta {a}_{i} = {a}_{i} - {a}_{i}^{\left( 0\right) }\;\left( {i = 0,1,2,\cdots , n}\right) , \tag{19.193a}
$$

$$
\Delta {y}_{\nu } = {y}_{\nu } - g\left( {{x}_{\nu },{\underline{\mathbf{a}}}^{\left( 0\right) }}\right) \;\left( {\nu  = 1,2,\cdots , N}\right) . \tag{19.193b}
$$

可类似于 (19.182b) 中的 $\mathbf{G}$ 确定矩阵 $\widetilde{\mathbf{G}}$ ,其中 ${g}_{i}\left( {x}_{v}\right)$ 换为

$$
\frac{\partial g}{\partial {a}_{i}}\left( {{x}_{\nu },{\underline{\mathbf{a}}}^{\left( 0\right) }}\right) \;\left( {i = 0,1,\cdots , n;\nu  = 1,2,\cdots , N}\right) .
$$

(3) 计算新的近似

$$
{a}_{i}^{\left( 1\right) } = {a}_{i}^{\left( 0\right) } + \Delta {a}_{i}\text{ 或 }{a}_{i}^{\left( 1\right) } = {a}_{i}^{\left( 0\right) } + {\gamma \Delta }{a}_{i}\;\left( {i = 0,1,2,\cdots , n}\right) , \tag{19.194}
$$

其中 $\gamma  > 0$ 为步长参数.

用 ${a}_{i}^{\left( 1\right) }$ 代替 ${a}_{i}^{\left( 0\right) }$ 重复步骤 2 和步骤 3,等等,得到要求参数的一列近似值,其收敛性强烈依赖于初始近似的精度. 残量的平方和的值可由引入乘子 $\gamma$ 得到.

#### 19.6.3 切比雪夫逼近

##### 19.6.3.1 问题的定义和交替点定理

## 1. 切比雪夫逼近原理

连续情况的切比雪夫逼近或一致逼近如下: 函数 $f\left( x\right)$ 在区间 $\left\lbrack  {a, b}\right\rbrack$ 内被函数 $g\left( x\right)  = g\left( {x;{a}_{0},{a}_{1},\cdots ,{a}_{n}}\right)$ 逼近,使得由

$$
\mathop{\max }\limits_{{a \leq  x \leq  b}}\left| {f\left( x\right)  - g\left( {x;{a}_{0},{a}_{1},\cdots ,{a}_{n}}\right) }\right|  = \Phi \left( {{a}_{0},{a}_{1},\cdots ,{a}_{n}}\right)  \tag{19.195}
$$

定义的误差对于适当选取的参数 ${a}_{i}\left( {i = 0,1,\cdots , n}\right)$ 尽可能小. 如果 $f\left( x\right)$ 存在这样的近似函数,则误差的绝对值至少在区间的 $n + 2$ 点 ${x}_{\nu }$ 上取得极大,在这些所谓的交替点误差变号 (图 19.10). 这正是交替点定理对于切比雪夫多项式逼近问题的解的特征化的含义.

![01937d01-b6f6-7881-8294-3a9c82211946_51_229_219_1182_357_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_51_229_219_1182_357_0.jpg)

图 19.10

若函数 $f\left( x\right)  = {x}^{n}$ 在区间 $\left\lbrack  {-1,1}\right\rbrack$ 上在切比雪夫意义下被次数 $\leq  n - 1$ 的多项式近似,则切比雪夫多项式 ${T}_{n}\left( x\right)$ 可作为最大模为 1 的误差函数. 位于区间端点和区间内 $n - 1$ 个点的交替点恰好相应于 ${T}_{n}\left( x\right)$ 的极值点 (图 19.11(a) $\sim$ (f)).

![01937d01-b6f6-7881-8294-3a9c82211946_51_196_858_1248_923_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_51_196_858_1248_923_0.jpg)

图 19.11

##### 19.6.3.2 切比雪夫多项式的性质

1. 表达式

$$
{T}_{n}\left( x\right)  = \cos \left( {n\arccos x}\right) , \tag{19.196a}
$$

$$
{T}_{n}\left( x\right)  = \frac{1}{2}\left\lbrack  {{\left( x + \sqrt{{x}^{2} - 1}\right) }^{n} + {\left( x - \sqrt{{x}^{2} - 1}\right) }^{n}}\right\rbrack  , \tag{19.196b}
$$

$$
{T}_{n}\left( x\right)  = \left\{  {\begin{array}{lll} \cos {nt}, & x = \cos t, & \left| x\right|  < 1, \\  \cosh {nt}, & x = \cosh t, & \left| x\right|  > 1 \end{array}\;\left( {n = 1,2,\cdots }\right) .}\right.  \tag{19.196c}
$$

2. ${T}_{n}\left( x\right)$ 的根

$$
{x}_{\mu } = \cos \frac{\left( {{2\mu } - 1}\right) \pi }{2n}\;\left( {\mu  = 1,2,\cdots , n}\right) . \tag{19.197}
$$

3. 当 $x \in  \left\lbrack  {-1,1}\right\rbrack$ 时 ${T}_{n}\left( x\right)$ 极值点的位置

$$
{x}_{\nu } = \cos \frac{\nu \pi }{n}\;\left( {\nu  = 0,1,2,\cdots , n}\right) . \tag{19.198}
$$

## 4. 递推公式

$$
{T}_{n + 1} = {2x}{T}_{n}\left( x\right)  - {T}_{n - 1}\left( x\right) \;\left( {n = 1,2,\cdots ;{T}_{0}\left( x\right)  = 1,{T}_{1}\left( x\right)  = x}\right) . \tag{19.199}
$$

## 例如, 递推得到

$$
{T}_{2}\left( x\right)  = 2{x}^{2} - 1,\;{T}_{3}\left( x\right)  = 4{x}^{3} - {3x}, \tag{19.200a}
$$

$$
{T}_{4}\left( x\right)  = 8{x}^{4} - 8{x}^{2} + 1,\;{T}_{5}\left( x\right)  = {16}{x}^{5} - {20}{x}^{3} + {5x}, \tag{19.200b}
$$

$$
{T}_{6}\left( x\right)  = {32}{x}^{6} - {48}{x}^{4} + {18}{x}^{2} - 1, \tag{19.200c}
$$

$$
{T}_{7}\left( x\right)  = {64}{x}^{7} - {112}{x}^{5} + {56}{x}^{3} - {7x}, \tag{19.200d}
$$

$$
{T}_{8}\left( x\right)  = {128}{x}^{8} - {256}{x}^{6} + {160}{x}^{4} - {32}{x}^{2} + 1, \tag{19.200e}
$$

$$
{T}_{9}\left( x\right)  = {256}{x}^{9} - {576}{x}^{7} + {432}{x}^{5} - {120}{x}^{3} + {9x}, \tag{19.200f}
$$

$$
{T}_{10}\left( x\right)  = {512}{x}^{10} - {1280}{x}^{8} + {1120}{x}^{6} - {400}{x}^{4} + {50}{x}^{2} - 1. \tag{19.200g}
$$

##### 19.6.3.3 列梅兹 (Remes) 算法

## 1. 交替点定理的推论

数值求解连续切比雪夫逼近问题源于交替点定理. 逼近函数选为

$$
g\left( x\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( x\right) , \tag{19.201}
$$

有 $n + 1$ 个线性无关的已知函数,切比雪夫问题的解的系数记为 ${a}_{i}^{ * }\left( {i = 0,1,\cdots , n}\right)$ , 根据 (19.195) 最小偏差记为 $\rho  = \Phi \left( {{a}_{0}^{ * },{a}_{1}^{ * },\cdots ,{a}_{n}^{ * }}\right)$ . 此时当函数 $f$ 和 ${g}_{i}(i = 0,1,\cdots$ , $n)$ 可微,由交替点定理有

$$
\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}^{ * }{g}_{i}\left( {x}_{\nu }\right)  + {\left( -1\right) }^{\nu }\varrho  = f\left( {x}_{\nu }\right) ,\;\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}^{ * }{g}_{i}^{\prime }\left( {x}_{\nu }\right)  = {f}^{\prime }\left( {x}_{\nu }\right) \;\left( {\nu  = 1,2,\cdots , n + 2}\right) .
$$

(19.202)

交替点 ${x}_{\nu }$ 满足

$$
a \leq  {x}_{1} < {x}_{2} < \cdots  < {x}_{n + 2} \leq  b. \tag{19.203}
$$

方程组 (19.202) 对切比雪夫逼近问题的 ${2n} + 4$ 个未知量,包括 $n + 1$ 个系数、 $n + 2$ 个交替点及最小偏差 $\rho$ ,给出了 ${2n} + 4$ 个条件. 若区间端点也是交替点,则在该处导数条件不是必要条件.

## 2. 根据列梅兹算法确定最小解

根据列梅兹算法, 数值确定最小解的步骤如下.

(1) 根据 (19.203) 确定交替点 ${x}_{\nu }^{\left( 0\right) }\left( {i = 1,2,\cdots , n + 2}\right)$ 的近似值,例如等距节点或 ${T}_{n + 1}\left( x\right)$ 的极值点 (见 19.6.3.2).

(2)求解线性方程组

$$
\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {{x}_{\nu }{}^{\left( 0\right) }}\right)  + {\left( -1\right) }^{\nu }\varrho  = f\left( {{x}_{\nu }{}^{\left( 0\right) }}\right) \;\left( {\nu  = 1,2,\cdots , n + 2}\right) ,
$$

其解为近似值 ${a}_{i}^{\left( 0\right) }\left( {i = 0,1,\cdots , n}\right)$ 和 ${\rho }_{0}$ .

(3) 确定交替点新的近似值 ${x}_{\nu }^{\left( 1\right) }\left( {i = 1,2,\cdots , n + 2}\right)$ ,例如误差函数 $f\left( x\right)  -$ $\mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}^{\left( 0\right) }{g}_{i}\left( x\right)$ 极值点的位置. 此时可以应用这些点作为近似值.

以 ${x}_{\nu }^{\left( 1\right) },{a}_{\nu }^{\left( 1\right) }$ 代替 ${x}_{\nu }^{\left( 0\right) },{a}_{\nu }^{\left( 0\right) }$ ,重复步骤 2 和步骤 3,等等,即得到关于系数和交替点的逼近序列,其收敛性在某些条件下可以得到 (见 [19.33]). 若某个迭代指标 $\mu$ 使得

$$
\left| {\varrho }_{\mu }\right|  = \mathop{\max }\limits_{{a \leq  x \leq  b}}\left| {f\left( x\right)  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{}^{\left( \mu \right) }{g}_{i}\left( x\right) }\right|  \tag{19.204}
$$

满足充分的精度, 则计算停止.

##### 19.6.3.4 离散切比雪夫逼近和最优化

从连续切比雪夫逼近问题

$$
\mathop{\max }\limits_{{a \leq  x \leq  b}}\left| {f\left( x\right)  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( x\right) }\right|  = \min ! \tag{19.205}
$$

若选取 $N$ 个点 ${x}_{\nu }\left( {\nu  = 1,2,\cdots , N;N \geq  n + 2}\right)$ 满足性质 $a \leq  {x}_{1} < {x}_{2} < \cdots  \leq$ ${x}_{N} \leq  b$ 并要求:

$$
\mathop{\max }\limits_{{\nu  = 1,2,\cdots , N}}\left| {f\left( {x}_{\nu }\right)  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {x}_{\nu }\right) }\right|  = \min ! \tag{19.206}
$$

可得相应的离散问题, 代入

$$
\gamma  = \mathop{\max }\limits_{{\nu  = 1,2,\cdots , N}}\left| {f\left( {x}_{\nu }\right)  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {x}_{\nu }\right) }\right| , \tag{19.207}
$$

显然有推论

$$
\left| {f\left( {x}_{\nu }\right)  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {x}_{\nu }\right) }\right|  \leq  \gamma \;\left( {\nu  = 1,2,\cdots , N}\right) . \tag{19.208}
$$

从 (19.208) 消去绝对值,得到关于系数 ${a}_{i}$ 和 $\gamma$ 的线性不等式组,从而 (19.206) 化为线性规划问题 (参见第 1179 页 18.1.1.1):

$$
\gamma  = \min !\text{,满足}\left\{  {\begin{matrix} \gamma  + \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {x}_{\nu }\right)  \geq  f\left( {x}_{\nu }\right) , \\  \gamma  - \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( {x}_{\nu }\right)  \geq   - f\left( {x}_{\nu }\right)  \end{matrix}\;\left( {\nu  = 1,2,\cdots , N}\right) .}\right.  \tag{19.209}
$$

对 $\gamma  > 0$ 方程 (19.209) 有极小解. 对于足够大的点数 $N$ 及某些进一步的条件,离散问题的解可看作连续问题的解.

若用非线性依赖参数 ${a}_{0},{a}_{1},\cdots ,{a}_{n}$ 的非线性逼近函数 $g\left( x\right)  = g\left( {x;{a}_{0},{a}_{1}}\right.$ , $\left. {\cdots ,{a}_{n}}\right)$ 代替线性逼近函数 $g\left( x\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}{a}_{i}{g}_{i}\left( x\right)$ ,则类似可得非线性最优化问题. 其通常即使在简单函数形式下也是非凸的. 这从本质上减少了非线性最优化问题的数值解法 (参见第 1203 页 18.2.2.1).

#### 19.6.4 调和分析

以公式或经验给出的以 ${2\pi }$ 为周期的周期函数 $f\left( x\right)$ ,应以三角多项式或傅里叶和逼近:

$$
g\left( x\right)  = \frac{{a}_{0}}{2} + \mathop{\sum }\limits_{{k = 1}}^{n}\left( {{a}_{k}\cos {kx} + {b}_{k}\sin {kx}}\right) , \tag{19.210}
$$

其中系数 ${a}_{0},{a}_{k},{b}_{k}$ 是未知实数. 确定这些系数正是调和分析的课题.

##### 19.6.4.1 三角插值公式

## 1. 傅里叶系数公式

因为函数系 $1,\cos {kx},\sin {kx}\left( {k = 1,2,\cdots , n}\right)$ 在区间 $\left\lbrack  {0,{2\pi }}\right\rbrack$ 内关于权函数 $\omega  =$ 1 是正交的, 根据 (19.172) 应用连续最小二乘法得到系数公式

$$
{a}_{k} = \frac{1}{\pi }{\int }_{0}^{2\pi }f\left( x\right) \cos {kx}\mathrm{\;d}x,\;{b}_{k} = \frac{1}{\pi }{\int }_{0}^{2\pi }f\left( x\right) \sin {kx}\mathrm{\;d}x\;\left( {k = 0,1,2,\cdots , n}\right) .
$$

(19.211)

由公式 (19.211) 计算得到的系数 ${a}_{k},{b}_{k}$ 称为周期函数 $f\left( x\right)$ 的傅里叶系数 (参见第 633 页 7.4).

若 (19.211) 中的积分复杂或函数 $f\left( x\right)$ 仅在离散点上已知,则傅里叶系数只可由数值积分近似确定.

使用有 $N + 1$ 个等距节点的梯形公式 (参见第 1253 页 19.3.2.2)

$$
{x}_{\nu } = {\nu h}\left( {\nu  = 0,1,\cdots , N}\right) ,\;h = \frac{2\pi }{N} \tag{19.212}
$$

得近似公式

$$
{a}_{k} \approx  {\widetilde{a}}_{k} = \frac{2}{N}\mathop{\sum }\limits_{{\nu  = 1}}^{N}f\left( {x}_{\nu }\right) \cos k{x}_{\nu },\;{b}_{k} \approx  {\widetilde{b}}_{k} = \frac{2}{N}\mathop{\sum }\limits_{{\nu  = 1}}^{N}f\left( {x}_{\nu }\right) \sin k{x}_{\nu }\;\left( {k = 0,1,2,\cdots , n}\right) .
$$

(19.213)

在周期函数的情况下梯形公式变为非常简单的矩形公式. 如下事实使它有更高的精度: 若 $f\left( x\right)$ 是周期函数且 ${2m} + 2$ 次可微,则梯形公式的误差阶为 $O\left( {h}^{{2m} + 2}\right)$ .

2. 三角插值

以 ${\widetilde{a}}_{k},{\widetilde{b}}_{k}$ 为近似系数的某些特殊的三角多项式有重要的性质. 这里介绍其中的两个性质.

(1) 插值 假设 $N = {2n}$ 成立. 系数由 (19.123) 给出的特殊的三角多项式

$$
{\widetilde{g}}_{1}\left( x\right)  = \frac{1}{2}{\widetilde{a}}_{0} + \mathop{\sum }\limits_{{k = 1}}^{{n - 1}}\left( {{\widetilde{a}}_{k}\cos {kx} + {\widetilde{b}}_{k}\sin {kx}}\right)  + \frac{1}{2}{\widetilde{a}}_{n}\cos {nx} \tag{19.214}
$$

在插值点 ${x}_{v}\left( {19.212}\right)$ 满足插值条件

$$
{\widetilde{g}}_{1}\left( {x}_{\nu }\right)  = f\left( {x}_{\nu }\right) \;\left( {\nu  = 1,2,\cdots , N}\right) . \tag{19.215}
$$

由 $f\left( x\right)$ 的性质,成立 $f\left( {x}_{0}\right)  = f\left( {x}_{N}\right)$ .

(2)平均近似假设 $N = {2n}$ 成立. 特殊的三角多项式

$$
{\widetilde{g}}_{2}\left( x\right)  = \frac{1}{2}{\widetilde{a}}_{0} + \mathop{\sum }\limits_{{k = 1}}^{m}\left( {{\widetilde{a}}_{k}\cos {kx} + {\widetilde{b}}_{k}\sin {kx}}\right) , \tag{19.216}
$$

对于 $m < n$ ,系数 (19.123) 按离散二次平均关于 $N$ 个节点 ${x}_{\nu }$ (19.212) 逼近函数 $f\left( x\right)$ ,即残量平方和

$$
F = \mathop{\sum }\limits_{{\nu  = 1}}^{N}{\left\lbrack  f\left( {x}_{\nu }\right)  - {\widetilde{g}}_{2}\left( {x}_{\nu }\right) \right\rbrack  }^{2} \tag{19.217}
$$

取得极小. 公式 (19.213) 正是用不同方法有效计算傅里叶系数的出发点.

##### 19.6.4.2 快速傅里叶变换 (FFT)

## 1. 计算傅里叶系数的计算量

公式 (19.213) 中的求和也与离散傅里叶变换相关联, 例如在电工学、脉冲和图像处理中. 这里 $N$ 可能非常大,因为计算傅里叶系数的 $N$ 个近似值 (19.213) 需要大约 ${N}^{2}$ 个加法和乘法运算,所以必须以合理的方法计算求和.

对于 $N = {2}^{p}$ 的特殊情况,借助所谓快速傅里叶变换 (FFT),乘法运算的计算量可由 ${N}^{2}\left( { = {2}^{2p}}\right)$ 减少为 ${pN}\left( { = p{2}^{p}}\right)$ . 该减少量可以由右边的例子说明.(19.218)该方法如此有效地减少计算量和计算时间, 使得在重要的应用领域小型计算机也够用了.

<table><tr><td/><td>${N}^{2}$</td><td>${pN}$</td></tr><tr><td>10</td><td>$\sim  {10}^{6}$</td><td>$\sim  {10}^{4}$</td></tr><tr><td/><td/><td/></tr></table>

FFT 将 $N$ 单位根,即方程 ${z}^{N} = 1$ 的解的性质应用于 (19.213) 中的逐次求和.

## 2. 傅里叶和的复数表达

若在傅里叶和 (19.210) 中代入如下公式:

$$
\cos {kx} = \frac{1}{2}\left( {{\mathrm{e}}^{\mathrm{i}{kx}} + {\mathrm{e}}^{-\mathrm{i}{kx}}}\right) ,\;\sin {kx} = \frac{\mathrm{i}}{2}\left( {{\mathrm{e}}^{-\mathrm{i}{kx}} - {\mathrm{e}}^{\mathrm{i}{kx}}}\right) , \tag{19.219}
$$

则 FFT 的原理可以相当简单地表述为复数形式

$$
g\left( x\right)  = \frac{1}{2}{a}_{0} + \mathop{\sum }\limits_{{k = 1}}^{n}\left( {{a}_{k}\cos {kx} + {b}_{k}\sin {kx}}\right)
$$

$$
= \frac{1}{2}{a}_{0} + \mathop{\sum }\limits_{{k = 1}}^{n}\left( {\frac{{a}_{k} - \mathrm{i}{b}_{k}}{2}{\mathrm{e}}^{\mathrm{i}{kx}} + \frac{{a}_{k} + \mathrm{i}{b}_{k}}{2}{\mathrm{e}}^{-\mathrm{i}{kx}}}\right) . \tag{19.220}
$$

通过代换

$$
{c}_{k} = \frac{{a}_{k} - \mathrm{i}{b}_{k}}{2}, \tag{19.221a}
$$

由 (19.211), 有

$$
{c}_{k} = \frac{1}{2\pi }{\int }_{0}^{2\pi }f\left( x\right) {\mathrm{e}}^{-\mathrm{i}{kx}}\mathrm{\;d}x, \tag{19.221b}
$$

故 (19.220) 化为傅里叶和的复数表达式

$$
g\left( x\right)  = \mathop{\sum }\limits_{{k =  - n}}^{n}{c}_{k}{\mathrm{e}}^{\mathrm{i}{kx}}\text{,其中 }{c}_{-k} = {\bar{c}}_{k}. \tag{19.222}
$$

若复系数 ${c}_{k}$ 已知,则要求的实傅里叶系数可以由下面简单的方法得到

$$
{a}_{0} = 2{c}_{0},\;{a}_{k} = 2\operatorname{Re}\left( {c}_{k}\right) ,\;{b}_{k} =  - 2\operatorname{Im}\left( {c}_{k}\right) \;\left( {k = 1,2,\cdots , n}\right) . \tag{19.223}
$$

## 3. 复傅里叶系数的数值计算

为数值确定 ${c}_{k}$ ,类似于 (19.212) 和 (19.213),可对 (19.221b) 应用梯形公式,从而得到离散复傅里叶系数 ${\widetilde{c}}_{k}$ :

$$
{\widetilde{c}}_{k} = \frac{1}{N}\mathop{\sum }\limits_{{\nu  = 0}}^{{N - 1}}f\left( {x}_{\nu }\right) {\mathrm{e}}^{-\mathrm{i}k{x}_{\nu }} = \mathop{\sum }\limits_{{\nu  = 0}}^{{N - 1}}{f}_{\nu }{\omega }_{N}^{k\nu }\;\left( {k = 0,1,2,\cdots , n}\right) , \tag{19.224a}
$$

$$
{f}_{\nu } = \frac{1}{N}f\left( {x}_{\nu }\right) ,\;{x}_{\nu } = \frac{2\pi \nu }{N}\;\left( {\nu  = 0,1,2,\cdots , N - 1}\right) ,\;{\omega }_{N} = {\mathrm{e}}^{-\frac{{2\pi }\mathrm{i}}{N}}. \tag{19.224b}
$$

关系式 (19.224a) 和 (19.224b) 称为数值 ${f}_{\nu }\left( {\nu  = 0,1,2,\cdots , N - 1}\right)$ 的长度为 $N$ 的离散复傅里叶变换.

指数 ${w}_{N}^{\nu } = z\left( {\nu  = 0,1,2,\cdots , N - 1}\right)$ 满足方程 ${z}^{N} = 1$ ,称之为 $N$ 次单位根. 因 ${\mathrm{e}}^{-{2\pi }\mathrm{i}} = 1$ ,故

$$
{\omega }_{N}^{N} = 1,\;{\omega }_{N}^{N + 1} = {\omega }_{N}^{1},\;{\omega }_{N}^{N + 2} = {\omega }_{N}^{2},\cdots . \tag{19.225}
$$

长度为 $N = {2n}$ 的离散复傅里叶变换可以按下列方式化为两个长度为 $\frac{N}{2} = n$ 的变换, 利用这一事实可有效计算 (19.224a):

a) 对于每个偶数指标的系数 ${\widetilde{c}}_{k}$ ,即 $k = {2l}$ ,成立

$$
{\widetilde{c}}_{2l} = \mathop{\sum }\limits_{{\nu  = 0}}^{{{2n} - 1}}{f}_{\nu }{\omega }_{N}^{2l\nu } = \mathop{\sum }\limits_{{\nu  = 0}}^{{n - 1}}\left\lbrack  {{f}_{\nu }{\omega }_{N}^{2l\nu } + {f}_{n + \nu }{\omega }_{N}^{{2l}\left( {n + \nu }\right) }}\right\rbrack   = \mathop{\sum }\limits_{{\nu  = 0}}^{{n - 1}}\left\lbrack  {{f}_{\nu } + {f}_{n + \nu }}\right\rbrack  {\omega }_{N}^{2l\nu },
$$

(19.226)

这里用到等式 ${w}_{N}^{{2l}\left( {n + \nu }\right) } = {w}_{N}^{l2n}{w}_{N}^{2l\nu } = {w}_{N}^{2l\nu }$ .

代入

$$
{y}_{\nu } = {f}_{\nu } + {f}_{n + \nu }\;\left( {\nu  = 0,1,2,\cdots , n - 1}\right) , \tag{19.227}
$$

并考虑到 ${w}_{N}^{2} = {w}_{n}$ ,和式

$$
{\widetilde{c}}_{2l} = \mathop{\sum }\limits_{{\nu  = 0}}^{{n - 1}}{y}_{\nu }{\omega }_{n}^{l\nu }\;\left( {\nu  = 0,1,2,\cdots , n - 1}\right)  \tag{19.228}
$$

便是以 $\frac{N}{2}$ 为长度的数值 ${y}_{\nu }\left( {\nu  = 0,1,2,\cdots , n - 1}\right)$ 的离散复傅里叶变换.

b) 对每个奇数指标的系数 ${\widetilde{c}}_{k}$ ,即 $k = {2l} + 1$ ,类似可得

$$
{\widetilde{c}}_{{2l} + 1} = \mathop{\sum }\limits_{{\nu  = 0}}^{{{2n} - 1}}{f}_{\nu }{\omega }_{N}^{\left( {{2l} + 1}\right) \nu } = \mathop{\sum }\limits_{{\nu  = 0}}^{{n - 1}}\left\lbrack  {\left( {{f}_{\nu } - {f}_{n + \nu }}\right) {\omega }_{N}^{\nu }}\right\rbrack  {\omega }_{N}^{2l\nu }, \tag{19.229}
$$

代入

$$
{y}_{n + \nu } = \left( {{f}_{\nu } - {f}_{n + \nu }}\right) {\omega }_{N}^{\nu }\;\left( {\nu  = 0,1,2,\cdots , n - 1}\right)  \tag{19.230}
$$

并考虑到 ${w}_{N}^{2} = {w}_{n}$ ,则和式

$$
{\widetilde{c}}_{{2l} + 1} = \mathop{\sum }\limits_{{\nu  = 0}}^{{n - 1}}{y}_{n + \nu }{\omega }_{n}^{l\nu }\;\left( {\nu  = 0,1,2,\cdots , n - 1}\right)  \tag{19.231}
$$

是以 $\frac{N}{2}$ 为长度的数值 ${y}_{n + \nu }\left( {\nu  = 0,1,2,\cdots , n - 1}\right)$ 的离散复傅里叶变换.

若 $N$ 为 2 的幂次,即 $N = {2}^{p}$ ( $p$ 为自然数),则根据 a) 和 b) 的归化,即将离散复傅里叶变换化为两个一半长度的离散复傅里叶变换, 是可以继续下去的. 应用 $p$ 次归化后则称 FFT.

根据 (19.230) 每步归化要求 $N/2$ 次复乘法运算, FFT 方法的计算量为

$$
\frac{N}{2}p = \frac{N}{2}{\log }_{2}N \tag{19.232}
$$

### 4.FFT 的格式

对于特殊情况 $N = 8 = {2}^{3}$ ,根据 (19.227) 和 (19.230), FFT 的三个相应的归化步骤由如下格式 1 说明.

格式 1

<table><tr><td/><td>第 1 步</td><td>第 2 步</td><td>第 3 步</td><td/></tr><tr><td>${f}_{0}$</td><td>${y}_{0} = {f}_{0} + {f}_{4}$</td><td>${y}_{0} \mathrel{\text{:=}} {y}_{0} + {y}_{2}$</td><td rowspan="8">${y}_{0} \mathrel{\text{:=}} {y}_{0} + {y}_{1}$ ${y}_{1} \mathrel{\text{:=}} \left( {{y}_{0} - {y}_{1}}\right) {\omega }_{2}^{0}$ ${y}_{2} \mathrel{\text{:=}} {y}_{2} + {y}_{3}$ ${y}_{3} \mathrel{\text{:=}} \left( {{y}_{2} - {y}_{3}}\right) {\omega }_{2}^{0}$ ${y}_{4} \mathrel{\text{:=}} {y}_{4} + {y}_{5}$ ${y}_{5} \mathrel{\text{:=}} \left( {{y}_{4} - {y}_{5}}\right) {\omega }_{2}^{0}$ ${y}_{6} \mathrel{\text{:=}} {y}_{6} + {y}_{7}$ ${y}_{7} \mathrel{\text{:=}} \left( {{y}_{6} - {y}_{7}}\right) {\omega }_{2}^{0}$</td><td>$= {\widetilde{c}}_{0}$</td></tr><tr><td>${f}_{1}$</td><td>${y}_{1} = {f}_{1} + {f}_{5}$</td><td>${y}_{1} \mathrel{\text{:=}} {y}_{1} + {y}_{3}$</td><td>$= {\widetilde{c}}_{4}$</td></tr><tr><td>${f}_{2}$</td><td>${y}_{2} = {f}_{2} + {f}_{6}$</td><td>${y}_{2} \mathrel{\text{:=}} \left( {{y}_{0} - {y}_{2}}\right) {\omega }_{4}^{0}$</td><td>$= {\widetilde{c}}_{2}$</td></tr><tr><td>${f}_{3}$</td><td>${y}_{3} = {f}_{3} + {f}_{7}$</td><td>${y}_{3} \mathrel{\text{:=}} \left( {{y}_{1} - {y}_{3}}\right) {\omega }_{4}^{1}$</td><td>$= {\widetilde{c}}_{6}$</td></tr><tr><td>${f}_{4}$</td><td>${y}_{4} = \left( {{f}_{0} - {f}_{4}}\right) {\omega }_{8}^{0}$</td><td>${y}_{4} \mathrel{\text{:=}} {y}_{4} + {y}_{6}$</td><td>$= {\widetilde{c}}_{1}$</td></tr><tr><td>${f}_{5}$</td><td>${y}_{5} = \left( {{f}_{1} - {f}_{5}}\right) {\omega }_{8}^{1}$</td><td>${y}_{5} \mathrel{\text{:=}} {y}_{5} + {y}_{7}$</td><td>$= {\widetilde{c}}_{5}$</td></tr><tr><td>${f}_{6}$</td><td>${y}_{6} = \left( {{f}_{2} - {f}_{6}}\right) {\omega }_{8}^{2}$</td><td>${y}_{6} \mathrel{\text{:=}} \left( {{y}_{4} - {y}_{6}}\right) {\omega }_{4}^{0}$</td><td>$= {\widetilde{c}}_{3}$</td></tr><tr><td>${f}_{7}$</td><td>${y}_{7} = \left( {{f}_{3} - {f}_{7}}\right) {\omega }_{8}^{3}$</td><td>${y}_{7} \mathrel{\text{:=}} \left( {{y}_{5} - {y}_{7}}\right) {\omega }_{4}^{1}$</td><td>$= {\widetilde{c}}_{7}$</td></tr><tr><td/><td>$N = 8, n \mathrel{\text{:=}} 4$ , ${\omega }_{8} = {\mathrm{e}}^{-\frac{{2\pi }\mathrm{i}}{8}}$</td><td>$N \mathrel{\text{:=}} 4, n \mathrel{\text{:=}} 2,$ ${\omega }_{4} = {\omega }_{8}^{2}$</td><td>$N \mathrel{\text{:=}} 2, n \mathrel{\text{:=}} 1$ , ${\omega }_{2} = {\omega }_{4}^{2}$</td><td/></tr></table>

可以注意到偶数及奇数指标项是如何出现的. 在格式 2 中 (19.233) 阐述了该方法的结构.

格式 2

$$
{\widetilde{c}}_{k} \Rightarrow  \left\{  \begin{array}{l} {\widetilde{c}}_{2k} \Rightarrow  \left\{  \begin{array}{l} {\widetilde{c}}_{2k} \Rightarrow  \left\{  \begin{array}{l} {\widetilde{c}}_{8k} \\  {\widetilde{c}}_{{8k} + 4} \\  {\widetilde{c}}_{{8k} + 2} \\  {\widetilde{c}}_{{8k} + 2} \\  {\widetilde{c}}_{{8k} + 6} \end{array}\right. \\  {\widetilde{c}}_{{8k} + 6} \end{array}\right. \\  {\widetilde{c}}_{{2k} + 1} \Rightarrow  \left\{  \begin{array}{l} {\widetilde{c}}_{{8k} + 1} \Rightarrow  \left\{  \begin{array}{l} {\widetilde{c}}_{{8k} + 1} \\  {\widetilde{c}}_{{8k} + 5} \\  {\widetilde{c}}_{{8k} + 5} \\  {\widetilde{c}}_{{8k} + 6} \end{array}\right. \\  {\widetilde{c}}_{{8k} + 3} \end{array}\right.  \end{array}\right.  \tag{19.233}
$$

$$
\left( {k = 0,1,\cdots ,7}\right) \;\left( {k = 0,1,2,3}\right) \;\left( {k = 0,1}\right) \left( {k = 0}\right) .
$$

若将系数 ${\widetilde{c}}_{k}$ 代入格式 1,并在第 1 步前和第 3 步后考虑指标的二进制形式,则易知通过简单反转二进制形式指标的位数顺序, 可得要求的系数的阶. 这显示在格式 3 中.

## 格式 3

<table><tr><td colspan="2">标志</td><td>第 1 步</td><td>第 2 步</td><td>第 3 步</td><td>标志</td></tr><tr><td>${\widetilde{c}}_{0}$</td><td>000</td><td>${\widetilde{c}}_{0}$</td><td>${\widetilde{c}}_{0}$</td><td>${\widetilde{c}}_{0}$</td><td>000</td></tr><tr><td>${\widetilde{c}}_{1}$</td><td>00L</td><td>${\widetilde{c}}_{2}$</td><td>${\widetilde{c}}_{4}$</td><td>${\widetilde{c}}_{4}$</td><td>L00</td></tr><tr><td>${\widetilde{c}}_{2}$</td><td>0L0</td><td>${\widetilde{c}}_{4}$</td><td>${\widetilde{c}}_{2}$</td><td>${\widetilde{c}}_{2}$</td><td>0L0</td></tr><tr><td>${\widetilde{c}}_{3}$</td><td>0LL</td><td>${\widetilde{c}}_{6}$</td><td>${\widetilde{c}}_{6}$</td><td>${\widetilde{c}}_{6}$</td><td>LL0</td></tr><tr><td>${\widetilde{c}}_{4}$</td><td>L00</td><td>${\widetilde{c}}_{1}$</td><td>${\widetilde{c}}_{1}$</td><td>${\widetilde{c}}_{1}$</td><td>00L</td></tr><tr><td>${\widetilde{c}}_{5}$</td><td>L0L</td><td>${\widetilde{c}}_{3}$</td><td>${\widetilde{c}}_{5}$</td><td>${\widetilde{c}}_{5}$</td><td>L0L</td></tr><tr><td>${\widetilde{c}}_{6}$</td><td>LLO</td><td>${\widetilde{c}}_{5}$</td><td>${\widetilde{c}}_{3}$</td><td>${\widetilde{c}}_{3}$</td><td>0LL</td></tr><tr><td>$\widetilde{C}7$</td><td>LLL</td><td>$\widetilde{C}7$</td><td>C7</td><td>$\widetilde{C}7$</td><td>LLL</td></tr></table>

考虑以 ${2\pi }$ 为周期的函数 $f\left( x\right)  = \left\{  \begin{array}{ll} 2{\pi }^{2}, & x = 0, \\  {x}^{2}, & 0 < x < {2\pi }, \end{array}\right.$ 将 FFT 用于离散傅里叶变换. 选取 $N = 8,{x}_{\nu } = \frac{2\pi }{8},{f}_{\nu } = \frac{1}{8}f\left( {x}_{\nu }\right) \left( {\nu  = 0,1,2,\cdots ,7}\right) ,{w}_{8} = {\mathrm{e}}^{-\frac{{2\pi }\mathrm{i}}{8}} =$ ${0.707107}\left( {1 - \mathrm{i}}\right) ,{w}_{8}^{2} =  - \mathrm{i},{w}_{8}^{3} =  - {0.707107}\left( {1 + \mathrm{i}}\right)$ . 得到格式 4 .

格式 4

<table><tr><td/><td>第 1 步</td><td>第 2 步</td><td>第 3 步</td></tr><tr><td>${f}_{0} = {2.467401}$</td><td>${y}_{0} = {3.701102}$</td><td>${y}_{0} = {6.785353}$</td><td>${y}_{0} = {13.262281} = {\widetilde{c}}_{0}$</td></tr><tr><td>${f}_{1} = {0.077106}$</td><td>${y}_{1} = {2.004763}$</td><td>${y}_{1} = {6.476928}$</td><td>${y}_{1} = {0.308425} = {\widetilde{c}}_{4}$</td></tr><tr><td>${f}_{2} = {0.308425}$</td><td>${y}_{2} = {3.084251}$</td><td>${y}_{2} = {0.616851}$</td><td>${y}_{2} = {0.616851}$ $+ {2.467402}\mathrm{i} = {\widetilde{c}}_{2}$</td></tr><tr><td>${f}_{3} = {0.693957}$</td><td>${y}_{3} = {4.472165}$</td><td>${y}_{3} = {2.467402}\mathrm{i}$</td><td>${y}_{3} = {0.616851}$ $- {2.467402}\mathrm{i} = {\widetilde{c}}_{6}$</td></tr><tr><td>${f}_{4} = {1.233701}$</td><td>${y}_{4} = {1.233700}$</td><td>${y}_{4} = {1.233700}$ +2.467401 i</td><td>${y}_{4} = {2.106058}$ $+ {5.956833}\mathrm{i} = {\widetilde{c}}_{1}$</td></tr><tr><td>${f}_{5} = {1.927657}$</td><td>${y}_{5} =  - {1.308537}\left( {1 - \mathrm{i}}\right)$</td><td>${y}_{5} = {0.872358}$ +3.489432 i</td><td>${y}_{5} = {0.361342}$ $- {1.022031}\mathrm{i} = {\widetilde{c}}_{5}$</td></tr><tr><td>${f}_{6} = {2.775826}$</td><td>${y}_{6} = {2.467401}\mathrm{i}$</td><td>${y}_{6} = {1.233700}$</td><td>${y}_{6} = {0.361342}$</td></tr><tr><td/><td/><td>-2.467401 i</td><td>+1.022031 i $= {\widetilde{c}}_{3}$</td></tr><tr><td>${f}_{7} = {3.778208}$</td><td>${y}_{7} = {2.180895}\left( {1 + \mathrm{i}}\right)$</td><td>${y}_{7} =  - {0.872358}$ +3.489432 i</td><td>${y}_{7} = {2.106058}$ $- {5.956833}\mathrm{i} = {\widetilde{c}}_{7}$</td></tr></table>

通过三步归化, 根据 (19.233) 得到要求的实傅里叶系数 (见 (19.234)).

$$
{a}_{0} = {26.524562}
$$

$$
{a}_{1} = {4.212116}\;{b}_{1} =  - {11.913666}
$$

$$
{a}_{2} = {1.233702}\;{b}_{2} =  - {4.934804} \tag{19.234}
$$

$$
{a}_{3} = {0.722684}\;{b}_{3} =  - {2.044062}
$$

$$
{a}_{4} = {0.616850}\;{b}_{4} = 0
$$

在该例中, 可注意到离散复傅里叶系数的一般性质

$$
{\widetilde{c}}_{N - k} = {\widetilde{c}}_{k}.
$$

当 $k = 1,2,3$ 时,即有 ${\widetilde{c}}_{7} = {\widetilde{c}}_{1},{\widetilde{c}}_{6} = {\widetilde{c}}_{2},{\widetilde{c}}_{5} = {\widetilde{c}}_{3}$ .

### 19.7 曲线和曲面用样条表示

#### 19.7.1 三次样条

因为高次插值逼近多项式通常有并不想要的振荡, 故将近似区间用所谓的节点分为子区间并考虑在每个子区间用相对简单的近似函数是有用的. 特别地, 常使用三次多项式. 这类分片逼近要求在节点处光滑过渡.

##### 19.7.1.1 插值样条

## 1. 三次插值样条的定义和性质

设给定 $N$ 个插值点 $\left( {{x}_{i},{f}_{i}}\right) \left( {i = 1,2,\cdots , N;{x}_{1} < {x}_{2} < \cdots  < {x}_{N}}\right)$ . 三次插值样条 $S\left( x\right)$ 由下列性质唯一确定:

(1) $S\left( x\right)$ 满足插值条件 $S\left( {x}_{i}\right)  = {f}_{i}\left( {i = 1,2,\cdots , N}\right)$ .

(2) $S\left( x\right)$ 在任一子区间 $\left\lbrack  {{x}_{i},{x}_{i + 1}}\right\rbrack  \left( {i = 1,2,\cdots , N - 1}\right)$ 内为次数不高于 3 的多项式.

(3) $S\left( x\right)$ 在整个插值区间 $\left\lbrack  {{x}_{1},{x}_{N}}\right\rbrack$ 上是二次连续可微的.

(4) $S\left( x\right)$ 满足特殊的边界条件

a) ${S}^{\prime \prime }\left( {x}_{1}\right)  = {S}^{\prime \prime }\left( {x}_{N}\right)  = 0$ (我们称之为自然样条) 或

b) ${S}^{\prime }\left( {x}_{1}\right)  = {f}_{1}^{\prime },{S}^{\prime }\left( {x}_{N}\right)  = {f}_{N}^{\prime }\left( {{f}_{1}^{\prime },{f}_{N}^{\prime }}\right.$ 为已知值 $)$ 或

c) 当 ${f}_{1} = {f}_{N}$ 时, $S\left( {x}_{1}\right)  = S\left( {x}_{N}\right) ,{S}^{\prime }\left( {x}_{1}\right)  = {S}^{\prime }\left( {x}_{N}\right)$ 和 ${S}^{\prime \prime }\left( {x}_{1}\right)  = {S}^{\prime \prime }\left( {x}_{N}\right)$ (称为周期样条).

由这些性质可得,对所有满足插值条件 $g\left( {x}_{i}\right)  = {f}_{i}\left( {i = 1,2,\cdots , N}\right)$ 的二次连续可微函数 $g\left( x\right)$ ,有

$$
{\int }_{{x}_{1}}^{{x}_{N}}{\left\lbrack  {S}^{\prime \prime }\left( x\right) \right\rbrack  }^{2}\mathrm{\;d}x \leq  {\int }_{{x}_{1}}^{{x}_{N}}{\left\lbrack  {g}^{\prime \prime }\left( x\right) \right\rbrack  }^{2}\mathrm{\;d}x \tag{19.235}
$$

成立 (霍拉迪 (Holladay) 定理). 依据 (19.235),可称 $S\left( x\right)$ 有最小全曲率,因为对已知曲线的曲率 $\kappa$ ,其首次逼近为 $\kappa  \approx  {S}^{\prime \prime }$ (参见第 331 页 3.6.1.2,4.). 可见若称为样条的细弹性尺穿过点 $\left( {{x}_{i},{f}_{i}}\right) \left( {i = 1,2,\cdots , N}\right)$ ,则其弯曲线沿着三次样条 $S\left( x\right)$ .

## 2. 确定样条系数

三次插值样条 $S\left( x\right)$ 在区间 $\left\lbrack  {{x}_{i},{x}_{i + 1}}\right\rbrack$ 上具有如下形式:

$$
S\left( x\right)  = {S}_{i}\left( x\right)  = {a}_{i} + {b}_{i}\left( {x - {x}_{i}}\right)  + {c}_{i}{\left( x - {x}_{i}\right) }^{2} + {d}_{i}{\left( x - {x}_{i}\right) }^{3}\;\left( {i = 1,2,\cdots , N - 1}\right) .
$$

(19.236)

子区间的长度记为 ${h}_{i} = {x}_{i + 1} - {x}_{i}$ . 自然样条的系数以如下方式确定.

(1) 由插值条件得

$$
{a}_{i} = {f}_{i}\;\left( {i = 1,2,\cdots , N - 1}\right) . \tag{19.237}
$$

引入不出现在多项式里的附加系数 ${a}_{N} = {f}_{N}$ 是合理的.

(2) ${S}^{\prime \prime }\left( x\right)$ 在内节点的连续性要求

$$
{d}_{i - 1} = \frac{{c}_{i} - {c}_{i - 1}}{3{h}_{i - 1}}\;\left( {i = 2,3,\cdots , N - 1}\right) . \tag{19.238}
$$

由自然条件得到 ${c}_{1} = 0$ ,且若引入 ${c}_{N} = 0,\left( {19.238}\right)$ 对 $i = N$ 依旧成立.

(3)由 $S\left( x\right)$ 在内节点的连续性得到关系

$$
{b}_{i - 1} = \frac{{a}_{i} - {a}_{i - 1}}{{h}_{i - 1}} - \frac{2{c}_{i - 1} + {c}_{i}}{3}{h}_{i - 1}\;\left( {i = 2,3,\cdots , N}\right) . \tag{19.239}
$$

(4) ${S}^{\prime }\left( x\right)$ 在内节点的连续性要求

$$
{c}_{i - 1}{h}_{i - 1} + 2\left( {{h}_{i - 1} + {h}_{i}}\right) {c}_{i} + {c}_{i + 1}{h}_{i} = 3\left( {\frac{{a}_{i + 1} - {a}_{i}}{{h}_{i}} - \frac{{a}_{i} - {a}_{i - 1}}{{h}_{i - 1}}}\right) \;\left( {i = 2,3,\cdots , N - 1}\right) .
$$

(19.240)

因为(19.237),用来确定系数 ${c}_{i}\left( {i = 2,3,\cdots , N - 1;{c}_{1} = {c}_{N} = 0}\right)$ 的线性方程组 (19.240) 的右端已知. 其左端有如下形式:

$$
\left( \begin{matrix} 2\left( {{h}_{1} + {h}_{2}}\right) & {h}_{2} & & & & & \\  {h}_{2} & 2\left( {{h}_{2} + {h}_{3}}\right) & {h}_{3} & & \mathbf{0} & & \\   & {h}_{3} & 2\left( {{h}_{3} + {h}_{4}}\right) & {h}_{4} & & & \\   & &  \ddots  &  \ddots  &  \ddots  & & \\   & \mathbf{0} & & & & {h}_{N - 2} & \\   & & & & & {h}_{N - 2} & 2\left( {{h}_{N - 2} + {h}_{N - 1}}\right)  \end{matrix}\right) \left( \begin{matrix} {c}_{2} \\  {c}_{3} \\  {c}_{4} \\  \vdots \\   \\  {c}_{N - 1} \end{matrix}\right) .
$$

(19.241)

系数矩阵是三对角的,故由 ${LR}$ 分解 (参见第 1243 页 19.2.1.1,2.),非常容易数值求解线性方程组 (19.240). 于是 (19.239) 和 (19.238) 的所有其他系数 ${c}_{i}$ 可以确定.

##### 19.7.1.2 光滑样条

在实际应用中已知的函数值 ${f}_{i}$ 通常是测量值,故有某些误差. 在这种情况下, 插值要求并不合理. 这就是引进三次光滑样条的原因. 若在三次插值样条中将插值要求换为

$$
\mathop{\sum }\limits_{{i = 1}}^{N}{\left\lbrack  \frac{{f}_{i} - S\left( {x}_{i}\right) }{{\sigma }_{i}}\right\rbrack  }^{2} + \lambda {\int }_{{x}_{1}}^{{x}_{N}}{\left\lbrack  {S}^{\prime \prime }\left( x\right) \right\rbrack  }^{2}\mathrm{\;d}x = \min ! \tag{19.242}
$$

可得此类样条. 保持 $S,{S}^{\prime },{S}^{\prime \prime }$ 连续性的这一要求,使得确定系数的问题是一个带方程形式条件的约束最优化问题. 使用拉格朗日函数 (参见第 611 页 6.2.5.6) 即可得到解. 详情可见 [19.34], [19.35].

在 (19.242) 中, $\lambda \left( {\lambda  > 0}\right)$ 表示事先给定的光滑参数. 作为特殊情况,当 $\lambda  = 0$ 时为三次插值样条. 当 $\lambda$ 很大时得到光滑的近似曲线,但回到测量值不准确. 作为另一种特殊情况,当 $\lambda  = \infty$ 时结果是逼近回归线. 可适当选取 $\lambda$ ,例如通过机屏对话. 在 (19.242) 中的参数 ${\sigma }_{i}\left( {{\sigma }_{i} > 0}\right)$ 表示数值 ${f}_{i}\left( {i = 1,2,\cdots , N}\right)$ 的测量误差的标准偏差 (参见第 1109 页 16.4.1.3, 2.).

插值点和测量点的坐标至今与样条函数的节点坐标是一致的. 对大的 $N$ ,该方法导致包含大量三次函数 (19.236) 的样条. 由于在许多实际应用中, 只有段数很少的样条才是满意的, 一个可能的解答是自由选取节点的数目和位置. 从数值观点看, 以下面形式的样条代替 (19.236) 也是合理的:

$$
S\left( x\right)  = \mathop{\sum }\limits_{{i = 1}}^{{r + 2}}{a}_{i}{N}_{i,4}\left( x\right) , \tag{19.243}
$$

这里 $r$ 表示自由选取的节点的个数,而函数 ${N}_{i,4}\left( x\right)$ 是所谓 4 阶正规化 $\mathrm{B}$ 样条 (基样条),即关于第 $i$ 个节点的三次多项式. 详情可见 [19.8],[19.6].

#### 19.7.2 双三次样条

##### 19.7.2.1 使用双三次样条

双三次样条用于如下问题: $x, y$ 平面的矩形 $R : a \leq  x \leq  b, c \leq  y \leq  d$ ,被节点 $\left( {{x}_{i},{y}_{j}}\right) \left( {i = 0,1,\cdots , n;j = 0,1,\cdots , m}\right)$ 剖分为子区域 ${R}_{ij}$ ,

$$
a = {x}_{0} < {x}_{1} < \cdots  < {x}_{n} = b,\;c = {y}_{0} < {y}_{1} < \cdots  < {y}_{m} = d, \tag{19.244}
$$

其中子区域 ${R}_{ij}$ 包含点 $\left( {x, y}\right)  : {x}_{i} \leq  x \leq  {x}_{i + 1},{y}_{j} \leq  y \leq  {y}_{j + 1}(i = 0,1,\cdots , n;j = 0$ , $1,\cdots , m)$ . 在节点给定函数值 $f\left( {x, y}\right)$ :

$$
f\left( {{x}_{i},{y}_{j}}\right)  = {f}_{ij}\;\left( {i = 0,1,\cdots , n;j = 0,1,\cdots , m}\right) . \tag{19.245}
$$

要求 $R$ 上可能简单的光滑曲面逼近点 (19.245).

##### 19.7.2.2 双三次插值样条

## 1. 性质

双三次插值样条 $S\left( {x, y}\right)$ 由下列性质唯一确定. (1) $S\left( {x, y}\right)$ 满足插值条件

$$
S\left( {{x}_{i},{y}_{j}}\right)  = {f}_{ij}\;\left( {i = 0,1,\cdots , n;j = 0,1,\cdots , m}\right) . \tag{19.246}
$$

(2) $S\left( {x, y}\right)$ 在矩形 $R$ 的每个子区域 ${R}_{ij}$ 恒等于一个双三次多项式,即在 ${R}_{ij}$ 有

$$
S\left( {x, y}\right)  = {S}_{ij}\left( {x, y}\right)  = \mathop{\sum }\limits_{{k = 0}}^{3}\mathop{\sum }\limits_{{l = 0}}^{3}{a}_{ijkl}{\left( x - {x}_{i}\right) }^{k}{\left( y - {y}_{j}\right) }^{l}, \tag{19.247}
$$

故 ${S}_{ij}\left( {x, y}\right)$ 由 16 个系数确定,而为了确定 $S\left( {x, y}\right)$ 需要 ${16mn}$ 个系数.

(3) 导数

$$
\frac{\partial S}{\partial x},\;\frac{\partial S}{\partial y},\;\frac{{\partial }^{2}S}{\partial x\partial y} \tag{19.248}
$$

在区域 $R$ 上是连续的,从而在整个曲面上保证某种光滑性.

(4) $S\left( {x, y}\right)$ 满足特殊的边界条件:

$$
\frac{\partial S}{\partial x}\left( {{x}_{i},{y}_{i}}\right)  = {p}_{ij},\;i = 0, n;\;j = 0,1,\cdots , m,
$$

$$
\frac{\partial S}{\partial y}\left( {{x}_{i},{y}_{i}}\right)  = {q}_{ij},\;i = 0,1,\cdots , n;\;j = 0, m, \tag{19.249}
$$

$$
\frac{{\partial }^{2}S}{\partial x\partial y}\left( {{x}_{i},{y}_{i}}\right)  = {r}_{ij},\;i = 0, n;\;j = 0, m,
$$

这里 ${p}_{ij},{q}_{ij},{r}_{ij}$ 是预先给定的值.

一维三次样条插值的结果可用来确定系数 ${a}_{ijkl}$ .

(1) 线性方程组的个数 ${2n} + m + 3$ 非常大,但其系数矩阵是三对角矩阵.

## (2)线性方程组仅右端项不同.

一般对于计算量和精度来说, 双三次插值样条是有用的. 故对于实际应用它们是合适的. 计算系数的实际方法见文献.

## 2. 张量积方法

双三次样条法 (19.247) 是形如

$$
S\left( {x, y}\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}\mathop{\sum }\limits_{{j = 0}}^{m}{a}_{ij}{g}_{i}\left( x\right) {h}_{j}\left( y\right)  \tag{19.250}
$$

的所谓张量积方法的一个例子. 该法特别适用于矩形网格上的逼近. 函数 ${g}_{i}\left( x\right) (i =$ $0,1,\cdots , n)$ 和 ${h}_{j}\left( x\right) \left( {j = 0,1,\cdots , m}\right)$ 组成两个线性无关的函数组. 从数值观点看张量积方法有大的优势, 例如二维插值问题 (19.246) 可以降为一维问题求解. 进一步说, 若:

(1) 函数 ${g}_{i}\left( x\right)$ 关于插值节点 ${x}_{0},{x}_{1},\cdots ,{x}_{n}$ 的一维插值问题,以及

(2) 函数 ${h}_{j}\left( x\right)$ 关于插值节点 ${y}_{0},{y}_{1},\cdots ,{y}_{m}$ 的一维插值问题都是唯一可解的, 则二维插值问题 (19.246) 用方法 (19.250) 唯一可解. 一个重要的张量积方法是使用三次 B 样条:

$$
S\left( {x, y}\right)  = \mathop{\sum }\limits_{{i = 1}}^{{r + 2}}\mathop{\sum }\limits_{{j = 1}}^{{p + 2}}{a}_{ij}{N}_{i,4}\left( x\right) {N}_{j,4}\left( y\right) , \tag{19.251}
$$

这里,函数 ${N}_{i,4}\left( x\right)$ 和 ${N}_{j,4}\left( y\right)$ 为 4 阶正规化 $\mathrm{B}$ 样条, $r$ 表示关于 $x$ 的节点个数, $p$ 表示关于 $y$ 的节点个数. 节点可自由选取,但其位置必须满足插值问题的某种可解性条件.

B 样条方法得到有带状结构系数矩阵的线性方程组, 这是对数值求解有用的结构.

用双三次 B 样条求解不同的插值问题见文献.

##### 19.7.2.3 双三次光滑样条

一维三次近似样条主要以最优条件 (19.242) 为特征. 对于二维情况可能有一整列相应的最优条件, 但是仅有很少特殊的情况可能存在唯一解. 用双三次 B 样条解逼近问题的适当的最优条件和算法见文献.

#### 19.7.3 曲线和曲面的伯恩斯坦-贝济埃表示

## 1. 伯恩斯坦-贝济埃多项式

曲线和曲面的伯恩斯坦-贝济埃 (Bernstein-Bézier) 表示 (简记 B-B 表示) 使用伯恩斯坦多项式

$$
{B}_{i, n}\left( t\right)  = \left( \begin{matrix} n \\  i \end{matrix}\right) {t}^{i}{\left( 1 - t\right) }^{n - i}\;\left( {i = 0,1,\cdots , n}\right)  \tag{19.252}
$$

并利用如下基本性质:

(1)

$$
0 \leq  {B}_{i, n}\left( t\right)  \leq  1,\;0 \leq  t \leq  1, \tag{19.253}
$$

(2)

$$
\mathop{\sum }\limits_{{i = 0}}^{n}{B}_{i, n}\left( t\right)  = 1 \tag{19.254}
$$

公式 (19.254) 由二项式定理 (参见第 14 页 1.1.6.4) 直接得到.

$\mathbf{A} : {B}_{01}\left( t\right)  = 1 - t,{B}_{1,1}\left( t\right)  = t$ (图 19.12).

$\mathbf{B} : {B}_{03}\left( t\right)  = {\left( 1 - t\right) }^{3},{B}_{1,3}\left( t\right)  = {3t}{\left( 1 - t\right) }^{2},{B}_{2,3}\left( t\right)  = 3{t}^{2}\left( {1 - t}\right) {B}_{3,3}\left( t\right)  = {t}^{3}$(图 19.13).

![01937d01-b6f6-7881-8294-3a9c82211946_65_571_210_498_442_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_65_571_210_498_442_0.jpg)

图 19.12

![01937d01-b6f6-7881-8294-3a9c82211946_65_590_745_459_427_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_65_590_745_459_427_0.jpg)

图 19.13

## 2. 向量表示

参数表达式为 $x = x\left( t\right) , y = y\left( t\right) , z = z\left( t\right)$ 的空间曲线记为向量形式

$$
\overrightarrow{r} = \overrightarrow{r}\left( t\right)  = x\left( t\right) {\overrightarrow{e}}_{x} + y\left( t\right) {\overrightarrow{e}}_{y} + z\left( t\right) {\overrightarrow{e}}_{z}, \tag{19.255}
$$

这里 $t$ 为曲线的参数. 相应的曲面表达式为

$$
\overrightarrow{r} = \overrightarrow{r}\left( {u, v}\right)  = x\left( {u, v}\right) {\overrightarrow{e}}_{x} + y\left( {u, v}\right) {\overrightarrow{e}}_{y} + z\left( {u, v}\right) {\overrightarrow{e}}_{z}. \tag{19.256}
$$

其中 $u$ 和 $v$ 为曲面参数.

##### 19.7.3.1 B-B 曲线表示的原理

设给定位置向量为 ${\overrightarrow{P}}_{i}$ 的三维多边形的 $n + 1$ 个顶点 ${P}_{i}\left( {i = 0,1,\cdots , n}\right)$ . 引入向量值函数

$$
\overrightarrow{r}\left( t\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}{B}_{i, n}\left( t\right) {\overrightarrow{P}}_{i}. \tag{19.257}
$$

由这些点确定的空间曲线称为 B-B 曲线. 由于 (19.254)、公式 (19.257) 可看作这些给定点的 “变量凸组合”. 三维曲线 (19.257) 有如下重要性质:

(1) ${P}_{0}$ 和 ${P}_{n}$ 为插值点.

(2) 向量 $\overrightarrow{{P}_{0}{P}_{1}}$ 和向量 $\overrightarrow{{P}_{n - 1}{P}_{n}}$ 为点 ${P}_{0}$ 和 ${P}_{n}$ 处 $\overrightarrow{r}\left( t\right)$ 的切线.

多边形与 B-B 曲线间的关系见图 19.14.

![01937d01-b6f6-7881-8294-3a9c82211946_66_558_352_523_344_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_66_558_352_523_344_0.jpg)

图 19.14

B-B 表示可用来设计曲线, 因为通过改变多边形的顶点容易改变曲线的形状.

常用正则化的 $\mathrm{B}$ 样条代替伯恩斯坦多项式.

相应的空间曲线称为 $\mathrm{B}$ 样条曲线. 其形状基本相应于有如下优点的 $\mathrm{B} - \mathrm{B}$ 曲线:

(1)更好逼近多边形.

(2) 若改变多边形顶点, 仅局部改变 $\mathrm{B}$ 样条曲线.

(3) 除局部改变曲线形状外, 也可能影响其可微性.

因此, 可能产生间断的点和线段.

##### 19.7.3.2 B-B 曲面表示

设给定位置向量为 ${\overrightarrow{P}}_{ij}$ 的点 ${P}_{ij}\left( {i = 0,1,\cdots , n;j = 0,1,\cdots , m}\right)$ ,可以考虑沿曲面参数曲线的网格节点. 类似于 B-B 曲线 (19.257), 对网格节点由

$$
\overrightarrow{r}\left( {u, v}\right)  = \mathop{\sum }\limits_{{i = 0}}^{n}\mathop{\sum }\limits_{{j = 0}}^{m}{B}_{i, n}\left( u\right) {B}_{j, m}\left( v\right) {\overrightarrow{P}}_{ij} \tag{19.258}
$$

确定曲面. 因为改变网格节点就能改变曲面, 表达式 (19.258) 对于曲面设计是有用的. 但是, 每个格点的影响是全局的, 故应该将伯恩斯坦多项式改为 (19.258) 中的 B 样条.

### 19.8 使用计算机

#### 19.8.1 内符号表示

计算机是用符号工作的机器. 解释和处理这些符号由软件确定和控制. 外符号、 字母、密码和特殊符号由内部的二进制代码按照存储单元序列的形式代表. 一个取值 0 和 1 的存储单元 (二进制数字) 是最小的可代表信息的单元. 八个存储单元构成下一个单位,即字节. 一个字节,可区分 ${2}^{8}$ 种存储单元组合,故可确定 256 个符号. 这样的指定称为代码. 有不同的代码, 最普及的是 ASCII (美国信息交换标准码).

##### 19.8.1.1 数制

## 1. 表示律

数在计算机里表示为一列连续字节. 内表示的基础是二进制, 这是类似于十进制的多元数制.

多元数制的表示律为

$$
a = \mathop{\sum }\limits_{{i =  - m}}^{n}{z}_{i}{B}^{i}\;\left( {m > 0, n \geq  0;m, n\text{ 为整数 }}\right) , \tag{19.259}
$$

其中 $B$ 为基数, ${z}_{i}\left( {0 \leq  {z}_{i} < B}\right)$ 为该数制的数码. $i \geq  0$ 的位置构成整数,而 $i < 0$ 的位置则为该数的小数部分.

数 139.8125 的十进制数表示,即 $B = {10}$ ,有形式

$$
{139.8125} = 1 \cdot  {10}^{2} + 3 \cdot  {10}^{1} + 9 \cdot  {10}^{0} + 8 \cdot  {10}^{-1} + 1 \cdot  {10}^{-2} + 2 \cdot  {10}^{-3} + 5 \cdot  {10}^{-4}.
$$

在表 19.3 中可见计算机里最常出现的数制.

表 19.3 数制

<table><tr><td>数制</td><td>基数</td><td>数码</td></tr><tr><td>二进制</td><td>2</td><td>0,1</td></tr><tr><td>八进制</td><td>8</td><td>0,1,2,3,4,5,6,7</td></tr><tr><td>十六进制</td><td>16</td><td>0,1,2,3,4,5,6,7,8,9, A, B, C, D, E, F (字母 A~F 赋值 10~15)</td></tr><tr><td>十进制</td><td>10</td><td>0,1,2,3,4,5,6,7,8,9</td></tr></table>

## 2. 转换

从一个数制到另一个数制的转变称为转换. 若同时使用不同的数制, 为了避免混乱用不同的下标表示基数.

十进制数 139.8125 的不同表示: ${139.8125}_{10} = {10001011.1101}_{2} = {213.64}_{8} =$8B.D16.

(1)二进制数转换为八进制或十六进制数转换为八进制或转换为八进制或十六进制数是非常简单的. 从二进制小数点出发向左和向右三位或四位构成一组, 确定其值. 这些值就是八进制或十六进制的数字.

(2)十进制数转换为二进制、八进制或十六进制数转换为别的数制, 对整数部分和分数部分分别应用如下规则:

a) 整数部分 若 $G$ 为十进制整数,则对基数为 $B$ 的数制,构造律 (19.259) 为

$$
G = \mathop{\sum }\limits_{{i = 0}}^{n}{z}_{i}{B}^{i}\;\left( {n \geq  0}\right) . \tag{19.260}
$$

若 $G$ 除以 $B$ ,则得到整数部分和余数:

$$
\frac{G}{B} = \mathop{\sum }\limits_{{i = 1}}^{n}{z}_{i}{B}^{i - 1} + \frac{{z}_{0}}{B}. \tag{19.261}
$$

这里 ${z}_{0}$ 的值可为 $0,1,\cdots , B - 1$ ,即要求的数的最低位数字. 若重复此法求商,便可得进一步的数字.

b) 分数部分 若 $g$ 是真分数,则将其转换为以 $B$ 为基数的数的方法为

$$
{gB} = {z}_{-1} + \mathop{\sum }\limits_{{i = 2}}^{m}{z}_{-i}{B}^{-i + 1}, \tag{19.262}
$$

即下一位数字可由乘积 ${gB}$ 的整数部分得到. 用同样的方式可得数值 ${z}_{-2},{z}_{-3},\cdots$ .

$\blacksquare \mathbf{A}$: 将十进制数 139 转化为二进制数

$\blacksquare \mathbf{B}$: 将小数 0.8125 转化为二进制数 ${139} : 2 = {69}$ 余数 $1\;\left( {1 = {z}_{0}}\right)$

$$
{0.8125} \cdot  2 = {1.625}\;\left( {1 = {z}_{-1}}\right)
$$

${69} : 2 = {34}$ 余数 $1\;\left( {1 = {z}_{1}}\right)$

$$
{0.625} \cdot  2 = {1.25}\;\left( {1 = {z}_{-2}}\right)
$$

${34} : 2 = {17}$ 余数 $0\;\left( {0 = {z}_{2}}\right)$

$$
{0.25} \cdot  2 = {0.5}\;\left( {0 = {z}_{-3}}\right)
$$

${17} : 2 = 8$ 余数 1 :

$$
{0.5} \cdot  2 = {1.0}\;\left( {1 = {z}_{-4}}\right)
$$

$8 : 2 = 4$ 余数 0 : ${0.0} \cdot  2 = {0.0}$

$4 : 2 = 2$ 余数 0 : ${0.8125}_{10} = {0.1101}_{2}$ $2 : 2 = 1$ 余数 0 :

$1 : 2 = 0$ 余数 $1\;\left( {1 = {z}_{7}}\right)$

${139}_{10} = {10001011}_{2}$

(3)二进制、八进制或十六进制数转换为十进制数 二进制、八进制或十六进制数转换为十进制数的算法如下:

$$
a\mathop{\sum }\limits_{{i =  - m}}^{n}{z}_{i}{B}^{i}\;\left( {m > 0, n \geq  0;m, n\text{ 为整数 }}\right) , \tag{19.263}
$$

其中十进制小数点在 ${z}_{0}$ 的后边.

转换计算用霍纳法则 (参见第 1237 页 19.1.2.1).

$$
{11101}_{2} = 1 \cdot  {2}^{4} + 1 \cdot  {2}^{3} + 1 \cdot  {2}^{2} + 0 \cdot  {2}^{1} + 1 = {29}.
$$

![01937d01-b6f6-7881-8294-3a9c82211946_68_1032_2009_332_196_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_68_1032_2009_332_196_0.jpg)

相应的霍纳格式见右边.

##### 19.8.1.2 内部数字表示 INR

二进制数在计算机里用一个或多个字节表示. 区别两种表示形式, 即定点数和浮点数. 第一种情况, 小数点在一个固定的位置; 第二种情况, 它随着指数的改变而浮动.

## 1. 定点数

带给定参数的定点数的范围为

$$
0 \leq  \left| a\right|  \leq  {2}^{t} - 1 \tag{19.264}
$$

定点数可用图 19.15 的形式表示.

![01937d01-b6f6-7881-8294-3a9c82211946_69_442_774_757_262_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_69_442_774_757_262_0.jpg)

图 19.15

## 2. 浮点数

基本上用两种不同的形式表示浮点数, 其内部完成可以详细改变.

(1)正规化半对数形式 在第一种形式中,数 $a$ 的指数 $E$ 和尾数 $M$ 的符号是分别存储的

$$
a =  \pm  M{B}^{\pm E}, \tag{19.265a}
$$

这里选取指数 $E$ 使得尾数

$$
1/B \leq  M < 1 \tag{19.265b}
$$

成立. 这称为正规化半对数形式 (图 19.16).

![01937d01-b6f6-7881-8294-3a9c82211946_69_454_1629_739_290_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_69_454_1629_739_290_0.jpg)

图 19.16

带给定参数的浮点数的绝对值范围是

$$
{2}^{-{2}^{p}} \leq  \left| a\right|  \leq  \left( {1 - {2}^{-t}}\right)  \cdot  {2}^{\left( {2}^{p} - 1\right) }. \tag{19.266}
$$

(2) IEEE 标准 浮点数的第二个 (目前使用的) 形式相应于 1985 年通过的 IEEE 标准. 它处理计算机算术、舍入行为、算术运算、数的转换、比较运算和处理如上溢和下溢的特殊情况等要求.

浮点数表示见图 19.17.

![01937d01-b6f6-7881-8294-3a9c82211946_70_409_407_824_281_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_70_409_407_824_281_0.jpg)

图 19.17

特征 $C$ 来自指数 $E$ 加上适当的常数 $K$ . 这样的选取使得特征只是正数,可表示的数为

$$
a = {\left( -1\right) }^{v} \cdot  {2}^{E} \cdot  1 \cdot  {b}_{1}{b}_{2}\cdots {b}_{t - 1}\text{,其中}E = C - K\text{.} \tag{19.267}
$$

因为保存 $C = 0, C = {255}$ ,这里 ${C}_{\min } = 1,{C}_{\max } = {256}$ .

该标准给出两个基本的表示形式 (单精度和双精度浮点数), 但也有其他的表示形式. 表 19.4 包含了基本形式的参数.

表 19.4 基本形式的参数

<table><tr><td>参数</td><td>单精度</td><td>双精度</td></tr><tr><td>存储单元字长</td><td>32</td><td>64</td></tr><tr><td>最大指数 ${E}_{\max }$</td><td>+127</td><td>+1023</td></tr><tr><td>最小指数 ${E}_{\min }$</td><td>-126</td><td>-1022</td></tr><tr><td>常数 $K$</td><td>+127</td><td>+1023</td></tr><tr><td>指数位数</td><td>8</td><td>11</td></tr><tr><td>尾数位数</td><td>24</td><td>53</td></tr></table>

#### 19.8.2 计算机计算中的数值问题

##### 19.8.2.1 引言、误差类型

计算机计算的一般性质与手工计算基本相同, 然而某些方面需要特别注意, 因为精度来自数的表示和关于计算机误差的判断. 更进一步, 计算机要比人类手工能做的实施多得多的计算步骤.

因此, 存在如何影响和控制误差的问题, 例如在数学上等价的方法中选用最适当的数值方法.

在后面的讨论中用到如下符号,其中 $x$ 表示在大多情况下未知的量的准确值, $\widetilde{x}$ 表示 $x$ 的近似值:

绝对误差 $\left| {\Delta x}\right|  = \left| {x - \widetilde{x}}\right|$ .(19.268)

相对误差 $\left| \frac{\Delta x}{x}\right|  = \left| \frac{x - \widetilde{x}}{x}\right|$ .(19.269)

记号

$$
\varepsilon \left( x\right)  = x - \widetilde{x}\;\text{ 和 }\;{\varepsilon }_{\text{rel }}\left( x\right)  = \frac{x - \widetilde{x}}{x} \tag{19.270}
$$

也经常用到.

##### 19.8.2.2 规范化十进制数和舍入

## 1. 规范化十进制数

每个实数 $x \neq  0$ 可表示为形如

$$
x =  \pm  0.{b}_{1}{b}_{2}\cdots {10}^{E}\;\left( {{b}_{1} \neq  0}\right)  \tag{19.271}
$$

的十进制数. 这里由数字 ${b}_{i} \in  \{ 0,1,2,\cdots ,9\}$ 构成的 $0.{b}_{1}{b}_{2}\cdots$ 称为尾数. 数 $E$ 为整数,是所谓关于基 10 的指数. 因为 ${b}_{1} \neq  0,\left( {19.271}\right)$ 称为正规十进制数.

因为真实的计算机只能处理有限多的字节,故必须限制尾数数字的固定数目 $t$ 和指数 $E$ 的固定范围. 故形如 (19.271) 的数根据舍入 (在实际计算中常用) 得到

$$
\widetilde{x} = \left\{  \begin{array}{ll}  \pm  0 \cdot  {b}_{1}{b}_{2}\cdots {b}_{t} \cdot  {10}^{E}, & {b}_{t + 1} < 5\left( \text{ 舍 }\right) , \\   \pm  \left( {0 \cdot  {b}_{1}{b}_{2}\cdots {b}_{t} + {10}^{-t}}\right) {10}^{E}, & {b}_{t + 1} \geq  5\left( \lambda \right) , \end{array}\right.  \tag{19.272}
$$

由舍入引起的绝对误差为

$$
\left| {\Delta x}\right|  = \left| {x - \widetilde{x}}\right|  \leq  {0.5} \cdot  {10}^{-t}{10}^{E}. \tag{19.273}
$$

## 2. 基本运算和数值计算

每个数值过程都是一系列基本运算. 特别用有限位浮点表示提出问题. 这里给出简要综述. 设 $x$ 和 $y$ 是非零的同号规范化无误差浮点数:

$$
x = {m}_{1}{B}^{{E}_{1}},\;y = {m}_{2}{B}^{{E}_{2}} \tag{19.274a}
$$

$$
{m}_{i} = \mathop{\sum }\limits_{{k = 1}}^{t}{a}_{-k}^{\left( i\right) }{B}^{-k},\;{a}_{-1}^{\left( i\right) } \neq  0, \tag{19.274b}
$$

$$
{a}_{-k}^{\left( i\right) } = 0\text{或 1 或}\cdots \text{或}B - 1,\;k > 1\;\left( {i = 1,2}\right) \text{.} \tag{19.274c}
$$

(1) 加法 若 ${E}_{1} > {E}_{2}$ ,因为正规化仅允许左移,则公共指数变为 ${E}_{1}$ . 随后尾数相加.

若

$$
{B}^{-1} \leq  \left| {{m}_{1} + {m}_{2}{B}^{-\left( {{E}_{1} - {E}_{2}}\right) }}\right|  < 2 \tag{19.275a}
$$

和

$$
\left| {{m}_{1} + {m}_{2}{B}^{-\left( {{E}_{1} - {E}_{2}}\right) }}\right|  \geq  1, \tag{19.275b}
$$

则将十进制小数点向左移一位而指数增加 1.

${0.9604} \cdot  {10}^{3} + {0.5873} \cdot  {10}^{2} = {0.9604} \cdot  {10}^{3} + {0.05873} \cdot  {10}^{3} = {1.01913} \cdot  {10}^{3} = {0.1019} \cdot  {10}^{4}\;.$

(2) 减法 如同在加法的情况均衡指数, 随后尾数相减. 若

$$
\left| {{m}_{1} - {m}_{2}{B}^{-\left( {{E}_{1} - {E}^{2}}\right) }}\right|  < 1 - {B}^{-t}, \tag{19.276a}
$$

以及

$$
\left| {{m}_{1} - {m}_{2}{B}^{-\left( {{E}_{1} - {E}^{2}}\right) }}\right|  < {B}^{-t}, \tag{19.276b}
$$

则将十进制小数点右移 $t$ 的最大值位,而指数相应减少.

I ${0.1004} \cdot  {10}^{3} - {0.9988} \cdot  {10}^{2} = {0.1004} \cdot  {10}^{3} - {0.09988} \cdot  {10}^{3} = {0.00052} \cdot  {10}^{3} = {0.5200} \cdot  {10}^{0}\;.$

此例显示了减法的临界情况. 因为位数有限 (这里是 4), 从右边引进零代替准确字符.

(3) 乘法 指数相加而尾数相乘, 若

$$
{m}_{1}{m}_{2} < {B}^{-1}, \tag{19.277}
$$

则十进制小数点向右移一位, 且指数减少 1.

$\left( {{0.1004} \cdot  {10}^{3}}\right)  \cdot  \left( {{0.2504} \cdot  {10}^{5}}\right)  = {0.07952704} \cdot  {10}^{8} = {0.7953} \cdot  {10}^{7}.$

(4)除法 指数相减而尾数相除. 若

$$
\frac{{m}_{1}}{{m}_{2}} \geq  1 \tag{19.278}
$$

则十进制小数点向左移一位, 且指数增加 1.

$\left( {{0.3176} \cdot  {10}^{3}}\right) /\left( {{0.2504} \cdot  {10}^{5}}\right)  = {1.2683706} \cdot  {10}^{-2} = {0.1268} \cdot  {10}^{-1}.$

(5) 结果的误差 在假定无误差项的四种基本运算中, 结果的误差是舍入误差. 对于位置为 $t$ 基为 $B$ 的数,相对误差的上限为

$$
\frac{B}{2}{B}^{-t}\text{.} \tag{19.279}
$$

(6) 减法相消 如上所述, 几乎相等的浮点数的减法是临界运算. 若有可能, 应通过改变运算阶或利用某种等式来避免这种情况.

$$
x = \sqrt{1985} - \sqrt{1984} = {0.4455} \cdot  {10}^{2} - {0.4454} \cdot  {10}^{2} = {0.1} \cdot  {10}^{-1}\text{或}
$$

$$
x = \sqrt{1985} - \sqrt{1984} = \frac{{1985} - {1984}}{\sqrt{1985} + \sqrt{1984}} = {0.1122} \cdot  {10}^{-1}.
$$

##### 19.8.2.3 数值计算的精度

## 1. 误差类型

数值方法有误差. 有几类误差, 最后结果的总误差正是由这些误差积累的 (图 19.18).

![01937d01-b6f6-7881-8294-3a9c82211946_73_307_480_1024_374_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_73_307_480_1024_374_0.jpg)

图 19.18

## 2. 输入误差

(1)输入误差的概念 输入误差是由不准确的输入数据产生的误差. 输入数据的轻微不准确称为扰动. 确定输入数据误差称为误差计算的直接问题. 其反问题如下: 输入数据可有多大的误差能够保证最终的输入误差不超过可以接受的允许值. 在相当复杂的问题里估计输入误差是非常困难且通常几乎是不可能的. 一般对实值函数 $y = f\left( \underline{\mathbf{x}}\right) ,\underline{\mathbf{x}} = {\left( {x}_{1},{x}_{2},\cdots ,{x}_{n}\right) }^{\mathrm{T}}$ ,若对 $y = f\left( \underline{\mathbf{x}}\right)  = f\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)$ 应用带线性余项的泰勒公式 (参见第 630 页 7.3.3.3), ${\xi }_{1},{\xi }_{2},\cdots ,{\xi }_{n}$ 表示中间值, ${\widetilde{x}}_{1},{\widetilde{x}}_{2},\cdots ,{\widetilde{x}}_{n}$ 表示 ${x}_{1},{x}_{2},\cdots ,{x}_{n}$ 的近似值,则输入误差的绝对值为

$$
\left| {\Delta y}\right|  = \left| {f\left( {{x}_{1},{x}_{2},\cdots ,{x}_{n}}\right)  - f\left( {{\widetilde{x}}_{1},{\widetilde{x}}_{2},\cdots ,{\widetilde{x}}_{n}}\right) }\right|
$$

$$
= \left| {\mathop{\sum }\limits_{{i = 1}}^{n}\frac{\partial f}{\partial {x}_{i}}\left( {{\xi }_{1},{\xi }_{2},\cdots ,{\xi }_{n}}\right) \left( {{x}_{i} - \widetilde{{x}_{i}}}\right) }\right|
$$

$$
\leq  \mathop{\sum }\limits_{{i = 1}}^{n}\left( {\mathop{\max }\limits_{x}\left| {\frac{\partial f}{\partial {x}_{i}}\left( \underline{\mathbf{x}}\right) }\right| }\right) \left| {\Delta {x}_{i}}\right| , \tag{19.280}
$$

近似值是扰动了的输入数据. 这里也考虑高斯误差传播定律 (参见第 1114 页 16.4.2.1).

(2)简单算术运算的输入误差 已知简单算术运算的输入误差. 对四种基本运算用 (19.268) (19.270) 的记号:

$$
\varepsilon \left( {x \pm  y}\right)  = \varepsilon \left( x\right)  \pm  \varepsilon \left( y\right) , \tag{19.281}
$$

$$
\varepsilon \left( {xy}\right)  = {y\varepsilon }\left( x\right)  + {x\varepsilon }\left( y\right)  + \varepsilon \left( x\right) \varepsilon \left( y\right) , \tag{19.282}
$$

$$
\varepsilon \left( \frac{x}{y}\right)  = \frac{1}{y}\varepsilon \left( x\right)  - \frac{x}{{y}^{2}}\varepsilon \left( y\right)  + \varepsilon \text{的高阶项,} \tag{19.283}
$$

$$
{\varepsilon }_{\text{rel }}\left( {x \pm  y}\right)  = \frac{{\varepsilon }_{\text{rel }}\left( x\right)  \pm  {\varepsilon }_{\text{rel }}\left( y\right) }{x \pm  y}, \tag{19.284}
$$

$$
{\varepsilon }_{\text{rel }}\left( {xy}\right)  = {\varepsilon }_{\text{rel }}\left( x\right)  + {\varepsilon }_{\text{rel }}\left( y\right)  + {\varepsilon }_{\text{rel }}\left( x\right) {\varepsilon }_{\text{rel }}\left( y\right) , \tag{19.285}
$$

$$
{\varepsilon }_{\text{rel }}\left( \frac{x}{y}\right)  = {\varepsilon }_{\text{rel }}\left( x\right)  + {\varepsilon }_{\text{rel }}\left( y\right)  + \varepsilon \text{的高阶项.} \tag{19.286}
$$

公式表明: 对于乘法和除法, 输入数据的相对误差小, 导致结果的相对误差也小. 对于加法和减法,若 $\left| {x \pm  y}\right|  \ll  \left| x\right|  + \left| y\right|$ ,相对误差可能非常大.

## 3. 方法的误差

(1)方法误差的记号 方法误差源于理论上连续的现象作为极限以不同的方式被数值逼近的事实. 因此, 在极限过程中有截断误差 (例如在迭代法中) 及在用有限离散系 (例如数值积分) 逼近连续现象时的离散误差. 方法误差与输入和舍入误差无关, 因此, 仅在关系到应用解法的方法论时研究方法误差.

(2) 应用迭代法 若使用迭代法, 可能出现两种情况: 得到问题的正确解或错误解. 也可能尽管有解但不能用迭代法得到.

为使迭代法更清晰安全, 应考虑如下建议:

a) 为避免 “无穷迭代”, 若步数超过预定值即停止过程 (即尚未达到要求的精度便停止).

b) 应在屏幕上以数值或者图表的形式跟踪中间结果的位置.

c) 应该用到解的所有已知性质如梯度、单调性等.

d) 应研究变量和函数计量的可能性.

e) 应通过改变步长、截断条件、初始值等进行多种试验.

4. 舍入误差

产生舍入误差是因为中间结果被舍入. 这对按精度要求判断数学方法时有本质的重要性. 舍入误差与输入误差和方法误差一起决定给定的方法是强稳定、弱稳定或不稳定. 若总误差随着步数增加分别减少、有相同的阶或增加, 便发生强稳定、弱稳定或不稳定.

在不稳定性方面, 我们区别舍入误差和离散误差 (数值不稳定) 以及理论上准确的计算中初始数据误差 (自然不稳定) 的灵敏度. 若数值不稳定不大于自然不稳定, 则计算过程是合适的.

对于舍入误差的局部误差传播, 即从一个计算步到下一步的误差传递, 可使用在输入误差中用过的同样的估计过程.

## 5. 数值计算的例子

上述某些问题用数值例子来说明.

$\blacksquare \mathbf{A}$: 二次方程的根 带实系数 $a, b, c$ 的二次方程 $a{x}^{2} + {bx} + c = 0, D =$ ${b}^{2} - {4ac} \geq  0$ (实根). 临界状态为

a) $\left| {4ac}\right|  \ll  {b}^{2}$ 和 b) ${4ac} \approx  {b}^{2}$ . 推荐程序:

i) ${x}_{1} =  - \frac{b + \operatorname{sign}\left( b\right) \sqrt{D}}{2a},\;{x}_{2} = \frac{c}{a{x}_{1}}$ (韦达根定理,参见第 56 页 1.6.3.1,3.).

ii) 用直接法难免把 $D$ 化零. 因为 $\left| b\right|  \gg  \sqrt{D}$ 成立,将发生减法抵消,除非 $\left( {b + \operatorname{sign}\left( {b\sqrt{D}}\right) }\right)$ 中误差不是太大.

$\blacksquare \mathbf{B}$: $h \leq  r$ 的薄锥壳的体积 因为 $\left( {r + h}\right)  \approx  r, V = {4\pi }\frac{{\left( r + h\right) }^{3} - {r}^{3}}{3}$ 存在减法消去的情况. 而在等式 $V = {4\pi }\frac{3{r}^{2}h + {3r}{h}^{2} + {h}^{3}}{3}$ 中则没有这个问题.

$\blacksquare \mathbf{C}$: 求和 $S = \mathop{\sum }\limits_{{k = 1}}^{\infty }\frac{1}{{k}^{2} + 1}\left( {S = {1.07667}\cdots }\right)$ 要求有三位有效数字的精度. 用 8 位数字进行计算,大约需要加 6000 项. 在作恒等变换 $\frac{1}{{k}^{2} + 1} = \frac{1}{{k}^{2}} - \frac{1}{{k}^{2}\left( {{k}^{2} + 1}\right) }$ 后, 成立

$$
S = \mathop{\sum }\limits_{{k = 1}}^{\infty }\frac{1}{{k}^{2}} - \mathop{\sum }\limits_{{k = 1}}^{\infty }\frac{1}{{k}^{2}\left( {{k}^{2} + 1}\right) }\text{ 及 }S = \frac{{\pi }^{2}}{6} - \mathop{\sum }\limits_{{k = 1}}^{\infty }\frac{1}{{k}^{2}\left( {{k}^{2} + 1}\right) }.
$$

通过这一变换后, 则只需考虑 8 项.

$\blacksquare \mathbf{D}$: 避免 $\frac{0}{0}$ 的状态 当 $x = y = 0$ 时,函数 $z = \left( {1 - \sqrt{1 + {x}^{2} + {y}^{2}}}\right) \frac{{x}^{2} - {y}^{2}}{{x}^{2} + {y}^{2}}$ . 分子和分母同时乘以 $\left( {1 + \sqrt{1 + {x}^{2} + {y}^{2}}}\right)$ 即可避免这一状态.

$\blacksquare \mathbf{E}$: 不稳定递推过程的例子 若满足条件 $\left| {\frac{a}{2} \pm  \sqrt{\frac{{a}^{2}}{4} + b}}\right|  < 1$ ,则一般形式的算法 ${y}_{n + 1} = a{y}_{n} + b{y}_{n - 1}\left( {n = 1,2,\cdots }\right)$ 是稳定的. 特殊情况 ${y}_{n + 1} =  - 3{y}_{n} +$ $4{y}_{n - 1}\left( {n = 1,2,\cdots }\right)$ 是不稳定的. 若 ${y}_{0}$ 和 ${y}_{1}$ 有误差 $\varepsilon$ 和 $- \varepsilon$ ,则对 ${y}_{2},{y}_{3},{y}_{4},{y}_{5}$ , ${y}_{6},\cdots$ 误差为 ${7\varepsilon }, - {25\varepsilon },{103\varepsilon }, - {409\varepsilon },{1639\varepsilon },\cdots$ ,该过程对于参数 $a =  - 3$ 与 $b = 4$ 是不稳定的.

$\blacksquare \mathbf{F}$: 微分方程的数值求积 数值求解一阶常微分方程

$$
{y}^{\prime } = f\left( {x, y}\right) ,\;\text{ 其中 }f\left( {x, y}\right)  = {ay}, \tag{19.287}
$$

其初值用 $y\left( {x}_{0}\right)  = {y}_{0}$ 表示.

a) 天然不稳定 准确解 $y\left( x\right)$ 有准确初值 $y\left( {x}_{0}\right)  = {y}_{0}$ ,设 $u\left( x\right)$ 为扰动初值的解. 不失一般性, 设扰动解形如:

$$
u\left( x\right)  = y\left( x\right)  + {\varepsilon \eta }\left( x\right) , \tag{19.288a}
$$

其中 $\varepsilon \left( {0 < \varepsilon  < 1}\right)$ 为参数,而 $\eta \left( x\right)$ 是所谓扰动函数. 考虑 ${u}^{\prime }\left( x\right)  = f\left( {x, u}\right)$ 从泰勒展开式得到 (参见第 630 页 7.3.3.3)

$$
{u}^{\prime }\left( x\right)  = f\left( {x, y\left( x\right)  + {\varepsilon \eta }\left( x\right) }\right)  = f\left( {x, y}\right)  + {\varepsilon \eta }\left( x\right) {f}_{y}\left( {x, y}\right)  + \text{ 高阶项. } \tag{19.288b}
$$

这意味着微分变差方程

$$
{\eta }^{\prime }\left( x\right)  = {f}_{y}\left( {x, y}\right) \eta \left( x\right) . \tag{19.288c}
$$

由 $f\left( {x, y}\right)  = {ay}$ ,问题的解为

$$
\eta \left( x\right)  = {\eta }_{0}{\mathrm{e}}^{a\left( {x - {x}_{0}}\right) },\;\text{ 其中 }{\eta }_{0} = \eta \left( {x}_{0}\right) . \tag{19.288d}
$$

对 $a > 0$ ,即便是小的初始扰动 ${\eta }_{0}$ 也导致无限增长的扰动 $\eta \left( x\right)$ . 故为天然不稳定.

b) 梯形公式的误差研究 当 $a =  - 1$ 时,稳定的微分方程 ${y}^{\prime }\left( x\right)  =  - y\left( x\right)$ 有准确解

$$
y\left( x\right)  = {y}_{0}{\mathrm{e}}^{a\left( {x - {x}_{0}}\right) },\;\text{ 其中 }{y}_{0} = y\left( {x}_{0}\right) . \tag{19.289a}
$$

梯形公式为

$$
{\int }_{{x}_{i}}^{{x}_{i + 1}}y\left( x\right) \mathrm{d}x \approx  \frac{{y}_{i} + {y}_{i + 1}}{2}h,\;\text{ 其中 }h = {x}_{i + 1} - {x}_{i}. \tag{19.289b}
$$

对给定微分方程用上述公式, 成立

$$
{\widetilde{y}}_{i + 1} = {\widetilde{y}}_{i} + {\int }_{{x}_{i}}^{{x}_{i + 1}}\left( {-y}\right) \mathrm{d}x = {\widetilde{y}}_{i} - \frac{{\widetilde{y}}_{i} + {\widetilde{y}}_{i + 1}}{2}h,\;{\widetilde{y}}_{i + 1} = \frac{2 - h}{2 + h}{\widetilde{y}}_{i},
$$

$$
{\widetilde{y}}_{i} = {\left( \frac{2 - h}{2 + h}\right) }^{i}{\widetilde{y}}_{0} \tag{19.289c}
$$

其中 ${x}_{i} = {x}_{0} + {ih}$ ,即对 $0 \leq  h < 2$ 有 $i = \left( {{x}_{i} - {x}_{0}}\right) /h$ ,得到

$$
{\widetilde{y}}_{i} = {\left( \frac{2 - h}{2 + h}\right) }^{\left( {{x}_{i} - {x}_{0}}\right) /h}{\widetilde{y}}_{0} = {\widetilde{y}}_{0}{\mathrm{e}}^{c\left( h\right) \left( {{x}_{i} - {x}_{0}}\right) },
$$

$$
c\left( h\right)  = \frac{\ln \left( \frac{2 - h}{2 + h}\right) }{h} =  - 1 - \frac{{h}^{2}}{12} - \frac{{h}^{4}}{80} - \cdots . \tag{19.289d}
$$

若 ${\widetilde{y}}_{0} = {y}_{0}$ ,则 ${\widetilde{y}}_{i} < {y}_{i}$ ,且对 $h \rightarrow  0,{\widetilde{y}}_{i}$ 也趋向于准确解 ${y}_{0}{\mathrm{e}}^{-\left( {{x}_{i} - {x}_{0}}\right) }$ .

c) 在 b) 中的输入误差 设准确和近似的初值相同. 现研究当 ${\widetilde{y}}_{0} \neq  {y}_{0}$ 及 $\left| {{\widetilde{y}}_{0} - {y}_{0}}\right|  < {\varepsilon }_{0}$ 时的性态.

因为 $\left( {{\widetilde{y}}_{i + 1} - {y}_{i + 1}}\right)  \leq  \frac{2 - h}{2 + h}\left( {{\widetilde{y}}_{i} - {y}_{i}}\right)$ ,有

$$
\left( {{\widetilde{y}}_{i + 1} - {y}_{i + 1}}\right)  \leq  {\left( \frac{2 - h}{2 + h}\right) }^{i + 1}\left( {{\widetilde{y}}_{0} - {y}_{0}}\right) , \tag{19.290a}
$$

故 ${\varepsilon }_{i + 1}$ 最多和 ${\varepsilon }_{0}$ 同阶,且该方法关于初值是稳定的. 应该提到,在用辛普森方法求解上述微分方程时引进了人为的不稳定. 此时,对 $h \rightarrow  0$ ,得到通解如:

$$
{\widetilde{y}}_{i} = {C}_{1}{\mathrm{e}}^{-{x}_{i}} + {C}_{2}{\left( -1\right) }^{i}{\mathrm{e}}^{{x}_{i}/3}. \tag{19.290b}
$$

问题是该数值解法使用了比相应的微分方程的阶更高阶的差分.

#### 19.8.3 数值方法图书馆

一些年来, 用不同语言的数值方法互相独立地发展了函数与程序的图书馆. 因为在其发展中考虑了大量的计算经验, 故在求解实际数值问题时需要选用其中一个程序图书馆. 对现有的运行系统如 WINDOWS, UNIX 和 LINUX, 以及绝大多数类型的计算问题, 都有可用的程序, 它们保持某种约定, 故或多或少易于使用.

应用程序图书馆中的数值方法并不能减少用户对于理想结果思考的必要性. 提醒用户应该知道要用的数学方法的优点、缺点和弱点.

##### 19.8.3.1 NAG 图书馆

NAG 图书馆 (数值算法组) 是用 FORTRAN 77, FORTRAN 90 和 C 等编程语言编写的函数与子函数/程序的数值方法的丰富集成. 这里是内容概况:

1. Komplexe Arithmetik 14. Eigenwerte und Eigenvektoren

2. Nullstellen von Polynomen 15. Determinanten

3. Wurzeln transzendenter Gleichun- 16. Simultane lineare Gleichungen

gen 17. Orthogonalisierung

4. Reihen 18. Lineare Algebra

5. Integration 19. Einfache Berechnng. von statist.

6. Gewöhnliche Differentialgleichun- Daten

gen 20. Korrelation und Regressionsanal-

7. Partielle Differentzalgleichungen yse

8. Numerische Differentzation 21. Zufallszahlengeneratoren

9. Integralgleichungen 22. Nichtparametrische Statistik

10. Interpolation 23. Zeitreihenanalyse

11. Approxim. v. Daten d. Kurven 24. Operationsforschung

und Flächen 25. Spezielle Funktionen

12. Minima/Maxima einer Funktion 26. Mathem. und Maschinenkonstan-

13. Matrixoperationen, Inversion ten

此外, NAG 图书馆还包含涉及统计和金融数学的大量软件.

##### 19.8.3.2 IMSL 图书馆

IMSL 图书馆 (国际数学和统计图书馆) 同时包含三部分:

一般数学方法,

统计问题,

特殊函数.

子图书馆包含用 FORTRAN 77, FORTRAN 90 和 C 编写的函数和子程序, 这里是内容概况:

## 一般数学方法

1. Lineare Systeme 8. Optimierung 2. Eigenwerte 9. Vektor-und Matrixoperationen 3. Interpolation und Approximation 10. Ellipische Funktionen, Funktionen 4. Integration und Differentzation von Weierstrass und verwandte 5. Differentzalgleichungen Funktionen 6. Transformationen 11. Wahrscheinlichkeitsverteilungen 7. Nichtlineare Gleichungen 12. Verschiedene Funktionen

## 统计问题

1. Grundlegende Kennzahlen

2. Regression

3. Korrelation

4. Varianzanalyse

5. Kategoriale und diskrete Daten-

analyse

6. Nichtparametrische Statistik

7. Anpassungstests und Test auf

Zufälligkeit

8. Zeitreihenanalyse und Vorhersage

9. Kovarianz-und Faktoranalyse

10. Diskriminanz-Analyse

11. Cluster-Analyse

12. Stichprobenerhebung

13. Lebensdauerverteilgn. und Zu-

verlässigkt.

14. Mehrdimensionale Skalierung

15. Schätzung der Dichte-und Hasard-

bzw. Risikofunktion

16. Zeilendrucker-Grapfik

17. Wahrscheinlichkeitsverteilungen

18. Zufallszahlen-Generatoren

19. Hilfsalgorithmen

20. Mathematische Hilfsmittel

## 特殊函数

1. Elementare Funktionen

2. Trigonometrische und hyperbolis-

che Funktionen

3. Exponentialfunktion und ver-

wandte

4. Gamma-Funktionen und ver-

wandte

5. Fehler-Funktionen und verwandte

6. Bessel-Funktionen

7. Kelvin-Funktionen

8. Bessel-Funktionen gebrochener

Ordnung

9. Elliptische Integrale von Weier-

strass und verwandte Funktionen

10. Verschiedene Funktionen

##### 19.8.3.3 Aachen 图书馆

Aachen 图书馆以 G. Engeln-Mullges (Fachhochschule Aachen) 和 F. Reutter (Rheinisch-Westfalische Technische Hochschule Aachen) 收集的数值方法公式为基础. 它使用 BASIC, QUICKBASIC, FORTRAN 77, FORTRAN 90, C, MODULA 2 和 TURBO PASCAL 等程序语言. 主要包括:

1. Numerische Verfahren zur Lösung nichtlinearer und speziell algebraischer Gleichungen

2. Direkte und iterative Verfahren zur Lösung linearer Gleichungssysteme

3. Systeme nichtlinearer Gleichungen

4. Eigenwerte und Eigenvektoren von Matrizen

5. Lineare und nichtlineare Approximation

6. Polynomiale und rationale Interpolation sowie Polynomsplines

7. Numerische Differentiation

8. Numerische Quadratur und Kubatur

9. Anfangswertprobleme bei gewöhnlichen Differentialgleichungen

10. Randwertprobleme bei gewöhnlichen Differentialgleichungen

Aachen 图书馆的程序特别适于研究数值数学的单个算法.

#### 19.8.4 交互程序系统和计算机代数系统的应用

##### 19.8.4.1 Matlab

商用程序系统 Matlab (矩阵实验室) 是一个数学求解公式问题的交互环境, 同时也是科学技术计算的高级原本语言. 优先设置线性代数的问题和算法. Matlab 很方便地将实现数值程序及数据和结果的先进的图形表示统一起来. 根据 IEEE 标准 (表 19.4) 计算大多以双精度浮点数运行. 能与 Matlab 兼容的进一步的选择是可免费下载的 Scilab 和 Octave 系统.

## 1. 函数概述

下面是 Matlab 中程序和函数的简要概述.

Allgemeine mathematische Funktionen

1. Trigonometrie 5. Koordinatentransformationen 2. Exponentialfunktion, Logarith- 6. Rundung und gebrochener Teil men 3. Spezielle Funktionen 7. Diskrete Mathematik 4. Komplexe Arithmetik 8. Mathematische Konstanten

1. Manipulation von Feldern und

Matrizen

2. Spezielle Matrizen

3. Matrix-Analysis (Normen, Kondi-

tion)

4. Lineare Gleichungssysteme

---

5. Eigenwerte und Singulärwerte

6. Matrix-Faktorisierungen

7. Matrixfunktionen

8. Verfahren für dünn besetzte Ma-trizen

---

## Numerische Verfahren

1. Berechnung statistischer Daten 7. Ermittlung der konvexen Hülle 2. Korrelation und Regression 8. Numerische Integration 3. Diskrete Fouriertransformation 9. Gewöhnliche Differentialgleichun- 4. Polynome und Splines gen 5. Ein- und mehrdimensionale Inter- 10. Partielle Differentialgleichungen polation 11. Nichtlineare Gleichungen 6. Triangulationen und Zerlegungen 12. Minimierung von Funktionen

此外, Matlab 有许多用来求解不同类型的特殊数学问题的程序包, 即所谓工具箱. 作为某些例子, 这里提到曲线拟合、滤波器、商业数学、时间序列分析、信号和模式处理、神经网络、优化、偏微分方程、样条、统计和小波.

在下面的段落中, 以简单的例子来说明 Matlab 的应用. 在后面 Mathematica 和 Maple 的数值应用中, 将同样讨论这些问题.

## 2. 数值线性代数

在开启 Matlab 命令提示符 “>>” 后, 命令窗口显示等待接受命令. 若命令不以分号 “; ” 结束,则在命令窗口出现结果. 求解线性方程组 $\mathbf{A}\underline{\mathbf{x}} = \underline{\mathbf{b}}$ 的基本命令 (参见第 1242 页 19.2.1) 是反斜杠算符 “\\”.

■ 给定矩阵 $\mathbf{A} = \left( \begin{array}{lll} 1 & 0 & 3 \\  2 & 1 & 1 \\  1 & 2 & 3 \end{array}\right)$ 和向量 $\underline{b} = {\left( -2,3,2\right) }^{\mathrm{T}}$ . 输入

$A = \left\lbrack  {\begin{array}{lll} 1 & 0 & 3 \end{array};\begin{array}{lll} 2 & 1 & 1 \end{array};\begin{array}{lll} 1 & 2 & 3 \end{array}}\right\rbrack  ,\;b = \left\lbrack  {-2;3;2}\right\rbrack  ,\;x = A \smallsetminus  b,\;\operatorname{norm}\left( {A * x - b}\right)$

输出为

$$
\begin{array}{l} A = \begin{array}{rrrrrrrrr} 1 & 0 & 3 & & &  - 2 & & & {1.0000} \\  2 & 1 & 1 & b = & 3 & x = & {2.0000} & \text{ ans } = {8.8818} & \\  1 & 2 & 3 & & & 2 & &  - {1.0000} &  \end{array}\text{ ans } = {8.8818}\mathrm{e} - {016} \\  \end{array}
$$

残量的欧几里得范数表明, 得到的解 (并未显示所有的数字) 以允许的计算机浮点数表示的精度满足方程组.

若矩阵 $\mathbf{A}$ 是非奇异的方阵,则线性方程组有唯一解. 由反斜杠算符 “\\” 用通常的列主元高斯消元法,得三角分解 $\mathbf{{PA}} = \mathbf{{LA}}$ (参见第 1242 页 19.2.1.1). - 矩阵 $\mathbf{A}$ 的三角分解也可由输入

$$
>  > \left\lbrack  {\mathrm{L},\mathrm{R},\mathrm{P}}\right\rbrack   = \operatorname{lu}\left( \mathrm{A}\right)
$$

实现. 得到输出

$$
\mathrm{L} = \left( \begin{array}{rrr} {1.0000} & 0 & 0 \\  {0.5000} & {1.0000} & 0 \\  {0.5000} &  - {0.3333} & {1.0000} \end{array}\right) ,\;\mathrm{R} = \left( \begin{array}{rrr} {2.0000} & {1.0000} & {1.0000} \\  0 & {1.5000} & {2.5000} \\  0 & 0 & {3.3333} \end{array}\right) ,
$$

$$
P = \left( \begin{array}{lll} 0 & 1 & 0 \\  0 & 0 & 1 \\  1 & 0 & 0 \end{array}\right)
$$

(这里为了避免混乱用括号表示矩阵).

反斜杠算符首先测试系数矩阵 $\mathbf{A}$ 的性质,若 $\mathbf{A}$ 是一个三角矩阵排列,则求解相应的梯队形式. 若是对称矩阵 $\mathbf{A}$ ,则应用楚列斯基方法 (参见第 1245 页 19.2.1.2).

若系数矩阵 $\mathbf{A}$ 的条件数太大,则求解时可能产生数值问题. 因此在 Matlab 运行期间, 估计条件数的倒数值, 若此数过小, 给出警告提示.

$n = {13}$ 阶的希尔伯特矩阵可作为例子,其中 ${h}_{ik} = 1/\left( {i + k - 1}\right)$ .

$\gg  \mathrm{x} = \operatorname{hilb}\left( {13}\right)  \smallsetminus$ ones(13,1);

Warning: Matrix is close to singular or badly scaled.

Results may be inaccurate. RCOND $= {2.409320}\mathrm{e} - {017}$ .

在超定线性方程组的情况下, 相应的线性拟合问题由正交化过程处理, 即由正交变换得到 ${QR}$ 分解

$$
\mathbf{A} = \mathbf{{QR}}
$$

(参见第 1246 页 19.2.1.3).

$A = \left\lbrack  {\begin{array}{lll} 1 & 0 & 3 \end{array};\begin{array}{lll} 2 & 1 & 1 \end{array};\begin{array}{lll} 1 & 2 & 3 \end{array};\begin{array}{lll} 1 & 1 &  - 1 \end{array}}\right\rbrack  ;\;b = \left\lbrack  {-2;3;2;1}\right\rbrack  ;\;x = A \smallsetminus  b,$

$$
\operatorname{norm}\left( {\mathrm{A} * \mathrm{x} - \mathrm{b}}\right)
$$

0.4673

$\mathrm{x} = {1.4393}\;$ ans $= {2.0508}$

-0.4953

$$
>  > \left\lbrack  {\mathrm{Q},\mathrm{R}}\right\rbrack   = \operatorname{qr}\left( \mathrm{A}\right)
$$

$$
Q = \left( \begin{array}{rrrr}  - {0.3780} &  - {0.4583} & {0.6466} & {0.4785} \\   - {0.7559} &  - {0.2750} &  - {0.2321} &  - {0.5469} \\   - {0.3780} & {0.8250} & {0.4145} &  - {0.0684} \\   - {0.3780} & {0.1833} &  - {0.5969} & {0.6836} \end{array}\right) ,
$$

$$
R = \left( \begin{array}{rrr}  - {2.6458} &  - {1.8898} &  - {2.6458} \\  0 & {1.5584} & {0.6417} \\  0 & 0 & {3.5480} \\  0 & 0 & {3.5480} \end{array}\right)
$$

反斜杠算符也对欠定和缺秩的线性方程组给出了有意义的结果. 如何处理大型稀疏矩阵的方法的详细介绍可见相应的 Matlab 文件和说明 [19.15],[19.30].

## 3. 方程的数值求解

在 Matlab 中用行向量 $\left( {{a}_{n},{a}_{n - 1},\cdots ,{a}_{1},{a}_{0}}\right)$ 表示多项式

$$
p\left( x\right)  = {a}_{n}{x}^{n} + {a}_{n - 1}{x}^{n - 1} + \cdots  + {a}_{1}x + {a}_{0}
$$

的系数. 有多个函数可用来处理多项式.

作为例子,确定多项式 $p\left( x\right)  = {x}^{6} + 3{x}^{2} - 5$ 在 1 处的值、导数 (即导数多项式的系数向量) 及根.

$>  > \mathrm{p} = \left\lbrack  \begin{array}{lllllll} 1 & 0 & 0 & 0 & 3 & 0 &  - 5 \end{array}\right\rbrack  ;$

$>  >$ polyval(p,1)ans $=  - 1$

$\gg$ polyder(p)ans $= {600060}$

$\gg$ roots(p) ans $= {0.8673} + {1.1529}\mathrm{i},{0.8673} - {1.1529}\mathrm{i},{1.0743}$ ,

$$
- {0.8673} + {1.1529i}, - {0.8673} - {1.1529i}, - {1.0743}
$$

根作为相应伴随矩阵的特征值被确定. 命令 fzero 用来求非线性标量方程的近似解.

1 计算方程 ${\mathrm{e}}^{-{x}^{3}} - 4{x}^{2} = 0$ 的三个解.

$>  > \operatorname{fzero}\left( {\left( a\right) \exp \left( {-{x}^{ \land  }}\right)  - 4 * {x}^{ \land  }2,1}\right)$ ans $= {0.4741}$

$\gg  \operatorname{fzero}\left( {@\left( x\right) \exp \left( {-{x}^{ \land  }}\right)  - 4 * {x}^{ \land  }2,0}\right)$ ans $=  - {0.5413}$

$\gg  \operatorname{fzero}\left( {@\left( x\right) \exp \left( {-{x}^{ \land  }}\right)  - 4 * {x}^{ \land  }2, - 1}\right)$ ans $=  - {1.2085}$

在命令 fzero 下输入方程作为未命名的函数. 显然它依赖于第二个变量的给定初值, 其解是近似的. 迭代过程用二分法和试位法的组合完成 (参见第 1236 页 19.1.1.3).

4. 插值

基于给定数据的函数拟合可以通过插值 (参见第 1276 页 19.6.1) 或最佳函数逼近 (参见第 1280 页 19.6.2.2) 得到. 在 Matlab 中, 命令 plot 是以图形表示数据集合的最简单的方式. 在自打开图表窗口的菜单中包含编辑图形 (线型、符号、标题和说明) 的工具, 用于输出和打印基本拟合.

基本拟合是工具箱的子程序, 提供了多种插值方法和不同阶的最佳逼近多项式. 由函数 “interp1” 和 “polyfit” 来实现.

## 根据输入

$\gg$ plot $\left( {\lbrack {1.70045},\;{1.2523},\;{0.638803},\;{0.423479},\;{0.249091},\;{0.160321},}\right.$

${0.0883432},{0.0570776},{0.0302744},{0.0212794}\rbrack );$

数据值被置于数据位置 $1,2,\cdots ,{10}$ 且用图形表示. 图 ${19.19}\left( \mathrm{a}\right)$ 展示了相应的三次插值样条和四阶最佳逼近多项式的数据集.

![01937d01-b6f6-7881-8294-3a9c82211946_83_187_463_1262_492_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_83_187_463_1262_492_0.jpg)

图 19.19

函数 interp2 提供在二维矩形网格上给定数据作插值的适当方法 (参见第 1295 页 19.7.2.1). 对于非规则分布的数据作插值调用 griddata.

## ☐ 命令序列

$>  > \left\lbrack  {X, Y}\right\rbrack   =$ meshgrid $\left( {-2 : 1 : 2}\right) ;F = 4 - \operatorname{sqrt}\left( {{16} - X \cdot  2 - Y \cdot  2}\right)$ ;

$\gg  \left\lbrack  {\mathrm{{Xe}},\mathrm{{Ye}}}\right\rbrack   =$ meshgrid $\left( {-2 : {0.1} : 2}\right) ;\mathrm{S} = \operatorname{interp2}\left( {\mathrm{X},\mathrm{Y},\mathrm{F},\mathrm{{Xe}},\mathrm{{Ye}},{}^{\prime }{\mathrm{{spline}}}^{\prime }}\right)$ ;

$>  > \operatorname{surf}\left( {\mathrm{{Xe}},\mathrm{{Ye}},\mathrm{S}}\right)$

$\gg$ hold on; stem3(X, Y, F,'fill')

实现了函数 $f\left( {x, y}\right)  = \sqrt{{16} - {x}^{2} - {y}^{2}}$ 在给定网格上的二元三次样条插值. 插值样条在较细的矩形网格上求值. 图 19.19(b) 描绘了插值函数而且也显示了数据点.

5. 数值积分

在 Matlab 中程序 quad 和 quadl 可用于数值积分. 这两个程序基于自适应选取步长递归应用插值求积. Quad 基于辛普森公式, quadl 应用高阶洛巴托公式 (参见第 1253 页 19.3.2). 在被积函数充分光滑的情况及较高的精度要求下, quadl 比 quad 更有效.

作为第一个例子,考虑近似计算定积分 $I = {\int }_{0}^{1}\frac{\sin x}{x}\mathrm{\;d}x$ (正弦积分参见第 681 页 8.2.5,1.).

$\gg$ format long; [I, fwerte]=quad(@(x)(sin(x)./x),0,1)

Warning: Divide by zero. $> \operatorname{In}@\left( x\right) \left( {\sin \left( x\right) ./x}\right) \operatorname{In}$ quad at 62

$I = {0.94608307007653}$ fwerte $= {14}$

$\gg$ format long; [I, fwerte]=quadl((@(x)(sin(x)./x),0,1) Warning: Divide by zero. $> \operatorname{In}@\left( x\right) \left( {\sin \left( x\right) ./x}\right) \operatorname{In}$ quadl at 64 $I = {0.94608307036718}$ fwerte $= {19}$

两个程序显然都认知被积函数在区间左端的不连续性, 但得到积分的近似值并无困难. 基于同一例子在 1257 页 19.3.4.2 中的结果, 函数求值的数目看来很大, 但可自适应递归确定.

$\gg$ format long; $\left\lbrack  {I,\text{fwerte}}\right\rbrack   = \operatorname{quad}\left( {Q\left( x\right) \left( {\sin \left( x\right) ./x}\right) ,0,1,{1e} - {14}}\right)$

$I = {0.94608307036718}$ fwerte $= {258}$

$\gg$ format long; [I, fwerte]=quadl(( $@\left( x\right) \left( {\sin \left( x\right) ./x}\right) ,0,1,1\mathrm{e} - {14}$ )

$I = {0.94608307036718}$ fwerte $= {19}$

(这里没有重复警告信息). 作为进一步的论证给出确定的精度为 ${10}^{-{14}}$ (容忍误差为 ${10}^{-6}$ ),在这一情况下显然可见 quad1 的优越性.

I 确定定积分 $I = {\int }_{-{1000}}^{1000}{\mathrm{e}}^{-{x}^{2}}\mathrm{\;d}x$ . >> format long; [I, fwerte]=quad(@(x)(exp(-x.^2)),-1000,1000,1e-10) $I = {1.77245385094233}$ fwerte $= {585}$

$\gg$ format long; [I, fwerte]=quadl((@(x)(exp(-x.^2)),-1000,1000,1e-10) $I = {1.77245385090571}$ fwerte $= {768}$

被积函数在积分区间的非常宽广的部分形状平坦,而在 $x = 0$ 处有相当陡峭的峰值, 使得 quad 在这一情况下较好.

## 6. 微分方程的数值解

Matlab 提供了许多数值求解一阶常微分方程初值问题的程序. 标准的程序为 ode45, 其中应用带自适应步长选取的 4 阶和 5 阶龙格-库塔法 (参见第 1260 页 19.4.1.2). 为达到高精度, 使用预估-校正型线性多步法的程序 ode113 更有效 (参见第 1262 页 19.4.1.4). 此外, 还有些程序对刚性微分方程组特别有效 (参见第 1264 页 19.4.1.5,4.).

I 用龙格-库塔法 (参见第 1260 页 19.4.1.2) 求解区间 $\left\lbrack  {0,1}\right\rbrack$ 上的问题 ${y}^{\prime } = \frac{1}{4}\left( {{x}^{2} + }\right.$ $\left. {y}^{2}\right) , y\left( 0\right)  = 0$ ,输入:

$\gg  \left\lbrack  {x, y}\right\rbrack   = \operatorname{ode45}\left( {\left( {x, y}\right) \left( {\left( {x{.}^{2} + y{.}^{2}}\right) ./4}\right) ,\left\lbrack  \begin{array}{ll} 0 & 1 \end{array}\right\rbrack  ,0}\right) ;\operatorname{plot}\left( {x, y}\right)$

得到的解如图 19.20(a) 所示.

在区间 $0 \leq  t \leq  {50}$ 上求解特殊的洛伦茨方程组 (参见第 1153 页 17.2.4.3)

$$
{x}_{1}^{\prime } = {10}\left( {{x}_{2} - {x}_{1}}\right) ,\;{x}_{2}^{\prime } = {28}{x}_{1} - {x}_{2} - {x}_{1}{x}_{3},\;{x}_{3}^{\prime } = {x}_{1}{x}_{2} - \frac{8}{3}{x}_{3}
$$

其初值条件为 $x\left( 0\right)  = {\left( 0,1,0\right) }^{\mathrm{T}}$ . 使用如下命令:

$>  > \left\lbrack  {t, x}\right\rbrack   = \operatorname{ode}{45}(@\left( {t, x}\right) \left( {\lbrack {10} * \left( {x\left( 2\right)  - x\left( 1\right) }\right) ;}\right.$

$$
{28} * x\left( 1\right)  - x\left( 2\right)  - x\left( 1\right)  * x\left( 3\right) ;x\left( 1\right)  * x\left( 2\right)  - 8 * x\left( 3\right) /3\rbrack ),\left\lbrack  {050}\right\rbrack  ,\left\lbrack  {0;1;0}\right\rbrack  );
$$

$>  > \operatorname{plot}\left( {x\left( { : ,1}\right) , x\left( { : ,3}\right) }\right)$

最后的命令给出了在 ${x}_{1},{x}_{3}$ 平面的相图 (图 19.20(b)).

![01937d01-b6f6-7881-8294-3a9c82211946_85_191_299_1254_517_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_85_191_299_1254_517_0.jpg)

图 19.20

##### 19.8.4.2 Mathematica

## 1. 求解数学问题的工具

计算机代数系统 Mathematica 是能用来求解大量数值数学问题的非常有效的工具. Mathematica 的数学程序完全不同于符号计算. 根据某些预先给定的原则, 类似于图像表示的情况, Mathematica 确定所考虑函数的数值表, 并利用这些数值确定要求的解. 因为点数必须是有限的, 这可能是一个 “坏” 性态函数的问题. 尽管 Mathematica 在问题区域内试图选取更多的节点, 我们必须假定在所考虑区域上的某种连续性. 这可能在最终的结果中产生误差. 建议尽可能使用所考虑问题的许多信息, 且若有可能, 在符号形式下进行计算, 即使这仅对子问题有可能.

在表 19.5 中, 我们介绍了用于数值计算的算子.

表 19.5 数值运算

<table><tr><td>NIntegrate</td><td>计算定积分</td></tr><tr><td>NSum</td><td>计算和 $\mathop{\sum }\limits_{{i = 1}}^{n}f\left( i\right)$</td></tr><tr><td>NProduct</td><td>计算积</td></tr><tr><td>NSolve</td><td>数值计算求解代数方程</td></tr><tr><td>NDSolve</td><td>数值计算求解微分方程</td></tr></table>

在启动 Mathematica 的 "Prompt" 之后显示 ${In}\left\lbrack  l\right\rbrack   \mathrel{\text{:=}}$ ; 这表示系统准备接受输入. Mathematica 用 out [l] 表示相应的输出. 一般在行中 $\operatorname{In}\left\lbrack  n\right\rbrack   \mathrel{\text{:=}}$ 表示输入, ${out}\left\lbrack  n\right\rbrack   \mathrel{\text{:=}}$ 表示 Mathemetica 返回的答案. 表达式中的箭头 $\rightarrow$ 表示 $x$ 用值 $a$ 代替.

## 2. 曲线拟合与插值

(1) 曲线拟合 Mathematica 可用最小二乘法选取函数拟合数据集 (参见第 609 页 6.2.5), 且平均逼近离散问题 (参见第 1280 页 19.6.2.2). 一般的指令为

$$
\operatorname{Fit}\left\lbrack  {\left\{  {{y}_{1},{y}_{2},\cdots }\right\}  ,\text{ funkt }, x}\right\rbrack   \tag{19.291}
$$

这里数值 ${y}_{i}$ 组成数据表, funkt 为用于数据拟合的可选函数表, $x$ 表示独立变量的相应区域. 若 funkt 选定,例如为 Table $\left\lbrack  {{x}^{ \land  }i,\{ i,0, n\} }\right\rbrack$ ,则是用 $n$ 次多项式进行拟合.

- 设给定如下数据表:

$$
\operatorname{In}\left\lbrack  1\right\rbrack   \mathrel{\text{:=}} l = \{ {1.70045},{1.2523},{0.638803},{0.423479},{0.249091},{0.160321},{0.0883432}\text{,}
$$

$$
{0.0570776},{0.0302744},{0.0212794}\}
$$

输入

$$
\operatorname{In}\left\lbrack  2\right\rbrack   \mathrel{\text{:=}} {f1} = \operatorname{Fit}\left\lbrack  {l,\left\{  {1, x,{x}^{ \land  }2,{x}^{ \land  }3,{x}^{ \land  }4}\right\}  , x}\right\rbrack
$$

若 $l$ 的元素对应 $x$ 赋值 $1,2,\cdots ,{10}$ . 其结果为如下四次逼近多项式

$$
\text{ Out }\left\lbrack  2\right\rbrack   = {2.48918} - {0.853487x} + {0.0998996}{x}^{2} - {0.00371393}{x}^{3} - {0.0000219224}{x}^{4}
$$

用命令

$$
\operatorname{In}\left\lbrack  3\right\rbrack   \mathrel{\text{:=}} \operatorname{Plot}\left\lbrack  {\operatorname{ListPlot}\left\lbrack  {l,\{ x,{10}\} }\right\rbrack  ,{f1},\{ x,1,{10}\} ,\text{ AxesOrigin } \rightarrow  \{ 0,0\} }\right\rbrack
$$

可得数据表示及图 19.21(a) 给出的近似曲线.

![01937d01-b6f6-7881-8294-3a9c82211946_86_221_1372_1193_413_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_86_221_1372_1193_413_0.jpg)

图 19.21

这完全满足给定的数据. ${\mathrm{e}}^{1 - {0.5x}}$ 的级数展开取了前四项.

(2) 插值 Mathematica 提供特殊的算法确定插值函数. 它们表示为类似于纯函数构成的所谓插值函数类. 表 19.6 给出了其使用指南. 取代单独的函数值 ${y}_{i}$ ,可在给定点给出一列函数值与指定的导数值.

I 用 $\operatorname{In}\left\lbrack  3\right\rbrack   \mathrel{\text{:=}} \operatorname{Plot}\left\lbrack  {\operatorname{Interpolation}\left\lbrack  l\right\rbrack  \left\lbrack  x\right\rbrack  ,\{ x,1,{10}\} }\right\rbrack$ 得图 19.21(b). 显然 Mathemat-ica 给出了精确对应于数据表的结果.

## 表 19.6 插值命令

<table><tr><td>Interpolation $\left\lbrack  \left\{  {{y}_{1},{y}_{2},\cdots }\right\}  \right\rbrack$</td><td>对 $i$ 为整数, ${x}_{i}$ 取 ${y}_{i}$ 值,给出近似函数</td></tr><tr><td>Interpolation $\left\lbrack  \left\{  {\left\{  {{x}_{1},{y}_{1}}\right\}  ,\left\{  {{x}_{2},{y}_{2}}\right\}  ,\cdots }\right\}  \right\rbrack$</td><td>对点列 $\left( {{x}_{i},{y}_{i}}\right)$ 给出近似函数</td></tr></table>

## 3. 多项式方程的数值解

如同在第 1348 页 20.3.2.1 中所示, Mathematica 能数值确定多项式的根. 命令是

$$
\text{NSolve}\left\lbrack  {p\left( x\right)  =  = 0, x, n}\right\rbrack
$$

其中 $n$ 为计算需达到的精度. 若忽略 $n$ ,则计算达到机器精度. 若输入 $m$ 次多项式, 则能得到全部 $m$ 个根.

$$
{In}\left\lbrack  1\right\rbrack   \mathrel{\text{:=}} \text{NSolve}\left\lbrack  {{x}^{ \land  }6 + 3{x}^{ \land  }2 - 5 =  = 0}\right\rbrack
$$

$$
\text{Out}\left\lbrack  1\right\rbrack   = \{ x -  >  - {1.07432}\} ,\{ x -  >  - {0.867262} - {1.15292}\mathrm{I}\} \text{,}
$$

$$
\{ x \rightarrow   - {0.867262} + {1.15292}\mathrm{I}\} ,\{ x \rightarrow  {0.867262} - {1.15292}\mathrm{I}\} ,
$$

$$
\{ x \rightarrow  {0.867262} + {1.15292}\mathrm{I}\} ,\{ x \rightarrow  {1.07432}\}
$$

## 4. 数值积分

Mathematica 为数值积分提供了程序 NIntegrate. 不同于符号方法, 它用被积函数的数值表工作. 考虑以两个非正常积分为例 (参见第 673 页 8.2.3).

$A : \operatorname{In}\left\lbrack  1\right\rbrack   \mathrel{\text{:=}}$ NIntegrate $\left\lbrack  {\operatorname{Exp}\left\lbrack  {-{x}^{ \land  }2}\right\rbrack  ,\{ x, - \operatorname{Infinity},\operatorname{Infinity}\} }\right\rbrack  \operatorname{Out}\left\lbrack  1\right\rbrack   =$1.77245.

$\mathbf{B} : \operatorname{In}\left\lbrack  2\right\rbrack   \mathrel{\text{:=}}$ NIntegrate $\left\lbrack  {1/{x}^{ \land  }2,\{ x, - 1,1\} }\right\rbrack$

Power::infy: Infinite expression $\frac{1}{0}$ encountered.

NIntegrate::inum: Integrand ComplexInfinity is not numerical at $\{ x\}  = \{ 0\}$ .

在例 B 中, Mathematica 认知在 $x = 0$ 处不连续并给出警告. Mathematica 使用问题区域内大量点的数值表, 并认知极点. 然而, 答案可能仍然是错的.

Mathematica 使用某些预定的选项进行数值积分, 而在某些特殊情况下是不充分的. 可以用参数 MinRecursion 和 MaxRecursion 确定 Mathematica 在问题区域工作的最小和最大递归步数. 默认选项为 0 和 6 . 若此值增加, 则即使 Mathematica 运行变慢, 但结果更好.

${In}\left\lbrack  3\right\rbrack   \mathrel{\text{:=}}$ NIntegrate $\left\lbrack  {\operatorname{Exp}\left\lbrack  {-x \land  2}\right\rbrack  ,\{ x, - {1000},{1000}\} }\right\rbrack$ ,因为积分区域太大, Math-ematica 找不到 $x = 0$ 的峰值,答案是

NIntegrate::ploss:

数值积分因失去精度停止. 无法达到要求的精度或准确度的目标; 怀疑有如下情况: 高振荡的被积函数或积分的真值为 0 .

$$
\operatorname{Out}\left\lbrack  3\right\rbrack   = {1.34946} \cdot  {10}^{-{26}}
$$

若要求为

$$
\operatorname{In}\left\lbrack  4\right\rbrack   \mathrel{\text{:=}} \text{NIntegrate}\left\lbrack  {\operatorname{Exp}\left\lbrack  {-{x}^{ \land  }2}\right\rbrack  ,\{ x, - {1000},{1000}\} }\right. \text{,}
$$

$$
\text{MinRecursion} \rightarrow  3\text{, MaxRecursion} \rightarrow  {10}\rbrack
$$

则结果是

$$
\text{Out}\left\lbrack  4\right\rbrack   = {1.77245}
$$

类似地, 可用命令

$$
\texttt{NIntegrate}\left\lbrack  {\text{fun,}\left\{  {x,{x}_{a},{x}_{1},{x}_{2},\cdots ,{x}_{e}}\right\}  }\right\rbrack   \tag{19.292}
$$

得到接近于积分真实值的结果. 给出积分上下限间的奇点 ${x}_{i}$ ,可使 Mathematica 求值更准确.

5. 微分方程的数值解

Mathematica 介绍了用 InterpolatingFunction 数值求解常微分方程和方程组的结果, 可得到解在给定区间任意点的数值及解函数的简略图形表示. 最常用的命令见表 19.7.

表 19.7 微分方程数值解命令

<table><tr><td>$\texttt{NDSolve}\left\lbrack  {{dgl}, y,\left\{  {x,{x}_{a},{x}_{e}}\right\}  }\right\rbrack$</td><td>在 ${x}_{a}$ 和 ${x}_{e}$ 之间的区域计算微分方程数值解</td></tr><tr><td>$\texttt{InterpolatingFunction}\lbrack$ liste $\rbrack \lbrack x\rbrack$</td><td>给出点 $x$ 处的解</td></tr><tr><td>Plot $\left\lbrack  {\text{Evaluate}\left\lbrack  {y\left\lbrack  x\right\rbrack  /\text{. lois}}\right\rbrack  \rbrack ,\left\{  {x,{x}_{a},{x}_{e}}\right\}  }\right\rbrack$</td><td>解的图形表示</td></tr></table>

求解描述重物在有摩擦的介质中运动的微分方程. 二维运动方程为

$$
\ddot{x} =  - \gamma \sqrt{{\dot{x}}^{2} + {\dot{y}}^{2}} \cdot  \dot{x},\;\ddot{y} =  - g - \gamma \sqrt{{\dot{x}}^{2} + {\dot{y}}^{2}} \cdot  \dot{y}.
$$

设摩擦正比于速度. $g = {10},\gamma  = {0.1}$ ,初值为 $x\left( 0\right)  = 0, y\left( 0\right)  = {10},\dot{x}\left( 0\right)  = {100},\dot{y}\left( 0\right)  =$ 200,则下面的命令可用来求解运动方程:

$$
\operatorname{In}\left\lbrack  1\right\rbrack   \mathrel{\text{:=}} {dg} = \operatorname{NDSolve}\left\lbrack  \left\{  {{x}^{\prime \prime }\left\lbrack  t\right\rbrack   =  =  - {0.1}\operatorname{Sqrt}\left\lbrack  {{x}^{\prime }{\left\lbrack  t\right\rbrack  }^{ \land  }2 + {y}^{\prime }{\left\lbrack  t\right\rbrack  }^{ \land  }2}\right\rbrack  }\right. \right. {x}^{\prime }\left\lbrack  t\right\rbrack  ,{y}^{\prime \prime }\left\lbrack  t\right\rbrack   =  =  - {10}
$$

$$
\left. {-{0.1}\operatorname{Sqrt}\left\lbrack  {{x}^{\prime }{\left\lbrack  t\right\rbrack  }^{ \land  }2 + {y}^{\prime }{\left\lbrack  t\right\rbrack  }^{ \land  }2}\right\rbrack  {y}^{\prime }\left\lbrack  t\right\rbrack  , x\left\lbrack  0\right\rbrack   =  = y\left\lbrack  0\right\rbrack   =  = 0,{x}^{\prime }\left\lbrack  0\right\rbrack   =  = {100},{y}^{\prime }\left\lbrack  0\right\rbrack   =  = {200}}\right\}  ,
$$

$$
\{ x, y\} ,\{ t,{15}\} \rbrack
$$

Mathematica 通过插值函数给出答案:

$$
\text{Out [1]} = \{ \{ x \rightarrow  \text{InterpolatingFunction}\left\lbrack  {\{ 0.,{15}.\} , <  > }\right\rbrack  \text{,}
$$

$$
y \rightarrow  \text{InterpolatingFunction}\left\lbrack  {\{ 0.,{15}.\} , <  > }\right\rbrack  \} \}
$$

则解

${In}\left\lbrack  2\right\rbrack   \mathrel{\text{:=}}$ ParametricPlot $\left\lbrack  {\{ x\left\lbrack  t\right\rbrack  , y\left\lbrack  t\right\rbrack  \} /{.dg},\{ t,0,2\} ,\text{PlotRange} \rightarrow  \text{All}}\right\rbrack$

表示为参数曲线 (图 19.22(a)).

![01937d01-b6f6-7881-8294-3a9c82211946_89_226_489_1185_484_0.jpg](images/01937d01-b6f6-7881-8294-3a9c82211946_89_226_489_1185_484_0.jpg)

图 19.22

NDSolve 接受影响结果精度的多种选择.

计算的精度可由命令 AccuracyGoal 给出. 类似运行命令 PrecisionGoal. 计算过程中 Mathematica 根据所谓的 WorkingPrecision 运行, 在要求更高精度的计算中应增加五个单位.

Mathematica 在所考虑区域内的工作步数规定为 500 . Mathematica 一般在问题区域的邻域增加节点数, 在奇点邻域可能耗尽步数极限. 在这种情况下, 可用 MaxSteps 增加步数, 也可对 MaxSteps 用命令 Infinity.

- 傅科摆 (Foucault) 方程为

$$
\ddot{x}\left( t\right)  + {\omega }^{2}x\left( t\right)  = {2\Omega }\dot{y}\left( t\right) ,\;\ddot{y}\left( t\right)  + {\omega }^{2}y\left( t\right)  =  - {2\Omega }\dot{x}\left( t\right) ,
$$

其中 $\omega  = 1,\Omega  = {0.025}$ ,初值条件为 $x\left( 0\right)  = 0, y\left( 0\right)  = {10},\dot{x}\left( 0\right)  = \dot{y}\left( 0\right)  = 0$ ,其解为

$$
\operatorname{In}\left\lbrack  3\right\rbrack   \mathrel{\text{:=}} \operatorname{dg}3 = \operatorname{NDSolve}\left\lbrack  \left\{  {{x}^{\prime \prime }\left\lbrack  t\right\rbrack   =  =  - x\left\lbrack  t\right\rbrack   + {0.05}{y}^{\prime }\left\lbrack  t\right\rbrack  ,{y}^{\prime \prime }\left\lbrack  t\right\rbrack   =  =  - y\left\lbrack  t\right\rbrack   - {0.05}{x}^{\prime }\left\lbrack  t\right\rbrack  }\right. \right. \text{,}
$$

$$
x\left\lbrack  0\right\rbrack   =  = 0, y\left\lbrack  0\right\rbrack   =  = {10},{x}^{\prime }\left\lbrack  0\right\rbrack   =  = {y}^{\prime }\left\lbrack  0\right\rbrack   =  = 0\} ,\{ x, y\} ,\{ t,0,{40}\} \rbrack
$$

$$
\text{Out}\left\lbrack  3\right\rbrack   = \{ \{ x \rightarrow  \text{InterpolatingFunction}\left\lbrack  {\{ 0.,{40}.\} , <  > }\right\rbrack  \text{,}
$$

$y \rightarrow$ InterpolatingFunction $\left\lbrack  {\{ 0.,{40}.\} , <  > }\right\rbrack  \} \}$

加上

$$
{In}\left\lbrack  4\right\rbrack   \mathrel{\text{:=}} \text{ParametricPlot}\left\lbrack  {\{ x\left\lbrack  t\right\rbrack  , y\left\lbrack  t\right\rbrack  \} / \cdot  {dg3},\{ t,0,{40}\} ,\text{AspectRatio} \rightarrow  1}\right\rbrack
$$

得图 19.22(b).

##### 19.8.4.3 Maple

计算机代数系统 Maple 能用内置逼近法求解许多数值数学问题. 计算要求的节点数,可由规定整体变量 Digits 的任意值 $n$ 确定. 但应记住选取比规定值大的 $n$ 会导致计算速度降低.

## 1. 表达式和函数的数值计算

在启动 Maple 后, 显示符号 “Prompt”, 这表示准备输入. 输入和输出通常连在一行中表示,由箭头算子 “ $\rightarrow$ ” 分开.

(1) 算子 evalf 能作为实数求值的包含内置和用户定义函数的表达式的数值, 可用命令

$$
\operatorname{evalf}\left( {\operatorname{expr}, n}\right)  \tag{19.293}
$$

计算. $\operatorname{expr}$ 为其值待定的表达式,参数 $n$ 可选,估计达到 $n$ 位精度. 默认的精度由全局变量 Digits 确定.

I 求函数 $y = f\left( x\right)  = \sqrt{x} + \ln x$ 的数值表. 首先由箭头算子定义函数:

$$
> f \mathrel{\text{:=}} z \rightarrow  \operatorname{sqrt}\left( z\right)  + \ln \left( z\right) ; \rightarrow  f \mathrel{\text{:=}} z \rightarrow  \sqrt{x} + \ln x
$$

则用命令 $\operatorname{evalf}\left( {f\left( x\right) }\right)$ 可得到要求的函数值; 其中 $x$ 应以数值代替.

在 1 和 4 之间步长为 0.2 的函数值表可用命令

$$
> \text{for}x\text{from 1 by 0.2 to 4 do print}\left( {f\left\lbrack  x\right\rbrack   = \operatorname{evalf}\left( {f\left( x\right) ,{12}}\right) }\right) \text{od}
$$

得到. 这里要求用 12 位字节计算.

Maple 以形如 ${f}_{\left\lbrack  {3.2}\right\rbrack  } = {2095200519181}$ 的元素的一栏表格形式给出结果.

(2) 算子 $\operatorname{evalhf}\left( {\exp r}\right)$ 除了算子 $\operatorname{evalf}$ 外还有算子 $\operatorname{evalhf}$ . 其用法类似于 evalf. 其变量也是实值表达式. 使用计算机上可行的硬件浮点双精度计算, 求符号表达式的数值. 回到 Maple 浮点值. 在大多数情况下使用 evalhf 加速计算, 但同时使用 evalf 和 Digits 会损失定义的精度. 例如, 在 1303 页 19.8.2 的问题中, 可能产生相当大的误差.

## 2. 方程的数值解

大多数情况下使用 Maple 可以数值求解方程或方程组. 其命令是 fsolve. 其句法为

$$
\text{fsolve(eqn, var, option)} \tag{19.294}
$$

该命令确定实数解. 若 eqn 是多项式形式, 则结果都是实根. 若 eqn 不是多项式形式, 则很可能 fsolve 仅返回一个解. 可用的选项在表 19.8 中给出.

表 19.8 命令fsolve的选择

<table><tr><td>complex</td><td>确定一个复根 (或多项式的所有根)</td></tr><tr><td>maxsols $= n$</td><td>确定至少 $n$ 个根 (仅对多项式方程)</td></tr><tr><td>fulldigits</td><td>保证不减少计算中用到的位数</td></tr><tr><td>intervall</td><td>在给定区间内求根</td></tr></table>

$\blacksquare \mathbf{A}$: 确定多项式方程 ${x}^{6} + 3{x}^{3} - 5 = 0$ 的所有解. 由

$$
> {eq} \mathrel{\text{:=}} {x}^{ \land  }6 + 3 * {x}^{ \land  }2 - 5 = 0
$$

得

$$
> \text{fsolve}\left( {{eq}, x}\right) ; \rightarrow   - {1.074323739},{1.074323739}
$$

Maple 仅得到两个实根. 选择 complex, 也得到复根:

$>$ fsolve(eq, x, complex);

$- {1.074323739}, - {0.8672620244} - {1.152922012}\mathrm{I}, - {0.8672620244} + {1.152922012}\mathrm{I}$ ,

${0.8672620244} - {1.152922012}\mathrm{I},{0.8672620244} + {1.152922012}\mathrm{I},{1.074323739}$

$\blacksquare \mathbf{B}$: 确定超越方程 ${\mathrm{e}}^{-{x}^{3}} - 4{x}^{2} = 0$ 的两个解. 定义方程

$$
> {eq} \mathrel{\text{:=}} \exp \left( {-{x}^{ \land  }3}\right)  - 4 * {x}^{ \land  }2 = 0
$$

正根的结果为

$$
> \text{fsolve}\left( {{eq}, x}\right) ; \rightarrow  {0.4740623572}
$$

由

$$
> \text{fsolve}\left( {{eq}, x, x =  - 2.{.0}}\right) ; \rightarrow   - {0.5412548544}
$$

Maple 也确定第二个 (负) 根.

## 3. 数值积分

通常只可能用数值方法计算定积分的值. 当被积函数太复杂, 或原函数不能表示成基本函数时, 正是这种情况. 在 Maple 中确定定积分的命令为 evalf:

$$
\operatorname{evalf}\left( {\operatorname{int}\left( {f\left( x\right) , x = a..b}\right) , n}\right)  \tag{19.295}
$$

Maple 通过使用逼近公式计算定积分.

I 计算定积分 ${\int }_{-2}^{2}{\mathrm{e}}^{-{x}^{3}}\mathrm{\;d}x$ . 因为原函数未知,对于积分命令,得到如下答案:

$$
> \operatorname{int}\left( {\exp \left( {-{x}^{ \land  }3}\right) , x =  - 2.{.2}}\right) ; \rightarrow  {\int }_{-2}^{2}{\mathrm{e}}^{-{x}^{3}}\mathrm{\;d}x
$$

若

$$
> \operatorname{evalf}\left( {\operatorname{int}\left( {\exp \left( {-{x}^{ \land  }3}\right) , x =  - 2.{.2}}\right) ,{15}}\right)
$$

则答案为: 277.745841695583.

Maple 使用内置逼近法计算有 15 位数字的数值积分.

在某些情况下, 尤其若积分区间太大, 该方法失效. 此时可试用图书馆的另一个逼近程序

$$
\text{readlib('evalf/int'):}
$$

该程序使用自适应牛顿法.

输入

$$
> \operatorname{evalf}\left( {\operatorname{int}\left( {\exp \left( {-{x}^{ \land  }2}\right) , x =  - {1000}.{.1000}}\right) }\right)
$$

得到误差信息. 由

$$
> \text{readlib}\left( {{}^{\prime }\text{evalf/int}{}^{\prime }}\right) \text{:}
$$

$$
> {}^{\prime }\text{evalf/int}{}^{\prime }\left( {\exp \left( {-{x}^{ \land  }2}\right) , x =  - {1000}.{.1000},{10},\text{_NCrule}}\right) \text{;}
$$

$$
\text{1.772453851}
$$

得到正确的结果. 第三个参量规定精度, 最后一个规定逼近法的内部记号.

4. 微分方程的数值解

常微分方程可用 Maple 运算 dsolve 求解. 然而在大多数情况下, 不可能确定封闭形式的解. 在这些情况下必须给定相应的初值条件, 可以数值求解.

为了做到这一点, 使用如下形式的命令 dsolve:

$$
\text{dsolve(deqn, var, numeric),} \tag{19.296}
$$

其中选项 numeric 作为第三参量. 这里参量 deqn 包含实际的微分方程和初值条件. 运算结果是一个程序,若记为 $\mathrm{f}$ ,则使用命令 $f\left( t\right)$ ,得到独立变量在 $t$ 处的解函数值.

Maple 应用龙格-库塔法得到该结果 (参见第 1260 页 19.4.1.2). 相对误差和绝对误差的默认精度为 ${10}^{-\text{Digits} + 3}$ . 用户可通过整体符号_RELERR 和_ABSERR 修改这些默认容许误差. 若在计算中有某些问题, 则 Maple 给出不同的错误信息.

在解 19.4.1.2 龙格-库塔法一节中给出的问题时, Maple 给出:

$$
> r \mathrel{\text{:=}} \operatorname{dsolve}\left( {\{ \operatorname{diff}\left( {y\left( x\right) , x}\right)  = \left( {1/4}\right)  * \left( {{x}^{ \land  }2 + y{\left( x\right) }^{ \land  }2}\right) , y\left( 0\right)  = 0\} , y\left( x\right) ,\text{ numeric }}\right) ;
$$

$$
r \mathrel{\text{:=}} {\text{ proc }}^{\prime }\text{dsolve/numeric/result2 }{}^{\prime }\left( {x,{1592392},\left\lbrack  1\right\rbrack  }\right) \text{ end }
$$

其中

$$
> \mathrm{r}\left( {0.5}\right) ; \rightarrow  \{ x\left( {.5}\right)  = {0.5000000000}, y\left( x\right) \left( {.5}\right)  = {0.01041860472}\}
$$

我们能确定解,例如在 $x = {0.5}$ 处的值.